shadow$provide.module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$tile_layer=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,
sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,
key))})}return target}global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard");module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _classCallCheck2=module(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=module(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=module(require("module$node_modules$$babel$runtime$helpers$inherits")),
_possibleConstructorReturn2=module(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=module(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_defineProperty2=module(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),_layers=require("module$node_modules$$deck_DOT_gl$layers$dist$es5$index"),_core2=require("module$node_modules$$loaders_DOT_gl$core$dist$es5$index"),
_tileset2d=global(require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$tileset_2d")),_utils=require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$utils");require={data:[],dataComparator:_utils.urlType.equals,renderSubLayers:{type:"function",value:function(props){return new _layers.GeoJsonLayer(props)},compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",
value:function(tile){},compare:!1},onTileUnload:{type:"function",value:function(tile){},compare:!1},onTileError:{type:"function",value:function(err){return console.error(err)},compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:_tileset2d.STRATEGY_DEFAULT,zRange:null,fetch:{type:"function",value:function(url,_ref){var signal=_ref.signal;_ref=_objectSpread({},_ref.layer.getLoadOptions());
_ref.fetch=_objectSpread(_objectSpread({},_ref.fetch),{},{signal});return(0,_core2.load)(url,_ref)},compare:!1},maxRequests:6};global=function(_CompositeLayer){function TileLayer(){(0,_classCallCheck2["default"])(this,TileLayer);return _super.apply(this,arguments)}(0,_inherits2["default"])(TileLayer,_CompositeLayer);var _super=_createSuper(TileLayer);(0,_createClass2["default"])(TileLayer,[{key:"initializeState",value:function(){this.state={tileset:null,isLoaded:!1}}},{key:"finalizeState",value:function(){var tileset=
this.state.tileset;tileset&&tileset.finalize()}},{key:"shouldUpdateState",value:function(_ref2){return _ref2.changeFlags.somethingChanged}},{key:"updateState",value:function(_ref3){var props=_ref3.props;_ref3=_ref3.changeFlags;var tileset=this.state.tileset;if(!tileset||_ref3.dataChanged||_ref3.updateTriggersChanged&&(_ref3.updateTriggersChanged.all||_ref3.updateTriggersChanged.getTileData)){tileset&&tileset.finalize();_ref3=Number.isFinite(this.state.maxZoom)?this.state.maxZoom:props.maxZoom;tileset=
Number.isFinite(this.state.minZoom)?this.state.minZoom:props.minZoom;var tileSize=props.tileSize,maxCacheSize=props.maxCacheSize,maxCacheByteSize=props.maxCacheByteSize,refinementStrategy=props.refinementStrategy,extent=props.extent;props=props.maxRequests;tileset=new _tileset2d["default"]({getTileData:this.getTileData.bind(this),maxCacheSize,maxCacheByteSize,maxZoom:_ref3,minZoom:tileset,tileSize,refinementStrategy,extent,onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),
onTileUnload:this._onTileUnload.bind(this),maxRequests:props});this.setState({tileset})}else if(_ref3.propsChanged||_ref3.updateTriggersChanged)tileset.setOptions(props),this.state.tileset.tiles.forEach(function(tile){tile.layers=null});this._updateTileset()}},{key:"_updateTileset",value:function(){var tileset=this.state.tileset,_this$props=this.props;_this$props=tileset.update(this.context.viewport,{zRange:_this$props.zRange,modelMatrix:_this$props.modelMatrix});tileset=tileset.isLoaded;var loadingStateChanged=
this.state.isLoaded!==tileset,tilesetChanged=this.state.frameNumber!==_this$props;tileset&&(loadingStateChanged||tilesetChanged)&&this._onViewportLoad();tilesetChanged&&this.setState({frameNumber:_this$props});this.state.isLoaded=tileset}},{key:"_onViewportLoad",value:function(){var tileset=this.state.tileset,onViewportLoad=this.props.onViewportLoad;onViewportLoad&&onViewportLoad(tileset.selectedTiles)}},{key:"_onTileLoad",value:function(tile){this.getCurrentLayer().props.onTileLoad(tile);tile.isVisible&&
this.setNeedsUpdate()}},{key:"_onTileError",value:function(error,tile){var layer=this.getCurrentLayer();layer.props.onTileError(error);layer._updateTileset();tile.isVisible&&this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(tile){this.getCurrentLayer().props.onTileUnload(tile)}},{key:"getTileData",value:function(tile){var data=this.props.data,_this$getCurrentLayer=this.getCurrentLayer().props,getTileData=_this$getCurrentLayer.getTileData;_this$getCurrentLayer=_this$getCurrentLayer.fetch;
var signal=tile.signal;tile.url=(0,_utils.getURLFromTemplate)(data,tile);return getTileData?getTileData(tile):tile.url?_this$getCurrentLayer(tile.url,{layer:this,signal}):null}},{key:"renderSubLayers",value:function(props){return this.props.renderSubLayers(props)}},{key:"getHighlightedObjectIndex",value:function(){return-1}},{key:"getPickingInfo",value:function(_ref4){var info=_ref4.info;_ref4=_ref4.sourceLayer;info.sourceLayer=_ref4;info.tile=_ref4.props.tile;return info}},{key:"renderLayers",value:function(){var _this=
this,visible=this.props.visible;return this.state.tileset.tiles.map(function(tile){var isVisible=visible&&tile.isVisible,highlightedObjectIndex=_this.getHighlightedObjectIndex(tile);if(tile.isLoaded)if(tile.layers)!tile.layers[0]||tile.layers[0].props.visible===isVisible&&tile.layers[0].props.highlightedObjectIndex===highlightedObjectIndex||(tile.layers=tile.layers.map(function(layer){return layer.clone({visible:isVisible,highlightedObjectIndex})}));else{var layers=_this.renderSubLayers(Object.assign({},
_this.props,{id:"".concat(_this.id,"-").concat(tile.x,"-").concat(tile.y,"-").concat(tile.z),data:tile.data,visible:isVisible,_offset:0,tile,highlightedObjectIndex}));tile.layers=(0,_core._flatten)(layers,Boolean)}return tile.layers})}},{key:"isLoaded",get:function(){return this.state.tileset.selectedTiles.every(function(tile){return tile.layers&&tile.layers.every(function(layer){return layer.isLoaded})})}}]);return TileLayer}(_core.CompositeLayer);exports["default"]=global;global.layerName="TileLayer";
global.defaultProps=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$tile_layer.js.map
