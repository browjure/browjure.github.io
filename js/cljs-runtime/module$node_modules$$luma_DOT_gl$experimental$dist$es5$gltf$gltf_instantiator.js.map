{
"version":3,
"file":"module$node_modules$$luma_DOT_gl$experimental$dist$es5$gltf$gltf_instantiator.js",
"lineCount":10,
"mappings":"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",
"sources":["node_modules/@luma_DOT_gl/experimental/dist/es5/gltf/gltf-instantiator.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$luma_DOT_gl$experimental$dist$es5$gltf$gltf_instantiator\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _core = require(\"@math.gl/core\");\n\nvar _webgl = require(\"@luma.gl/webgl\");\n\nvar _groupNode = _interopRequireDefault(require(\"../scenegraph/group-node\"));\n\nvar _gltfAnimator = _interopRequireDefault(require(\"./gltf-animator\"));\n\nvar _createGltfModel = _interopRequireDefault(require(\"./create-gltf-model\"));\n\nvar ATTRIBUTE_TYPE_TO_COMPONENTS = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16\n};\nvar DEFAULT_OPTIONS = {\n  modelOptions: {},\n  pbrDebug: false,\n  imageBasedLightingEnvironment: null,\n  lights: true,\n  useTangents: false\n};\n\nvar GLTFInstantiator = function () {\n  function GLTFInstantiator(gl) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    (0, _classCallCheck2[\"default\"])(this, GLTFInstantiator);\n    this.gl = gl;\n    this.options = Object.assign({}, DEFAULT_OPTIONS, options);\n  }\n\n  (0, _createClass2[\"default\"])(GLTFInstantiator, [{\n    key: \"instantiate\",\n    value: function instantiate(gltf) {\n      var _this = this;\n\n      this.gltf = gltf;\n      var scenes = (gltf.scenes || []).map(function (scene) {\n        return _this.createScene(scene);\n      });\n      return scenes;\n    }\n  }, {\n    key: \"createAnimator\",\n    value: function createAnimator() {\n      if (Array.isArray(this.gltf.animations)) {\n        return new _gltfAnimator[\"default\"](this.gltf);\n      }\n\n      return null;\n    }\n  }, {\n    key: \"createScene\",\n    value: function createScene(gltfScene) {\n      var _this2 = this;\n\n      var gltfNodes = gltfScene.nodes || [];\n      var nodes = gltfNodes.map(function (node) {\n        return _this2.createNode(node);\n      });\n      var scene = new _groupNode[\"default\"]({\n        id: gltfScene.name || gltfScene.id,\n        children: nodes\n      });\n      return scene;\n    }\n  }, {\n    key: \"createNode\",\n    value: function createNode(gltfNode) {\n      var _this3 = this;\n\n      if (!gltfNode._node) {\n        var gltfChildren = gltfNode.children || [];\n        var children = gltfChildren.map(function (child) {\n          return _this3.createNode(child);\n        });\n\n        if (gltfNode.mesh) {\n          children.push(this.createMesh(gltfNode.mesh));\n        }\n\n        var node = new _groupNode[\"default\"]({\n          id: gltfNode.name || gltfNode.id,\n          children: children\n        });\n\n        if (gltfNode.matrix) {\n          node.setMatrix(gltfNode.matrix);\n        } else {\n          node.matrix.identity();\n\n          if (gltfNode.translation) {\n            node.matrix.translate(gltfNode.translation);\n          }\n\n          if (gltfNode.rotation) {\n            var rotationMatrix = new _core.Matrix4().fromQuaternion(gltfNode.rotation);\n            node.matrix.multiplyRight(rotationMatrix);\n          }\n\n          if (gltfNode.scale) {\n            node.matrix.scale(gltfNode.scale);\n          }\n        }\n\n        gltfNode._node = node;\n      }\n\n      return gltfNode._node;\n    }\n  }, {\n    key: \"createMesh\",\n    value: function createMesh(gltfMesh) {\n      var _this4 = this;\n\n      if (!gltfMesh._mesh) {\n        var gltfPrimitives = gltfMesh.primitives || [];\n        var primitives = gltfPrimitives.map(function (gltfPrimitive, i) {\n          return _this4.createPrimitive(gltfPrimitive, i, gltfMesh);\n        });\n        var mesh = new _groupNode[\"default\"]({\n          id: gltfMesh.name || gltfMesh.id,\n          children: primitives\n        });\n        gltfMesh._mesh = mesh;\n      }\n\n      return gltfMesh._mesh;\n    }\n  }, {\n    key: \"getVertexCount\",\n    value: function getVertexCount(attributes) {\n      _webgl.log.warn('getVertexCount() not found')();\n    }\n  }, {\n    key: \"createPrimitive\",\n    value: function createPrimitive(gltfPrimitive, i, gltfMesh) {\n      return (0, _createGltfModel[\"default\"])(this.gl, Object.assign({\n        id: gltfPrimitive.name || \"\".concat(gltfMesh.name || gltfMesh.id, \"-primitive-\").concat(i),\n        drawMode: gltfPrimitive.mode || 4,\n        vertexCount: gltfPrimitive.indices ? gltfPrimitive.indices.count : this.getVertexCount(gltfPrimitive.attributes),\n        attributes: this.createAttributes(gltfPrimitive.attributes, gltfPrimitive.indices),\n        material: gltfPrimitive.material\n      }, this.options));\n    }\n  }, {\n    key: \"createAttributes\",\n    value: function createAttributes(attributes, indices) {\n      var _this5 = this;\n\n      var loadedAttributes = {};\n      Object.keys(attributes).forEach(function (attrName) {\n        loadedAttributes[attrName] = _this5.createAccessor(attributes[attrName], _this5.createBuffer(attributes[attrName], _this5.gl.ARRAY_BUFFER));\n      });\n\n      if (indices) {\n        loadedAttributes.indices = this.createAccessor(indices, this.createBuffer(indices, this.gl.ELEMENT_ARRAY_BUFFER));\n      }\n\n      _webgl.log.info(4, 'glTF Attributes', {\n        attributes: attributes,\n        indices: indices,\n        generated: loadedAttributes\n      })();\n\n      return loadedAttributes;\n    }\n  }, {\n    key: \"createBuffer\",\n    value: function createBuffer(attribute, target) {\n      if (!attribute.bufferView) {\n        attribute.bufferView = {};\n      }\n\n      var bufferView = attribute.bufferView;\n\n      if (!bufferView.lumaBuffers) {\n        bufferView.lumaBuffers = {};\n      }\n\n      if (!bufferView.lumaBuffers[target]) {\n        bufferView.lumaBuffers[target] = new _webgl.Buffer(this.gl, {\n          id: \"from-\".concat(bufferView.id),\n          data: bufferView.data || attribute.value,\n          target: target\n        });\n      }\n\n      return bufferView.lumaBuffers[target];\n    }\n  }, {\n    key: \"createAccessor\",\n    value: function createAccessor(accessor, buffer) {\n      return new _webgl.Accessor({\n        buffer: buffer,\n        offset: accessor.byteOffset || 0,\n        stride: accessor.bufferView.byteStride || 0,\n        type: accessor.componentType,\n        size: ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type]\n      });\n    }\n  }, {\n    key: \"createSampler\",\n    value: function createSampler(gltfSampler) {\n      return gltfSampler;\n    }\n  }, {\n    key: \"needsPOT\",\n    value: function needsPOT() {\n      return false;\n    }\n  }]);\n  return GLTFInstantiator;\n}();\n\nexports[\"default\"] = GLTFInstantiator;\n//# sourceMappingURL=gltf-instantiator.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","_classCallCheck2","_createClass2","_core","_webgl","_groupNode","_gltfAnimator","_createGltfModel","ATTRIBUTE_TYPE_TO_COMPONENTS","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","DEFAULT_OPTIONS","modelOptions","pbrDebug","imageBasedLightingEnvironment","lights","useTangents","GLTFInstantiator","gl","options","arguments","length","undefined","assign","key","instantiate","gltf","_this","scenes","map","scene","createScene","createAnimator","Array","isArray","animations","gltfScene","_this2","nodes","node","createNode","id","name","children","gltfNode","_this3","_node","child","mesh","push","createMesh","matrix","setMatrix","identity","translation","translate","rotation","rotationMatrix","Matrix4","fromQuaternion","multiplyRight","scale","gltfMesh","_this4","_mesh","primitives","gltfPrimitive","i","createPrimitive","getVertexCount","attributes","log","warn","concat","drawMode","mode","vertexCount","indices","count","createAttributes","material","_this5","loadedAttributes","keys","forEach","attrName","createAccessor","createBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","info","generated","attribute","target","bufferView","lumaBuffers","Buffer","data","accessor","buffer","Accessor","offset","byteOffset","stride","byteStride","type","componentType","size","createSampler","gltfSampler","needsPOT"]
}
