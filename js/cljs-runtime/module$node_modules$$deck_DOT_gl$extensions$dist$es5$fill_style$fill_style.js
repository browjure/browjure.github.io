shadow$provide.module$node_modules$$deck_DOT_gl$extensions$dist$es5$fill_style$fill_style=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _regenerator=global(require("module$node_modules$$babel$runtime$regenerator$index")),
_asyncToGenerator2=global(require("module$node_modules$$babel$runtime$helpers$asyncToGenerator")),_classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf"));
global=global(require("module$node_modules$$babel$runtime$helpers$defineProperty"));module=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index");var _core2=require("module$node_modules$$luma_DOT_gl$core$dist$es5$index"),_shaders=require("module$node_modules$$deck_DOT_gl$extensions$dist$es5$fill_style$shaders_glsl"),_DEFAULT_TEXTURE_PARA,DEFAULT_TEXTURE_PARAMETERS=(_DEFAULT_TEXTURE_PARA={},(0,global["default"])(_DEFAULT_TEXTURE_PARA,10241,9729),(0,global["default"])(_DEFAULT_TEXTURE_PARA,
10240,9729),(0,global["default"])(_DEFAULT_TEXTURE_PARA,10242,33071),(0,global["default"])(_DEFAULT_TEXTURE_PARA,10243,33071),_DEFAULT_TEXTURE_PARA);require=function(_LayerExtension){function FillStyleExtension(){var _ref$pattern=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).pattern;_ref$pattern=void 0===_ref$pattern?!1:_ref$pattern;(0,_classCallCheck2["default"])(this,FillStyleExtension);return _super.call(this,{pattern:_ref$pattern})}(0,_inherits2["default"])(FillStyleExtension,_LayerExtension);
var _super=_createSuper(FillStyleExtension);(0,_createClass2["default"])(FillStyleExtension,[{key:"isEnabled",value:function(layer){return layer.getAttributeManager()&&!layer.state.pathTesselator}},{key:"getShaders",value:function(extension){return extension.isEnabled(this)?{modules:[extension.opts.pattern&&_shaders.patternShaders].filter(Boolean)}:null}},{key:"initializeState",value:function(context,extension){extension.isEnabled(this)&&(context=this.getAttributeManager(),extension.opts.pattern&&
context.add({fillPatternFrames:{size:4,accessor:"getFillPattern",transform:extension.getPatternFrame.bind(this),shaderAttributes:{fillPatternFrames:{divisor:0},instanceFillPatternFrames:{divisor:1}}},fillPatternScales:{size:1,accessor:"getFillPatternScale",defaultValue:1,shaderAttributes:{fillPatternScales:{divisor:0},instanceFillPatternScales:{divisor:1}}},fillPatternOffsets:{size:2,accessor:"getFillPatternOffset",shaderAttributes:{fillPatternOffsets:{divisor:0},instanceFillPatternOffsets:{divisor:1}}}}),
this.setState({emptyTexture:new _core2.Texture2D(this.context.gl,{data:new Uint8Array(4),width:1,height:1})}))}},{key:"updateState",value:function(_ref2,extension){var props=_ref2.props;_ref2=_ref2.oldProps;extension.isEnabled(this)&&(props.fillPatternAtlas&&props.fillPatternAtlas!==_ref2.fillPatternAtlas&&extension.loadPatternAtlas.call(this,props),props.fillPatternMapping&&props.fillPatternMapping!==_ref2.fillPatternMapping&&extension.loadPatternMapping.call(this,props))}},{key:"draw",value:function(params,
extension){extension.isEnabled(this)&&this.setModuleParameters({fillPatternTexture:this.state.patternTexture||this.state.emptyTexture})}},{key:"finalizeState",value:function(){var _this$state=this.state,patternTexture=_this$state.patternTexture;_this$state=_this$state.emptyTexture;if(patternTexture)patternTexture["delete"]();if(_this$state)_this$state["delete"]()}},{key:"loadPatternAtlas",value:function(){var _loadPatternAtlas=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(_ref3){var fillPatternAtlas,
fetch,image,patternTexture;return _regenerator["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:fillPatternAtlas=_ref3.fillPatternAtlas;fetch=_ref3.fetch;if(this.state.patternTexture)this.state.patternTexture["delete"]();this.setState({patternTexture:null});image=fillPatternAtlas;if("string"!==typeof image){_context.next=8;break}_context.next=7;return fetch(image,{propName:"fillPatternAtlas",layer:this});case 7:image=_context.sent;case 8:patternTexture=image instanceof
_core2.Texture2D?image:new _core2.Texture2D(this.context.gl,{data:image,parameters:DEFAULT_TEXTURE_PARAMETERS}),this.setState({patternTexture});case 10:case "end":return _context.stop()}},_callee,this)}));return function(_x){return _loadPatternAtlas.apply(this,arguments)}}()},{key:"loadPatternMapping",value:function(){var _loadPatternMapping=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee2(_ref4){var fillPatternMapping,fetch,patternMapping;return _regenerator["default"].wrap(function(_context2){for(;;)switch(_context2.prev=
_context2.next){case 0:fillPatternMapping=_ref4.fillPatternMapping;fetch=_ref4.fetch;this.setState({patternMapping:null});patternMapping=fillPatternMapping;if("string"!==typeof patternMapping){_context2.next=7;break}_context2.next=6;return fetch(patternMapping,{propName:"fillPatternMapping",layer:this});case 6:patternMapping=_context2.sent;case 7:this.setState({patternMapping}),this.getAttributeManager().invalidate("getFillPattern"),this.setNeedsUpdate();case 10:case "end":return _context2.stop()}},
_callee2,this)}));return function(_x2){return _loadPatternMapping.apply(this,arguments)}}()},{key:"getPatternFrame",value:function(name){var patternMapping=this.state.patternMapping;return(name=patternMapping&&patternMapping[name])?[name.x,name.y,name.width,name.height]:[0,0,0,0]}}]);return FillStyleExtension}(module.LayerExtension);exports["default"]=require;require.extensionName="FillStyleExtension";require.defaultProps={fillPatternEnabled:!0,fillPatternAtlas:null,fillPatternMapping:null,fillPatternMask:!0,
getFillPattern:{type:"accessor",value:function(d){return d.pattern}},getFillPatternScale:{type:"accessor",value:1},getFillPatternOffset:{type:"accessor",value:[0,0]}}}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$extensions$dist$es5$fill_style$fill_style.js.map
