shadow$provide.module$node_modules$$deck_DOT_gl$layers$dist$es5$path_layer$path_layer=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),
_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_get2=global(require("module$node_modules$$babel$runtime$helpers$get")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),
_core2=require("module$node_modules$$luma_DOT_gl$core$dist$es5$index"),_pathTesselator=global(require("module$node_modules$$deck_DOT_gl$layers$dist$es5$path_layer$path_tesselator")),_pathLayerVertex=global(require("module$node_modules$$deck_DOT_gl$layers$dist$es5$path_layer$path_layer_vertex_glsl")),_pathLayerFragment=global(require("module$node_modules$$deck_DOT_gl$layers$dist$es5$path_layer$path_layer_fragment_glsl")),DEFAULT_COLOR=[0,0,0,255];require={widthUnits:"meters",widthScale:{type:"number",
min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},rounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:function(object){return object.path}},getColor:{type:"accessor",value:DEFAULT_COLOR},getWidth:{type:"accessor",value:1}};var ATTRIBUTE_TRANSITION={enter:function(value,chunk){return chunk.length?chunk.subarray(chunk.length-value.length):value}};global=function(_Layer){function PathLayer(){(0,
_classCallCheck2["default"])(this,PathLayer);return _super.apply(this,arguments)}(0,_inherits2["default"])(PathLayer,_Layer);var _super=_createSuper(PathLayer);(0,_createClass2["default"])(PathLayer,[{key:"getShaders",value:function(){return(0,_get2["default"])((0,_getPrototypeOf2["default"])(PathLayer.prototype),"getShaders",this).call(this,{vs:_pathLayerVertex["default"],fs:_pathLayerFragment["default"],modules:[_core.project32,_core.picking]})}},{key:"initializeState",value:function(){var _this=
this;this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:ATTRIBUTE_TRANSITION,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",
transition:ATTRIBUTE_TRANSITION,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:ATTRIBUTE_TRANSITION,defaultValue:DEFAULT_COLOR},instancePickingColors:{size:3,type:5121,accessor:function(object,_ref){var index=_ref.index;return _this.encodePickingColor(object&&object.__source?object.__source.index:index,_ref.target)}}});this.setState({pathTesselator:new _pathTesselator["default"]({fp64:this.use64bitPositions()})});this.props.getDashArray&&
!this.props.extensions.length&&_core.log.removed("getDashArray","PathStyleExtension")()}},{key:"updateState",value:function(_ref2){var oldProps=_ref2.oldProps,props=_ref2.props;_ref2=_ref2.changeFlags;(0,_get2["default"])((0,_getPrototypeOf2["default"])(PathLayer.prototype),"updateState",this).call(this,{props,oldProps,changeFlags:_ref2});oldProps=this.getAttributeManager();if(_ref2.dataChanged||_ref2.updateTriggersChanged&&(_ref2.updateTriggersChanged.all||_ref2.updateTriggersChanged.getPath)){var pathTesselator=
this.state.pathTesselator,buffers=props.data.attributes||{};pathTesselator.updateGeometry({data:props.data,geometryBuffer:buffers.getPath,buffers,normalize:!props._pathType,loop:"loop"===props._pathType,getGeometry:props.getPath,positionFormat:props.positionFormat,wrapLongitude:props.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:_ref2.dataChanged});this.setState({numInstances:pathTesselator.instanceCount,startIndices:pathTesselator.vertexStarts});_ref2.dataChanged||oldProps.invalidateAll()}if(_ref2.extensionsChanged){props=
this.context.gl;if(this.state.model)this.state.model["delete"]();this.setState({model:this._getModel(props)});oldProps.invalidateAll()}}},{key:"getPickingInfo",value:function(params){params=(0,_get2["default"])((0,_getPrototypeOf2["default"])(PathLayer.prototype),"getPickingInfo",this).call(this,params);var index=params.index,data=this.props.data;data[0]&&data[0].__source&&(params.object=data.find(function(d){return d.__source.index===index}));return params}},{key:"disablePickingIndex",value:function(objectIndex){var data=
this.props.data;if(data[0]&&data[0].__source)for(var i=0;i<data.length;i++)data[i].__source.index===objectIndex&&this._disablePickingIndex(i);else this._disablePickingIndex(objectIndex)}},{key:"draw",value:function(_ref3){var viewport=this.context.viewport,_this$props=this.props;this.state.model.setUniforms(Object.assign({},_ref3.uniforms,{jointType:Number(_this$props.rounded),billboard:_this$props.billboard,widthScale:_this$props.widthScale*("pixels"===_this$props.widthUnits?viewport.metersPerPixel:
1),miterLimit:_this$props.miterLimit,widthMinPixels:_this$props.widthMinPixels,widthMaxPixels:_this$props.widthMaxPixels})).draw()}},{key:"_getModel",value:function(gl){return new _core2.Model(gl,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new _core2.Geometry({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}},{key:"calculatePositions",value:function(attribute){var pathTesselator=
this.state.pathTesselator;attribute.startIndices=pathTesselator.vertexStarts;attribute.value=pathTesselator.get("positions")}},{key:"calculateSegmentTypes",value:function(attribute){var pathTesselator=this.state.pathTesselator;attribute.startIndices=pathTesselator.vertexStarts;attribute.value=pathTesselator.get("segmentTypes")}},{key:"wrapLongitude",get:function(){return!1}}]);return PathLayer}(_core.Layer);exports["default"]=global;global.layerName="PathLayer";global.defaultProps=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$layers$dist$es5$path_layer$path_layer.js.map
