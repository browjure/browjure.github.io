shadow$provide.module$node_modules$$luma_DOT_gl$shadertools$dist$es5$lib$shader_module=function(global,require,module$jscomp$0,exports){global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports.normalizeShaderModule=function(module){if(!module.normalized&&(module.normalized=!0,module.uniforms&&!module.getUniforms)){var shaderModule=new ShaderModule(module);module.getUniforms=shaderModule.getUniforms.bind(shaderModule)}return module};
exports["default"]=void 0;var _classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_utils=require("module$node_modules$$luma_DOT_gl$shadertools$dist$es5$utils$index"),_propTypes=require("module$node_modules$$luma_DOT_gl$shadertools$dist$es5$lib$filters$prop_types"),ShaderModule=function(){function ShaderModule(_ref){var name=_ref.name,vs=_ref.vs,fs=_ref.fs,_ref$dependencies=
_ref.dependencies,dependencies=void 0===_ref$dependencies?[]:_ref$dependencies;_ref$dependencies=_ref.uniforms;var getUniforms=_ref.getUniforms,_ref$deprecations=_ref.deprecations,deprecations=void 0===_ref$deprecations?[]:_ref$deprecations;_ref$deprecations=_ref.defines;var defines=void 0===_ref$deprecations?{}:_ref$deprecations;_ref$deprecations=_ref.inject;_ref$deprecations=void 0===_ref$deprecations?{}:_ref$deprecations;var vertexShader=_ref.vertexShader;_ref=_ref.fragmentShader;(0,_classCallCheck2["default"])(this,
ShaderModule);(0,_utils.assert)("string"===typeof name);this.name=name;this.vs=vs||vertexShader;this.fs=fs||_ref;this.getModuleUniforms=getUniforms;this.dependencies=dependencies;this.deprecations=this._parseDeprecationDefinitions(deprecations);this.defines=defines;name={vs:{},fs:{}};for(var hook in _ref$deprecations)vs=_ref$deprecations[hook],fs=hook.slice(0,2),"string"===typeof vs&&(vs={order:0,injection:vs}),name[fs][hook]=vs;this.injections=name;_ref$dependencies&&(this.uniforms=(0,_propTypes.parsePropTypes)(_ref$dependencies))}
(0,_createClass2["default"])(ShaderModule,[{key:"getModuleSource",value:function(type){switch(type){case "vs":var moduleSource=this.vs||"";break;case "fs":moduleSource=this.fs||"";break;default:(0,_utils.assert)(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(moduleSource,"// END MODULE_").concat(this.name,"\n\n")}},{key:"getUniforms",value:function(opts,uniforms){return this.getModuleUniforms?this.getModuleUniforms(opts,uniforms):this.uniforms?this._defaultGetUniforms(opts):
{}}},{key:"getDefines",value:function(){return this.defines}},{key:"checkDeprecations",value:function(shaderSource,log){this.deprecations.forEach(function(def){def.regex.test(shaderSource)&&(def.deprecated?log.deprecated(def.old,def["new"])():log.removed(def.old,def["new"])())})}},{key:"_parseDeprecationDefinitions",value:function(deprecations){deprecations.forEach(function(def){switch(def.type){case "function":def.regex=new RegExp("\\b".concat(def.old,"\\("));break;default:def.regex=new RegExp("".concat(def.type,
" ").concat(def.old,";"))}});return deprecations}},{key:"_defaultGetUniforms",value:function(){var opts=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},uniforms={},propTypes=this.uniforms,key;for(key in propTypes){var propDef=propTypes[key];key in opts&&!propDef["private"]?(propDef.validate&&(0,_utils.assert)(propDef.validate(opts[key],propDef),"".concat(this.name,": invalid ").concat(key)),uniforms[key]=opts[key]):uniforms[key]=propDef.value}return uniforms}}]);return ShaderModule}();exports["default"]=
ShaderModule}
//# sourceMappingURL=module$node_modules$$luma_DOT_gl$shadertools$dist$es5$lib$shader_module.js.map
