shadow$provide.module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$map_controller=function(global,require,module,exports){function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=
null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=
(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,
[],function(){})),!0}catch(e){return!1}}var _interopRequireDefault=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=exports.MapState=void 0;var _defineProperty2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_slicedToArray2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_classCallCheck2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),
_createClass2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_math=require("module$node_modules$math_DOT_gl$dist$es5$index");
global=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$controller"));module=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$view_state"));var _webMercator=require("module$node_modules$$math_DOT_gl$web_mercator$dist$es5$index"),_assert=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$assert")),_linearInterpolator=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$transitions$linear_interpolator"));
require=require("module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$transition_manager");var LINEAR_TRANSITION_PROPS={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new _linearInterpolator["default"],transitionInterruption:require.TRANSITION_EVENTS.BREAK},MapState$jscomp$0=function(_ViewState){function MapState(){var _ref=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},makeViewport=_ref.makeViewport;var _this=_ref.width;var height=_ref.height,
latitude=_ref.latitude,longitude=_ref.longitude,zoom=_ref.zoom,_ref$bearing=_ref.bearing;_ref$bearing=void 0===_ref$bearing?0:_ref$bearing;var _ref$pitch=_ref.pitch;_ref$pitch=void 0===_ref$pitch?0:_ref$pitch;var _ref$altitude=_ref.altitude;_ref$altitude=void 0===_ref$altitude?1.5:_ref$altitude;var _ref$maxZoom=_ref.maxZoom;_ref$maxZoom=void 0===_ref$maxZoom?20:_ref$maxZoom;var _ref$minZoom=_ref.minZoom;_ref$minZoom=void 0===_ref$minZoom?0:_ref$minZoom;var _ref$maxPitch=_ref.maxPitch;_ref$maxPitch=
void 0===_ref$maxPitch?60:_ref$maxPitch;var _ref$minPitch=_ref.minPitch,minPitch=void 0===_ref$minPitch?0:_ref$minPitch;_ref$minPitch=_ref.startPanLngLat;var startZoomLngLat=_ref.startZoomLngLat,startRotatePos=_ref.startRotatePos,startBearing=_ref.startBearing,startPitch=_ref.startPitch;_ref=_ref.startZoom;(0,_classCallCheck2["default"])(this,MapState);(0,_assert["default"])(Number.isFinite(longitude),"`longitude` must be supplied");(0,_assert["default"])(Number.isFinite(latitude),"`latitude` must be supplied");
(0,_assert["default"])(Number.isFinite(zoom),"`zoom` must be supplied");_this=_super.call(this,{width:_this,height,latitude,longitude,zoom,bearing:_ref$bearing,pitch:_ref$pitch,altitude:_ref$altitude,maxZoom:_ref$maxZoom,minZoom:_ref$minZoom,maxPitch:_ref$maxPitch,minPitch});_this._state={startPanLngLat:_ref$minPitch,startZoomLngLat,startRotatePos,startBearing,startPitch,startZoom:_ref};_this.makeViewport=makeViewport;return _this}(0,_inherits2["default"])(MapState,_ViewState);var _super=_createSuper(MapState);
(0,_createClass2["default"])(MapState,[{key:"panStart",value:function(_ref2){return this._getUpdatedState({startPanLngLat:this._unproject(_ref2.pos)})}},{key:"pan",value:function(_ref3){var pos=_ref3.pos;_ref3=_ref3.startPos;_ref3=this._state.startPanLngLat||this._unproject(_ref3);if(!_ref3)return this;pos=this._calculateNewLngLat({startPanLngLat:_ref3,pos});pos=(0,_slicedToArray2["default"])(pos,2);return this._getUpdatedState({longitude:pos[0],latitude:pos[1]})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanLngLat:null})}},
{key:"rotateStart",value:function(_ref4){return this._getUpdatedState({startRotatePos:_ref4.pos,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(_ref5){var pos=_ref5.pos,_ref5$deltaAngleX=_ref5.deltaAngleX;_ref5$deltaAngleX=void 0===_ref5$deltaAngleX?0:_ref5$deltaAngleX;_ref5=_ref5.deltaAngleY;_ref5=void 0===_ref5?0:_ref5;var _this$_state=this._state,startRotatePos=_this$_state.startRotatePos,startBearing=_this$_state.startBearing;_this$_state=
_this$_state.startPitch;if(!startRotatePos||!Number.isFinite(startBearing)||!Number.isFinite(_this$_state))return this;pos=pos?this._calculateNewPitchAndBearing(_objectSpread(_objectSpread({},this._getRotationParams(pos,startRotatePos)),{},{startBearing,startPitch:_this$_state})):{bearing:startBearing+_ref5$deltaAngleX,pitch:_this$_state+_ref5};return this._getUpdatedState(pos)}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startBearing:null,startPitch:null})}},{key:"zoomStart",
value:function(_ref6){return this._getUpdatedState({startZoomLngLat:this._unproject(_ref6.pos),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(_ref7){var pos=_ref7.pos,startPos=_ref7.startPos;_ref7=_ref7.scale;var _this$_state2=this._state,startZoom=_this$_state2.startZoom;_this$_state2=_this$_state2.startZoomLngLat;Number.isFinite(startZoom)||(startZoom=this._viewportProps.zoom,_this$_state2=this._unproject(startPos)||this._unproject(pos));startPos=this._calculateNewZoom({scale:_ref7,
startZoom});pos=this.makeViewport(_objectSpread(_objectSpread({},this._viewportProps),{},{zoom:startPos})).getMapCenterByLngLatPosition({lngLat:_this$_state2,pos});pos=(0,_slicedToArray2["default"])(pos,2);return this._getUpdatedState({zoom:startPos,longitude:pos[0],latitude:pos[1]})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}},{key:"zoomIn",value:function(){return this._zoomFromCenter(0<arguments.length&&void 0!==arguments[0]?arguments[0]:
2)}},{key:"zoomOut",value:function(){return this._zoomFromCenter(1/(0<arguments.length&&void 0!==arguments[0]?arguments[0]:2))}},{key:"moveLeft",value:function(){return this._panFromCenter([0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,0])}},{key:"moveRight",value:function(){return this._panFromCenter([-(0<arguments.length&&void 0!==arguments[0]?arguments[0]:100),0])}},{key:"moveUp",value:function(){return this._panFromCenter([0,0<arguments.length&&void 0!==arguments[0]?arguments[0]:
100])}},{key:"moveDown",value:function(){return this._panFromCenter([0,-(0<arguments.length&&void 0!==arguments[0]?arguments[0]:100)])}},{key:"rotateLeft",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing-(0<arguments.length&&void 0!==arguments[0]?arguments[0]:15)})}},{key:"rotateRight",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing+(0<arguments.length&&void 0!==arguments[0]?arguments[0]:15)})}},{key:"rotateUp",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch+
(0<arguments.length&&void 0!==arguments[0]?arguments[0]:10)})}},{key:"rotateDown",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch-(0<arguments.length&&void 0!==arguments[0]?arguments[0]:10)})}},{key:"shortestPathFrom",value:function(viewState){viewState=viewState.getViewportProps();var props=Object.assign({},this._viewportProps),bearing=props.bearing,longitude=props.longitude;180<Math.abs(bearing-viewState.bearing)&&(props.bearing=0>bearing?bearing+360:bearing-360);
180<Math.abs(longitude-viewState.longitude)&&(props.longitude=0>longitude?longitude+360:longitude-360);return props}},{key:"_zoomFromCenter",value:function(scale){var _this$_viewportProps=this._viewportProps;return this.zoom({pos:[_this$_viewportProps.width/2,_this$_viewportProps.height/2],scale})}},{key:"_panFromCenter",value:function(offset){var _this$_viewportProps2=this._viewportProps,width=_this$_viewportProps2.width;_this$_viewportProps2=_this$_viewportProps2.height;return this.pan({startPos:[width/
2,_this$_viewportProps2/2],pos:[width/2+offset[0],_this$_viewportProps2/2+offset[1]]})}},{key:"_getUpdatedState",value:function(newProps){return new this.constructor(_objectSpread(_objectSpread(_objectSpread({makeViewport:this.makeViewport},this._viewportProps),this._state),newProps))}},{key:"_applyConstraints",value:function(props){var maxZoom=props.maxZoom,minZoom=props.minZoom,zoom=props.zoom;props.zoom=(0,_math.clamp)(zoom,minZoom,maxZoom);maxZoom=props.maxPitch;minZoom=props.minPitch;zoom=props.pitch;
props.pitch=(0,_math.clamp)(zoom,minZoom,maxZoom);Object.assign(props,(0,_webMercator.normalizeViewportProps)(props));return props}},{key:"_unproject",value:function(pos){var viewport=this.makeViewport(this._viewportProps);return pos&&viewport.unproject(pos)}},{key:"_calculateNewLngLat",value:function(_ref8){var startPanLngLat=_ref8.startPanLngLat;_ref8=_ref8.pos;return this.makeViewport(this._viewportProps).getMapCenterByLngLatPosition({lngLat:startPanLngLat,pos:_ref8})}},{key:"_calculateNewZoom",
value:function(_ref9){var _this$_viewportProps3=this._viewportProps,maxZoom=_this$_viewportProps3.maxZoom;_this$_viewportProps3=_this$_viewportProps3.minZoom;_ref9=_ref9.startZoom+Math.log2(_ref9.scale);return(0,_math.clamp)(_ref9,_this$_viewportProps3,maxZoom)}},{key:"_calculateNewPitchAndBearing",value:function(_ref10){var deltaScaleX=_ref10.deltaScaleX,deltaScaleY=_ref10.deltaScaleY,startBearing=_ref10.startBearing;_ref10=_ref10.startPitch;deltaScaleY=(0,_math.clamp)(deltaScaleY,-1,1);var _this$_viewportProps4=
this._viewportProps,minPitch=_this$_viewportProps4.minPitch;_this$_viewportProps4=_this$_viewportProps4.maxPitch;var pitch=_ref10;0<deltaScaleY?pitch=_ref10+deltaScaleY*(_this$_viewportProps4-_ref10):0>deltaScaleY&&(pitch=_ref10-deltaScaleY*(minPitch-_ref10));return{pitch,bearing:startBearing+180*deltaScaleX}}},{key:"_getRotationParams",value:function(pos,startPos){var deltaX=pos[0]-startPos[0],deltaY=pos[1]-startPos[1];pos=pos[1];startPos=startPos[1];var _this$_viewportProps5=this._viewportProps,
width=_this$_viewportProps5.width;_this$_viewportProps5=_this$_viewportProps5.height;var deltaScaleY=0;0<deltaY?5<Math.abs(_this$_viewportProps5-startPos)&&(deltaScaleY=deltaY/(startPos-_this$_viewportProps5)*1.2):0>deltaY&&5<startPos&&(deltaScaleY=1-pos/startPos);deltaScaleY=Math.min(1,Math.max(-1,deltaScaleY));return{deltaScaleX:deltaX/width,deltaScaleY}}}]);return MapState}(module["default"]);exports.MapState=MapState$jscomp$0;require=function(_Controller){function MapController(props){(0,_classCallCheck2["default"])(this,
MapController);props.dragMode=props.dragMode||"pan";return _super2.call(this,MapState$jscomp$0,props)}(0,_inherits2["default"])(MapController,_Controller);var _super2=_createSuper(MapController);(0,_createClass2["default"])(MapController,[{key:"_getTransitionProps",value:function(opts){return opts?_objectSpread(_objectSpread({},LINEAR_TRANSITION_PROPS),{},{transitionInterpolator:new _linearInterpolator["default"](_objectSpread(_objectSpread({},opts),{},{makeViewport:this.controllerState.makeViewport}))}):
LINEAR_TRANSITION_PROPS}}]);return MapController}(global["default"]);exports["default"]=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$core$dist$es5$controllers$map_controller.js.map
