shadow$provide.module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$mvt_layer$mvt_layer=function(global,require,module,exports){function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e;
},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,
minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=
Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key])}):Object.getOwnPropertyDescriptors?
Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,
NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function fetchTileJSON(_x){return _fetchTileJSON.apply(this,arguments)}function _fetchTileJSON(){_fetchTileJSON=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee2(url){return _regenerator["default"].wrap(function(_context2){for(;;)switch(_context2.prev=
_context2.next){case 0:return _context2.prev=0,_context2.next=3,(0,_core.load)(url);case 3:return _context2.abrupt("return",_context2.sent);case 6:throw _context2.prev=6,_context2.t0=_context2["catch"](0),Error("An error occurred fetching TileJSON: ".concat(_context2.t0));case 9:case "end":return _context2.stop()}},_callee2,null,[[0,6]])}));return _fetchTileJSON.apply(this,arguments)}function getFeatureUniqueId(feature,uniqueIdProperty){return uniqueIdProperty?feature.properties[uniqueIdProperty]:
"id"in feature?feature.id:-1}function isFeatureIdDefined(value){return void 0!==value&&null!==value&&""!==value}function transformTileCoordsToWGS84(object,bbox,viewport){var feature=_objectSpread(_objectSpread({},object),{},{geometry:{type:object.geometry.type}});Object.defineProperty(feature.geometry,"coordinates",{get:function(){return(0,_coordinateTransform.transform)(object.geometry,bbox,viewport).coordinates}});return feature}module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");
Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _toConsumableArray2=module(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_defineProperty2=module(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_regenerator=module(require("module$node_modules$$babel$runtime$regenerator$index")),_classCallCheck2=module(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=module(require("module$node_modules$$babel$runtime$helpers$createClass")),
_get2=module(require("module$node_modules$$babel$runtime$helpers$get")),_inherits2=module(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=module(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=module(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_asyncToGenerator2=module(require("module$node_modules$$babel$runtime$helpers$asyncToGenerator")),_math=require("module$node_modules$math_DOT_gl$dist$es5$index"),
_mvt=require("module$node_modules$$loaders_DOT_gl$mvt$dist$es5$index"),_gis=require("module$node_modules$$loaders_DOT_gl$gis$dist$es5$index"),_core=require("module$node_modules$$loaders_DOT_gl$core$dist$es5$index"),_core2=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),_layers=require("module$node_modules$$deck_DOT_gl$layers$dist$es5$index");global=module(require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$tile_layer"));var _utils=require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$utils"),
_clipExtension=module(require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$mvt_layer$clip_extension")),_coordinateTransform=require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$mvt_layer$coordinate_transform");require={uniqueIdProperty:{type:"string",value:""},highlightedFeatureId:null,loaders:[_mvt.MVTLoader],binary:!1};global=function(_TileLayer){function MVTLayer(){(0,_classCallCheck2["default"])(this,MVTLayer);return _super.apply(this,arguments)}(0,_inherits2["default"])(MVTLayer,
_TileLayer);var _super=_createSuper(MVTLayer);(0,_createClass2["default"])(MVTLayer,[{key:"initializeState",value:function(){(0,_get2["default"])((0,_getPrototypeOf2["default"])(MVTLayer.prototype),"initializeState",this).call(this);this.setState({data:null,tileJSON:null})}},{key:"updateState",value:function(_ref){var props=_ref.props,oldProps=_ref.oldProps,context=_ref.context;_ref=_ref.changeFlags;_ref.dataChanged&&this._updateTileData({props});this.state.data&&((0,_get2["default"])((0,_getPrototypeOf2["default"])(MVTLayer.prototype),
"updateState",this).call(this,{props,oldProps,context,changeFlags:_ref}),this._setWGS84PropertyForTiles())}},{key:"_updateTileData",value:function(){var _updateTileData2=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(_ref2){var props,onDataLoad,data,tileJSON,minZoom,maxZoom;return _regenerator["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:props=_ref2.props;onDataLoad=this.props.onDataLoad;data=props.data;tileJSON=null;minZoom=
props.minZoom;maxZoom=props.maxZoom;if("string"!==typeof data||(0,_utils.isURLTemplate)(data)){_context.next=13;break}this.setState({data:null,tileJSON:null});_context.next=9;return fetchTileJSON(data);case 9:tileJSON=_context.sent;onDataLoad&&onDataLoad(tileJSON);_context.next=14;break;case 13:data.tilejson&&(tileJSON=data);case 14:tileJSON&&(data=tileJSON.tiles,Number.isFinite(tileJSON.minzoom)&&tileJSON.minzoom>minZoom&&(minZoom=tileJSON.minzoom),Number.isFinite(tileJSON.maxzoom)&&(!Number.isFinite(maxZoom)||
tileJSON.maxzoom<maxZoom)&&(maxZoom=tileJSON.maxzoom)),this.setState({data,tileJSON,minZoom,maxZoom});case 16:case "end":return _context.stop()}},_callee,this)}));return function(_x2){return _updateTileData2.apply(this,arguments)}}()},{key:"renderLayers",value:function(){return this.state.data?(0,_get2["default"])((0,_getPrototypeOf2["default"])(MVTLayer.prototype),"renderLayers",this).call(this):null}},{key:"getTileData",value:function(tile){var url=(0,_utils.getURLFromTemplate)(this.state.data,
tile);if(!url)return Promise.reject("Invalid URL");var options=this.getLoadOptions();options=_objectSpread(_objectSpread({},options),{},{mvt:_objectSpread(_objectSpread({},options&&options.mvt),{},{coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:{x:tile.x,y:tile.y,z:tile.z}}),gis:this.props.binary?{format:"binary"}:{}});return(0,_core.load)(url,this.props.loaders[0],options)}},{key:"renderSubLayers",value:function(props){var tile=props.tile,worldScale=Math.pow(2,tile.z),xScale=
512/worldScale,yScale=-xScale,xOffset=512*tile.x/worldScale;tile=512*(1-tile.y/worldScale);xScale=(new _math.Matrix4).scale([xScale,yScale,1]);props.autoHighlight=!1;this.context.viewport.resolution||(props.modelMatrix=xScale,props.coordinateOrigin=[xOffset,tile,0],props.coordinateSystem=_core2.COORDINATE_SYSTEM.CARTESIAN,props.extensions=[].concat((0,_toConsumableArray2["default"])(props.extensions||[]),[new _clipExtension["default"]]));return(0,_get2["default"])((0,_getPrototypeOf2["default"])(MVTLayer.prototype),
"renderSubLayers",this).call(this,props)}},{key:"onHover",value:function(info,pickingEvent){var _this$props=this.props,uniqueIdProperty=_this$props.uniqueIdProperty;if(_this$props.autoHighlight){_this$props=this.state.hoveredFeatureId;var hoveredFeature=info.object,newHoveredFeatureId;hoveredFeature&&(newHoveredFeatureId=getFeatureUniqueId(hoveredFeature,uniqueIdProperty));_this$props!==newHoveredFeatureId&&-1!==newHoveredFeatureId&&this.setState({hoveredFeatureId:newHoveredFeatureId})}return(0,_get2["default"])((0,
_getPrototypeOf2["default"])(MVTLayer.prototype),"onHover",this).call(this,info,pickingEvent)}},{key:"getPickingInfo",value:function(params){var info=(0,_get2["default"])((0,_getPrototypeOf2["default"])(MVTLayer.prototype),"getPickingInfo",this).call(this,params),isWGS84=this.context.viewport.resolution;info.object&&!isWGS84?info.object=transformTileCoordsToWGS84(info.object,info.tile.bbox,this.context.viewport):this.props.binary&&-1!==info.index&&(params=params.sourceLayer.props.data,info.object=
(0,_layers._binaryToFeature)(params.points,info.index)||(0,_layers._binaryToFeature)(params.lines,info.index)||(0,_layers._binaryToFeature)(params.polygons,info.index));return info}},{key:"getHighlightedObjectIndex",value:function(tile){var hoveredFeatureId=this.state.hoveredFeatureId,_this$props2=this.props,uniqueIdProperty=_this$props2.uniqueIdProperty,highlightedFeatureId=_this$props2.highlightedFeatureId;_this$props2=_this$props2.binary;tile=tile.data;if(!isFeatureIdDefined(hoveredFeatureId)&&
!isFeatureIdDefined(highlightedFeatureId))return-1;var featureIdToHighlight=isFeatureIdDefined(highlightedFeatureId)?highlightedFeatureId:hoveredFeatureId;if(Array.isArray(tile))return tile.findIndex(function(feature){return getFeatureUniqueId(feature,uniqueIdProperty)===featureIdToHighlight});if(tile&&_this$props2)for(hoveredFeatureId=(0,_layers._findIndexBinary)(tile,uniqueIdProperty,featureIdToHighlight),highlightedFeatureId=0,_this$props2=["points","lines","polygons"];highlightedFeatureId<_this$props2.length;highlightedFeatureId++){var geometry=
_this$props2[highlightedFeatureId];geometry=tile[geometry]&&tile[geometry].featureIds.value[hoveredFeatureId];if(void 0!==geometry)return geometry}return-1}},{key:"_pickObjects",value:function(maxObjects){var _this$context=this.context,viewport=_this$context.viewport;return _this$context.deck.pickObjects({x:viewport.x,y:viewport.y,width:viewport.width,height:viewport.height,layerIds:[this.id],maxObjects})}},{key:"getRenderedFeatures",value:function(){var features=this._pickObjects(0<arguments.length&&
void 0!==arguments[0]?arguments[0]:null),featureCache=new Set,renderedFeatures=[];features=_createForOfIteratorHelper(features);var _step;try{for(features.s();!(_step=features.n()).done;){var f=_step.value,featureId=getFeatureUniqueId(f.object,this.props.uniqueIdProperty);-1===featureId?renderedFeatures.push(f.object):featureCache.has(featureId)||(featureCache.add(featureId),renderedFeatures.push(f.object))}}catch(err){features.e(err)}finally{features.f()}return renderedFeatures}},{key:"_setWGS84PropertyForTiles",
value:function(){var _this=this;this.state.tileset.selectedTiles.forEach(function(tile){tile.hasOwnProperty("dataInWGS84")||Object.defineProperty(tile,"dataInWGS84",{get:function(){if(!tile.content)return null;if(_this.props.binary&&Array.isArray(tile.content)&&!tile.content.length)return[];if(void 0===tile._contentWGS84){var content=_this.props.binary?(0,_gis.binaryToGeoJson)(tile.content):tile.content;tile._contentWGS84=content.map(function(feature){return transformTileCoordsToWGS84(feature,tile.bbox,
_this.context.viewport)})}return tile._contentWGS84}})})}},{key:"isLoaded",get:function(){return this.state.data&&this.state.tileset&&(0,_get2["default"])((0,_getPrototypeOf2["default"])(MVTLayer.prototype),"isLoaded",this)}}]);return MVTLayer}(global["default"]);exports["default"]=global;global.layerName="MVTLayer";global.defaultProps=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$mvt_layer$mvt_layer.js.map
