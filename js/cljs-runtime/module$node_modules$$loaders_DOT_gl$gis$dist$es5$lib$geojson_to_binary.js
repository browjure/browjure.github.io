shadow$provide.module$node_modules$$loaders_DOT_gl$gis$dist$es5$lib$geojson_to_binary=function(global,require,module,exports){function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e;
},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,
minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function firstPass(features){var pointPositionsCount=
0,pointFeaturesCount=0,linePositionsCount=0,linePathsCount=0,lineFeaturesCount=0,polygonPositionsCount=0,polygonObjectsCount=0,polygonRingsCount=0,polygonFeaturesCount=0,coordLengths=new Set,numericPropKeys={};features=_createForOfIteratorHelper(features);var _step;try{for(features.s();!(_step=features.n()).done;){var feature=_step.value,geometry=feature.geometry;switch(geometry.type){case "Point":pointFeaturesCount++;pointPositionsCount++;coordLengths.add(geometry.coordinates.length);break;case "MultiPoint":pointFeaturesCount++;
pointPositionsCount+=geometry.coordinates.length;var _iterator2=_createForOfIteratorHelper(geometry.coordinates),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)coordLengths.add(_step2.value.length)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}break;case "LineString":lineFeaturesCount++;linePositionsCount+=geometry.coordinates.length;linePathsCount++;var _iterator3=_createForOfIteratorHelper(geometry.coordinates),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;)coordLengths.add(_step3.value.length)}catch(err){_iterator3.e(err)}finally{_iterator3.f()}break;
case "MultiLineString":lineFeaturesCount++;var _iterator4=_createForOfIteratorHelper(geometry.coordinates),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var line=_step4.value;linePositionsCount+=line.length;linePathsCount++;var _iterator5=_createForOfIteratorHelper(line),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;)coordLengths.add(_step5.value.length)}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}break;case "Polygon":polygonFeaturesCount++;
polygonObjectsCount++;polygonRingsCount+=geometry.coordinates.length;polygonPositionsCount+=flatten(geometry.coordinates).length;var _iterator6=_createForOfIteratorHelper(flatten(geometry.coordinates)),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;)coordLengths.add(_step6.value.length)}catch(err){_iterator6.e(err)}finally{_iterator6.f()}break;case "MultiPolygon":polygonFeaturesCount++;var _iterator7=_createForOfIteratorHelper(geometry.coordinates),_step7;try{for(_iterator7.s();!(_step7=
_iterator7.n()).done;){var polygon=_step7.value;polygonObjectsCount++;polygonRingsCount+=polygon.length;polygonPositionsCount+=flatten(polygon).length;var _iterator8=_createForOfIteratorHelper(flatten(polygon)),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;)coordLengths.add(_step8.value.length)}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}break;default:throw Error("Unsupported geometry type: ".concat(geometry.type));}if(feature.properties)for(var key in feature.properties){var val=
feature.properties[key];numericPropKeys[key]=numericPropKeys[key]||void 0===numericPropKeys[key]?Number.isFinite(val):numericPropKeys[key]}}}catch(err){features.e(err)}finally{features.f()}return{pointPositionsCount,pointFeaturesCount,linePositionsCount,linePathsCount,lineFeaturesCount,coordLength:0<coordLengths.size&&Math.max.apply(Math,(0,_toConsumableArray2["default"])(coordLengths)),polygonPositionsCount,polygonObjectsCount,polygonRingsCount,polygonFeaturesCount,numericPropKeys:Object.keys(numericPropKeys).filter(function(k){return numericPropKeys[k]})}}
function secondPass(features){var firstPassData=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},options=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},pointPositionsCount=firstPassData.pointPositionsCount,pointFeaturesCount=firstPassData.pointFeaturesCount,linePositionsCount=firstPassData.linePositionsCount,linePathsCount=firstPassData.linePathsCount,lineFeaturesCount=firstPassData.lineFeaturesCount,polygonPositionsCount=firstPassData.polygonPositionsCount,polygonObjectsCount=
firstPassData.polygonObjectsCount,polygonRingsCount=firstPassData.polygonRingsCount,polygonFeaturesCount=firstPassData.polygonFeaturesCount;firstPassData=options.coordLength;var numericPropKeys=options.numericPropKeys;options=options.PositionDataType;options=void 0===options?Float32Array:options;var GlobalFeatureIdsDataType=65535<features.length?Uint32Array:Uint16Array;pointPositionsCount={positions:new options(pointPositionsCount*firstPassData),globalFeatureIds:new GlobalFeatureIdsDataType(pointPositionsCount),
featureIds:65535<pointFeaturesCount?new Uint32Array(pointPositionsCount):new Uint16Array(pointPositionsCount),numericProps:{},properties:[]};lineFeaturesCount={pathIndices:65535<linePositionsCount?new Uint32Array(linePathsCount+1):new Uint16Array(linePathsCount+1),positions:new options(linePositionsCount*firstPassData),globalFeatureIds:new GlobalFeatureIdsDataType(linePositionsCount),featureIds:65535<lineFeaturesCount?new Uint32Array(linePositionsCount):new Uint16Array(linePositionsCount),numericProps:{},
properties:[]};polygonFeaturesCount={polygonIndices:65535<polygonPositionsCount?new Uint32Array(polygonObjectsCount+1):new Uint16Array(polygonObjectsCount+1),primitivePolygonIndices:65535<polygonPositionsCount?new Uint32Array(polygonRingsCount+1):new Uint16Array(polygonRingsCount+1),positions:new options(polygonPositionsCount*firstPassData),globalFeatureIds:new GlobalFeatureIdsDataType(polygonPositionsCount),featureIds:65535<polygonFeaturesCount?new Uint32Array(polygonPositionsCount):new Uint16Array(polygonPositionsCount),
numericProps:{},properties:[]};pointFeaturesCount=0;for(options=[pointPositionsCount,lineFeaturesCount,polygonFeaturesCount];pointFeaturesCount<options.length;pointFeaturesCount++){GlobalFeatureIdsDataType=options[pointFeaturesCount];var _iterator9=_createForOfIteratorHelper(numericPropKeys),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;)GlobalFeatureIdsDataType.numericProps[_step9.value]=new Float32Array(GlobalFeatureIdsDataType.positions.length/firstPassData)}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}lineFeaturesCount.pathIndices[linePathsCount]=
linePositionsCount;polygonFeaturesCount.polygonIndices[polygonObjectsCount]=polygonPositionsCount;polygonFeaturesCount.primitivePolygonIndices[polygonRingsCount]=polygonPositionsCount;linePositionsCount={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};linePathsCount=_createForOfIteratorHelper(features);var _step10;try{for(linePathsCount.s();!(_step10=linePathsCount.n()).done;){var feature=_step10.value,
geometry=feature.geometry,properties=feature.properties||{};switch(geometry.type){case "Point":handlePoint(geometry.coordinates,pointPositionsCount,linePositionsCount,firstPassData,properties);pointPositionsCount.properties.push(keepStringProperties(properties,numericPropKeys));linePositionsCount.pointFeature++;break;case "MultiPoint":polygonPositionsCount=void 0;polygonObjectsCount=pointPositionsCount;polygonRingsCount=linePositionsCount;_step9=firstPassData;pointFeaturesCount=properties;var _iterator11=
_createForOfIteratorHelper(geometry.coordinates);try{for(_iterator11.s();!(polygonPositionsCount=_iterator11.n()).done;)handlePoint(polygonPositionsCount.value,polygonObjectsCount,polygonRingsCount,_step9,pointFeaturesCount)}catch(err){_iterator11.e(err)}finally{_iterator11.f()}pointPositionsCount.properties.push(keepStringProperties(properties,numericPropKeys));linePositionsCount.pointFeature++;break;case "LineString":handleLineString(geometry.coordinates,lineFeaturesCount,linePositionsCount,firstPassData,
properties);lineFeaturesCount.properties.push(keepStringProperties(properties,numericPropKeys));linePositionsCount.lineFeature++;break;case "MultiLineString":polygonPositionsCount=void 0;polygonObjectsCount=lineFeaturesCount;polygonRingsCount=linePositionsCount;_step9=firstPassData;pointFeaturesCount=properties;var _iterator12=_createForOfIteratorHelper(geometry.coordinates);try{for(_iterator12.s();!(polygonPositionsCount=_iterator12.n()).done;)handleLineString(polygonPositionsCount.value,polygonObjectsCount,
polygonRingsCount,_step9,pointFeaturesCount)}catch(err){_iterator12.e(err)}finally{_iterator12.f()}lineFeaturesCount.properties.push(keepStringProperties(properties,numericPropKeys));linePositionsCount.lineFeature++;break;case "Polygon":handlePolygon(geometry.coordinates,polygonFeaturesCount,linePositionsCount,firstPassData,properties);polygonFeaturesCount.properties.push(keepStringProperties(properties,numericPropKeys));linePositionsCount.polygonFeature++;break;case "MultiPolygon":polygonPositionsCount=
void 0;polygonObjectsCount=polygonFeaturesCount;polygonRingsCount=linePositionsCount;_step9=firstPassData;pointFeaturesCount=properties;var _iterator14=_createForOfIteratorHelper(geometry.coordinates);try{for(_iterator14.s();!(polygonPositionsCount=_iterator14.n()).done;)handlePolygon(polygonPositionsCount.value,polygonObjectsCount,polygonRingsCount,_step9,pointFeaturesCount)}catch(err){_iterator14.e(err)}finally{_iterator14.f()}polygonFeaturesCount.properties.push(keepStringProperties(properties,
numericPropKeys));linePositionsCount.polygonFeature++;break;default:throw Error("Invalid geometry type");}linePositionsCount.feature++}}catch(err){linePathsCount.e(err)}finally{linePathsCount.f()}_step10={points:{positions:{value:pointPositionsCount.positions,size:firstPassData},globalFeatureIds:{value:pointPositionsCount.globalFeatureIds,size:1},featureIds:{value:pointPositionsCount.featureIds,size:1},numericProps:pointPositionsCount.numericProps,properties:pointPositionsCount.properties},lines:{pathIndices:{value:lineFeaturesCount.pathIndices,
size:1},positions:{value:lineFeaturesCount.positions,size:firstPassData},globalFeatureIds:{value:lineFeaturesCount.globalFeatureIds,size:1},featureIds:{value:lineFeaturesCount.featureIds,size:1},numericProps:lineFeaturesCount.numericProps,properties:lineFeaturesCount.properties},polygons:{polygonIndices:{value:polygonFeaturesCount.polygonIndices,size:1},primitivePolygonIndices:{value:polygonFeaturesCount.primitivePolygonIndices,size:1},positions:{value:polygonFeaturesCount.positions,size:firstPassData},
globalFeatureIds:{value:polygonFeaturesCount.globalFeatureIds,size:1},featureIds:{value:polygonFeaturesCount.featureIds,size:1},numericProps:polygonFeaturesCount.numericProps,properties:polygonFeaturesCount.properties}};for(var geomType in _step10)for(var numericProp in _step10[geomType].numericProps)_step10[geomType].numericProps[numericProp]={value:_step10[geomType].numericProps[numericProp],size:1};return _step10}function handlePoint(coords,points,indexMap,coordLength,properties){points.positions.set(coords,
indexMap.pointPosition*coordLength);points.globalFeatureIds[indexMap.pointPosition]=indexMap.feature;points.featureIds[indexMap.pointPosition]=indexMap.pointFeature;fillNumericProperties(points,properties,indexMap.pointPosition,1);indexMap.pointPosition++}function handleLineString(coords,lines,indexMap,coordLength,properties){lines.pathIndices[indexMap.linePath]=indexMap.linePosition;indexMap.linePath++;fillCoords(lines.positions,coords,indexMap.linePosition,coordLength);coords=coords.length;fillNumericProperties(lines,
properties,indexMap.linePosition,coords);lines.globalFeatureIds.set((new Uint32Array(coords)).fill(indexMap.feature),indexMap.linePosition);lines.featureIds.set((new Uint32Array(coords)).fill(indexMap.lineFeature),indexMap.linePosition);indexMap.linePosition+=coords}function handlePolygon(coords,polygons,indexMap,coordLength,properties){polygons.polygonIndices[indexMap.polygonObject]=indexMap.polygonPosition;indexMap.polygonObject++;coords=_createForOfIteratorHelper(coords);var _step13;try{for(coords.s();!(_step13=
coords.n()).done;){var ring=_step13.value;polygons.primitivePolygonIndices[indexMap.polygonRing]=indexMap.polygonPosition;indexMap.polygonRing++;fillCoords(polygons.positions,ring,indexMap.polygonPosition,coordLength);var nPositions=ring.length;fillNumericProperties(polygons,properties,indexMap.polygonPosition,nPositions);polygons.globalFeatureIds.set((new Uint32Array(nPositions)).fill(indexMap.feature),indexMap.polygonPosition);polygons.featureIds.set((new Uint32Array(nPositions)).fill(indexMap.polygonFeature),
indexMap.polygonPosition);indexMap.polygonPosition+=nPositions}}catch(err){coords.e(err)}finally{coords.f()}}function fillNumericProperties(object,properties,index,length){for(var numericPropName in object.numericProps)numericPropName in properties&&object.numericProps[numericPropName].set(Array(length).fill(properties[numericPropName]),index)}function keepStringProperties(properties,numericKeys){var props={},key;for(key in properties)numericKeys.includes(key)||(props[key]=properties[key]);return props}
function fillCoords(array,coords,startVertex,coordLength){startVertex*=coordLength;coords=_createForOfIteratorHelper(coords);var _step15;try{for(coords.s();!(_step15=coords.n()).done;)array.set(_step15.value,startVertex),startVertex+=coordLength}catch(err){coords.e(err)}finally{coords.f()}}function flatten(arrays){var _ref;return(_ref=[]).concat.apply(_ref,(0,_toConsumableArray2["default"])(arrays))}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,
"__esModule",{value:!0});exports.geojsonToBinary=function(features){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},firstPassData=firstPass(features);return secondPass(features,firstPassData,{coordLength:options.coordLength||firstPassData.coordLength||2,numericPropKeys:options.numericPropKeys||firstPassData.numericPropKeys,PositionDataType:options.PositionDataType||Float32Array})};exports.TEST_EXPORTS=void 0;var _toConsumableArray2=global(require("module$node_modules$$babel$runtime$helpers$toConsumableArray"));
exports.TEST_EXPORTS={firstPass,secondPass}}
//# sourceMappingURL=module$node_modules$$loaders_DOT_gl$gis$dist$es5$lib$geojson_to_binary.js.map
