shadow$provide.module$node_modules$$deck_DOT_gl$layers$dist$es5$text_layer$utils=function(global,require,module,exports){function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e;
},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,
minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function nextPowOfTwo(number){return Math.pow(2,
Math.ceil(Math.log2(number)))}function getTextWidth(text,startIndex,endIndex,mapping){for(var width=0;startIndex<endIndex;startIndex++){var character=text[startIndex],frameWidth=null;if(character=mapping&&mapping[character])frameWidth=character.width;width+=frameWidth}return width}function breakAll(text,startIndex,endIndex,maxWidth,iconMapping,target){for(var rowStartCharIndex=startIndex,rowOffsetLeft=0;startIndex<endIndex;startIndex++){var textWidth=getTextWidth(text,startIndex,startIndex+1,iconMapping);
rowOffsetLeft+textWidth>maxWidth&&(rowStartCharIndex<startIndex&&target.push(startIndex),rowStartCharIndex=startIndex,rowOffsetLeft=0);rowOffsetLeft+=textWidth}return rowOffsetLeft}function autoWrapping(text,wordBreak,maxWidth,iconMapping){var startIndex=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,endIndex=5<arguments.length?arguments[5]:void 0;void 0===endIndex&&(endIndex=text.length);var result=[];if("break-all"===wordBreak)breakAll(text,startIndex,endIndex,maxWidth,iconMapping,result);
else for(var rowStartCharIndex=startIndex,groupStartCharIndex=startIndex,groupEndCharIndex=startIndex,rowOffsetLeft=0;startIndex<endIndex;startIndex++){if(" "===text[startIndex])groupEndCharIndex=startIndex+1;else if(" "===text[startIndex+1]||startIndex+1===endIndex)groupEndCharIndex=startIndex+1;if(groupEndCharIndex>groupStartCharIndex){var groupWidth=getTextWidth(text,groupStartCharIndex,groupEndCharIndex,iconMapping);rowOffsetLeft+groupWidth>maxWidth&&(rowStartCharIndex<groupStartCharIndex&&(result.push(groupStartCharIndex),
rowStartCharIndex=groupStartCharIndex,rowOffsetLeft=0),groupWidth>maxWidth&&(groupWidth=breakAll(text,groupStartCharIndex,groupEndCharIndex,maxWidth,iconMapping,result),rowStartCharIndex=result[result.length-1]));groupStartCharIndex=groupEndCharIndex;rowOffsetLeft+=groupWidth}}return result}Object.defineProperty(exports,"__esModule",{value:!0});exports.nextPowOfTwo=nextPowOfTwo;exports.buildMapping=function(_ref){var getFontWidth=_ref.getFontWidth,fontHeight=_ref.fontHeight,buffer=_ref.buffer,maxCanvasWidth=
_ref.maxCanvasWidth,_ref$mapping=_ref.mapping;_ref$mapping=void 0===_ref$mapping?{}:_ref$mapping;var _ref$xOffset=_ref.xOffset,_ref$yOffset=_ref.yOffset;_ref$yOffset=void 0===_ref$yOffset?0:_ref$yOffset;var row=0;_ref$xOffset=void 0===_ref$xOffset?0:_ref$xOffset;var i=0;_ref=_createForOfIteratorHelper(_ref.characterSet);var _step;try{for(_ref.s();!(_step=_ref.n()).done;){var _char=_step.value;if(!_ref$mapping[_char]){var width=getFontWidth(_char,i++);_ref$xOffset+width+2*buffer>maxCanvasWidth&&(_ref$xOffset=
0,row++);_ref$mapping[_char]={x:_ref$xOffset+buffer,y:_ref$yOffset+row*(fontHeight+2*buffer)+buffer,width,height:fontHeight};_ref$xOffset+=width+2*buffer}}}catch(err){_ref.e(err)}finally{_ref.f()}getFontWidth=fontHeight+2*buffer;return{mapping:_ref$mapping,xOffset:_ref$xOffset,yOffset:_ref$yOffset+row*getFontWidth,canvasHeight:nextPowOfTwo(_ref$yOffset+(row+1)*getFontWidth)}};exports.autoWrapping=autoWrapping;exports.transformParagraph=function(paragraph,lineHeight,wordBreak,maxWidth,iconMapping$jscomp$0){paragraph=
Array.from(paragraph);for(var numCharacters=paragraph.length,x=Array(numCharacters),y=Array(numCharacters),rowWidth=Array(numCharacters),autoWrappingEnabled=("break-word"===wordBreak||"break-all"===wordBreak)&&isFinite(maxWidth)&&0<maxWidth,size=[0,0],rowSize=[],rowOffsetTop=0,lineStartIndex=0,lineEndIndex=0,i=0;i<=numCharacters;i++){var _char2=paragraph[i];if("\n"===_char2||i===numCharacters)lineEndIndex=i;if(lineEndIndex>lineStartIndex){for(var rows=autoWrappingEnabled?autoWrapping(paragraph,wordBreak,
maxWidth,iconMapping$jscomp$0,lineStartIndex,lineEndIndex):SINGLE_LINE,rowIndex=0;rowIndex<=rows.length;rowIndex++){for(var rowStart=0===rowIndex?lineStartIndex:rows[rowIndex-1],rowEnd=rowIndex<rows.length?rows[rowIndex]:lineEndIndex,line=paragraph,endIndex=rowEnd,iconMapping=iconMapping$jscomp$0,leftOffsets=x,rowSize$jscomp$0=rowSize,x$jscomp$0=0,rowHeight=0,i$jscomp$0=rowStart;i$jscomp$0<endIndex;i$jscomp$0++){var character=line[i$jscomp$0],frame=iconMapping[character];frame?(rowHeight||(rowHeight=
frame.height),leftOffsets[i$jscomp$0]=x$jscomp$0+frame.width/2,x$jscomp$0+=frame.width):(_core.log.warn("Missing character: ".concat(character," (").concat(character.codePointAt(0),")"))(),leftOffsets[i$jscomp$0]=x$jscomp$0,x$jscomp$0+=MISSING_CHAR_WIDTH)}rowSize$jscomp$0[0]=x$jscomp$0;for(rowSize$jscomp$0[1]=rowHeight;rowStart<rowEnd;rowStart++)y[rowStart]=rowOffsetTop+rowSize[1]/2,rowWidth[rowStart]=rowSize[0];rowOffsetTop+=rowSize[1]*lineHeight;size[0]=autoWrappingEnabled?maxWidth:Math.max(size[0],
rowSize[0])}lineStartIndex=lineEndIndex}"\n"===_char2&&(x[lineStartIndex]=0,y[lineStartIndex]=0,rowWidth[lineStartIndex]=0,lineStartIndex++)}size[1]=rowOffsetTop;return{x,y,rowWidth,size}};exports.getTextFromBuffer=function(_ref2){var value=_ref2.value,length=_ref2.length,stride=_ref2.stride,offset=_ref2.offset;_ref2=_ref2.startIndices;var bytesPerElement=value.BYTES_PER_ELEMENT;stride=stride?stride/bytesPerElement:1;offset=offset?offset/bytesPerElement:0;bytesPerElement=_ref2[length]||Math.floor((value.length-
offset-bytesPerElement)/stride)+1;var texts=Array(length),codes=value;if(1<stride||0<offset){codes=new value.constructor(bytesPerElement);for(var i=0;i<bytesPerElement;i++)codes[i]=value[i*stride+offset]}for(value=0;value<length;value++)texts[value]=String.fromCodePoint.apply(null,codes.subarray(_ref2[value],_ref2[value+1]||bytesPerElement));return{texts,characterCount:bytesPerElement}};var _core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),MISSING_CHAR_WIDTH=32,SINGLE_LINE=[]}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$layers$dist$es5$text_layer$utils.js.map
