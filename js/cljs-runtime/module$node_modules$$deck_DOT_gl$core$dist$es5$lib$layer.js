shadow$provide.module$node_modules$$deck_DOT_gl$core$dist$es5$lib$layer=function(global,require,module,exports){function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e;},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);
if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,
_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var _interopRequireDefault=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");
Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _slicedToArray2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_classCallCheck2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$inherits")),
_possibleConstructorReturn2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=_interopRequireDefault(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_constants=require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$constants"),_attributeManager=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$attribute$attribute_manager")),_uniformTransitionManager=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$uniform_transition_manager")),
_props=require("module$node_modules$$deck_DOT_gl$core$dist$es5$lifecycle$props"),_count=require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$count"),_log=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$log")),_debug=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$debug$index")),_core=require("module$node_modules$$luma_DOT_gl$core$dist$es5$index"),_assert=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$assert"));
module=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$memoize"));var _shader=require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$shader"),_projectFunctions=require("module$node_modules$$deck_DOT_gl$core$dist$es5$shaderlib$project$project_functions"),_typedArrayManager=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$typed_array_manager"));global=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lifecycle$component"));
var _layerState=_interopRequireDefault(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$layer_state")),_webMercator=require("module$node_modules$$math_DOT_gl$web_mercator$dist$es5$index"),_core2=require("module$node_modules$$loaders_DOT_gl$core$dist$es5$index"),MAX_PICKING_COLOR_CACHE_SIZE=Math.pow(2,24)-1;require=Object.freeze([]);var areViewportsEqual=(0,module["default"])(function(_ref){return _ref.oldViewport.equals(_ref.viewport)}),pickingColorCache=new Uint8ClampedArray(0);require=
{data:{type:"data",value:require,async:!0},dataComparator:null,_dataDiff:{type:"function",value:function(data){return data&&data.__diff},compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:function(url,_ref2){var propName=_ref2.propName,layer=_ref2.layer;_ref2=layer.context.resourceManager;var loadOptions=layer.getLoadOptions(),loaders=layer.props.loaders,inResourceManager=
_ref2.contains(url);inResourceManager||loadOptions||(_ref2.add({resourceId:url,data:(0,_core2.load)(url,loaders),persistent:!1}),inResourceManager=!0);return inResourceManager?_ref2.subscribe({resourceId:url,onChange:function(data){return layer.internalState.reloadAsyncProp(propName,data)},consumerId:layer.id,requestId:propName}):(0,_core2.load)(url,loaders,loadOptions)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,
compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:_constants.COORDINATE_SYSTEM.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},
transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:function(_ref3){return[0,100*-_ref3.layerIndex]},compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};global=function(_Component){function Layer(){(0,_classCallCheck2["default"])(this,Layer);return _super.apply(this,arguments)}(0,_inherits2["default"])(Layer,_Component);var _super=_createSuper(Layer);(0,_createClass2["default"])(Layer,
[{key:"toString",value:function(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}},{key:"setState",value:function(updateObject){this.setChangeFlags({stateChanged:!0});Object.assign(this.state,updateObject);this.setNeedsRedraw()}},{key:"setNeedsRedraw",value:function(){var redraw=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.internalState&&(this.internalState.needsRedraw=redraw)}},{key:"setNeedsUpdate",value:function(){this.context.layerManager.setNeedsUpdate(String(this));
this.internalState.needsUpdate=!0}},{key:"getNeedsRedraw",value:function(){return this._getNeedsRedraw(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1})}},{key:"needsUpdate",value:function(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}},{key:"hasUniformTransition",value:function(){return this.internalState.uniformTransitions.active}},{key:"isPickable",value:function(){return this.props.pickable&&this.props.visible}},
{key:"getModels",value:function(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}},{key:"getAttributeManager",value:function(){return this.internalState&&this.internalState.attributeManager}},{key:"getCurrentLayer",value:function(){return this.internalState&&this.internalState.layer}},{key:"getLoadOptions",value:function(){return this.props.loadOptions}},{key:"project",value:function(xyz){var viewport=this.context.viewport,worldPosition=(0,_projectFunctions.getWorldPosition)(xyz,
{viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem});viewport=(0,_webMercator.worldToPixels)(worldPosition,viewport.pixelProjectionMatrix);var _worldToPixels2=(0,_slicedToArray2["default"])(viewport,3);viewport=_worldToPixels2[0];worldPosition=_worldToPixels2[1];_worldToPixels2=_worldToPixels2[2];return 2===xyz.length?[viewport,worldPosition]:[viewport,worldPosition,_worldToPixels2]}},{key:"unproject",value:function(xy){return this.context.viewport.unproject(xy)}},
{key:"projectPosition",value:function(xyz){return(0,_projectFunctions.projectPosition)(xyz,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}},{key:"use64bitPositions",value:function(){var coordinateSystem=this.props.coordinateSystem;return coordinateSystem===_constants.COORDINATE_SYSTEM.DEFAULT||coordinateSystem===_constants.COORDINATE_SYSTEM.LNGLAT||coordinateSystem===_constants.COORDINATE_SYSTEM.CARTESIAN}},
{key:"onHover",value:function(info,pickingEvent){return this.props.onHover?this.props.onHover(info,pickingEvent):!1}},{key:"onClick",value:function(info,pickingEvent){return this.props.onClick?this.props.onClick(info,pickingEvent):!1}},{key:"nullPickingColor",value:function(){return[0,0,0]}},{key:"encodePickingColor",value:function(i){var target=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];target[0]=i+1&255;target[1]=i+1>>8&255;target[2]=i+1>>8>>8&255;return target}},{key:"decodePickingColor",
value:function(color){(0,_assert["default"])(color instanceof Uint8Array);color=(0,_slicedToArray2["default"])(color,3);return color[0]+256*color[1]+65536*color[2]-1}},{key:"initializeState",value:function(){throw Error("Layer ".concat(this," has not defined initializeState"));}},{key:"getShaders",value:function(shaders){var _iterator=_createForOfIteratorHelper(this.props.extensions),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var extension=_step.value;shaders=(0,_shader.mergeShaders)(shaders,
extension.getShaders.call(this,extension))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return shaders}},{key:"shouldUpdateState",value:function(_ref4){return _ref4.changeFlags.propsOrDataChanged}},{key:"updateState",value:function(_ref5){var oldProps=_ref5.oldProps,props=_ref5.props,changeFlags=_ref5.changeFlags;_ref5=this.getAttributeManager();if(changeFlags.dataChanged&&_ref5)if(changeFlags=changeFlags.dataChanged,Array.isArray(changeFlags)){changeFlags=_createForOfIteratorHelper(changeFlags);
var _step2;try{for(changeFlags.s();!(_step2=changeFlags.n()).done;)_ref5.invalidateAll(_step2.value)}catch(err){changeFlags.e(err)}finally{changeFlags.f()}}else _ref5.invalidateAll();props=0<=props.highlightedObjectIndex||props.pickable;(0<=oldProps.highlightedObjectIndex||oldProps.pickable)!==props&&_ref5&&(oldProps=_ref5.attributes,_step2=oldProps.instancePickingColors,oldProps=oldProps.pickingColors||_step2)&&(props&&oldProps.constant&&(oldProps.constant=!1,_ref5.invalidate(oldProps.id)),oldProps.value||
props||(oldProps.constant=!0,oldProps.value=[0,0,0]))}},{key:"finalizeState",value:function(){var _iterator3=_createForOfIteratorHelper(this.getModels()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;)_step3.value["delete"]()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}(_iterator3=this.getAttributeManager())&&_iterator3.finalize();this.context.resourceManager.unsubscribe({consumerId:this.id});this.internalState.uniformTransitions.clear();this.internalState.finalize()}},{key:"draw",
value:function(opts){var _iterator4=_createForOfIteratorHelper(this.getModels()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;)_step4.value.draw(opts)}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},{key:"getPickingInfo",value:function(_ref6){_ref6=_ref6.info;var index=_ref6.index;0<=index&&Array.isArray(this.props.data)&&(_ref6.object=this.props.data[index]);return _ref6}},{key:"activateViewport",value:function(viewport){var oldViewport=this.internalState.viewport;this.internalState.viewport=
viewport;oldViewport&&areViewportsEqual({oldViewport,viewport})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}},{key:"invalidateAttribute",value:function(){var name=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all",attributeManager=this.getAttributeManager();attributeManager&&("all"===name?attributeManager.invalidateAll():attributeManager.invalidate(name))}},{key:"updateAttributes",value:function(changedAttributes){var _iterator5=
_createForOfIteratorHelper(this.getModels()),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;)this._setModelAttributes(_step5.value,changedAttributes)}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}},{key:"_updateAttributes",value:function(props){var attributeManager=this.getAttributeManager();if(attributeManager){var numInstances=this.getNumInstances(props),startIndices=this.getStartIndices(props);attributeManager.update({data:props.data,numInstances,startIndices,props,transitions:props.transitions,
buffers:props.data.attributes,context:this,ignoreUnknownAttributes:!0});props=attributeManager.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(props)}}},{key:"_updateAttributeTransition",value:function(){var attributeManager=this.getAttributeManager();attributeManager&&attributeManager.updateTransition()}},{key:"_updateUniformTransition",value:function(){var uniformTransitions=this.internalState.uniformTransitions;if(uniformTransitions.active){uniformTransitions=uniformTransitions.update();
var props=Object.create(this.props),key;for(key in uniformTransitions)Object.defineProperty(props,key,{value:uniformTransitions[key]});return props}return this.props}},{key:"calculateInstancePickingColors",value:function(attribute,_ref7){_ref7=_ref7.numInstances;if(!attribute.constant){var cacheSize=pickingColorCache.length/3;this.internalState.usesPickingColorCache=!0;if(cacheSize<_ref7){_ref7>MAX_PICKING_COLOR_CACHE_SIZE&&_log["default"].warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")();
pickingColorCache=_typedArrayManager["default"].allocate(pickingColorCache,_ref7,{size:3,copy:!0,maxCount:Math.max(_ref7,MAX_PICKING_COLOR_CACHE_SIZE)});for(var newCacheSize=pickingColorCache.length/3,pickingColor=[];cacheSize<newCacheSize;cacheSize++)this.encodePickingColor(cacheSize,pickingColor),pickingColorCache[3*cacheSize]=pickingColor[0],pickingColorCache[3*cacheSize+1]=pickingColor[1],pickingColorCache[3*cacheSize+2]=pickingColor[2]}attribute.value=pickingColorCache.subarray(0,3*_ref7)}}},
{key:"_setModelAttributes",value:function(model,changedAttributes){changedAttributes=this.getAttributeManager().getShaderAttributes(changedAttributes,model.userData.excludeAttributes||{});model.setAttributes(changedAttributes)}},{key:"disablePickingIndex",value:function(objectIndex){this._disablePickingIndex(objectIndex)}},{key:"_disablePickingIndex",value:function(objectIndex){var _this$getAttributeMan=this.getAttributeManager().attributes,instancePickingColors=_this$getAttributeMan.instancePickingColors;
_this$getAttributeMan=_this$getAttributeMan.pickingColors||instancePickingColors;instancePickingColors=_this$getAttributeMan.getVertexOffset(objectIndex);objectIndex=_this$getAttributeMan.getVertexOffset(objectIndex+1);_this$getAttributeMan.buffer.subData({data:new Uint8Array(objectIndex-instancePickingColors),offset:instancePickingColors})}},{key:"restorePickingColors",value:function(){var _this$getAttributeMan2=this.getAttributeManager().attributes,instancePickingColors=_this$getAttributeMan2.instancePickingColors;
_this$getAttributeMan2=_this$getAttributeMan2.pickingColors||instancePickingColors;this.internalState.usesPickingColorCache&&_this$getAttributeMan2.value.buffer!==pickingColorCache.buffer&&(_this$getAttributeMan2.value=pickingColorCache.subarray(0,_this$getAttributeMan2.value.length));_this$getAttributeMan2.updateSubBuffer({startOffset:0})}},{key:"getNumInstances",value:function(props){props=props||this.props;return void 0!==props.numInstances?props.numInstances:this.state&&void 0!==this.state.numInstances?
this.state.numInstances:(0,_count.count)(props.data)}},{key:"getStartIndices",value:function(props){props=props||this.props;return void 0!==props.startIndices?props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}},{key:"_initialize",value:function(){(0,_debug["default"])("layer.initialize",this);this._initState();this.initializeState(this.context);var _iterator6=_createForOfIteratorHelper(this.props.extensions),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var extension=
_step6.value;extension.initializeState.call(this,this.context,extension)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0});this._updateState()}},{key:"_update",value:function(){var stateNeedsUpdate=this.needsUpdate();(0,_debug["default"])("layer.update",this,stateNeedsUpdate);stateNeedsUpdate&&this._updateState()}},{key:"_updateState",value:function(){var currentProps=this.props,currentViewport=this.context.viewport,
propsInTransition=this._updateUniformTransition();this.internalState.propsInTransition=propsInTransition;this.context.viewport=this.internalState.viewport||currentViewport;this.props=propsInTransition;try{var updateParams=this._getUpdateParams(),oldModels=this.getModels();if(this.context.gl)this.updateState(updateParams);else try{this.updateState(updateParams)}catch(error){}var _iterator7=_createForOfIteratorHelper(this.props.extensions),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var extension=
_step7.value;extension.updateState.call(this,updateParams,extension)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}var modelChanged=this.getModels()[0]!==oldModels[0];this._updateModules(updateParams,modelChanged);this.isComposite?this._renderLayers(updateParams):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=currentViewport,this.props=currentProps,this.clearChangeFlags(),this.internalState.needsUpdate=
!1,this.internalState.resetOldProps()}}},{key:"_finalize",value:function(){(0,_debug["default"])("layer.finalize",this);(0,_assert["default"])(this.internalState&&this.state);this.finalizeState(this.context);var _iterator8=_createForOfIteratorHelper(this.props.extensions),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var extension=_step8.value;extension.finalizeState.call(this,extension)}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}},{key:"drawLayer",value:function(_ref8){var _this=
this,_ref8$moduleParameter=_ref8.moduleParameters,moduleParameters=void 0===_ref8$moduleParameter?null:_ref8$moduleParameter;_ref8$moduleParameter=_ref8.uniforms;var uniforms=void 0===_ref8$moduleParameter?{}:_ref8$moduleParameter;_ref8=_ref8.parameters;var parameters=void 0===_ref8?{}:_ref8;this._updateAttributeTransition();_ref8=this.props;this.props=this.internalState.propsInTransition||_ref8;uniforms.opacity=Math.pow(this.props.opacity,1/2.2);try{moduleParameters&&this.setModuleParameters(moduleParameters);
var getPolygonOffset=this.props.getPolygonOffset,offsets=getPolygonOffset&&getPolygonOffset(uniforms)||[0,0];(0,_core.setParameters)(this.context.gl,{polygonOffset:offsets});(0,_core.withParameters)(this.context.gl,parameters,function(){var opts={moduleParameters,uniforms,parameters,context:_this.context},_iterator9=_createForOfIteratorHelper(_this.props.extensions),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var extension=_step9.value;extension.draw.call(_this,opts,extension)}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}_this.draw(opts)})}finally{this.props=
_ref8}}},{key:"getChangeFlags",value:function(){return this.internalState.changeFlags}},{key:"setChangeFlags",value:function(flags){var changeFlags=this.internalState.changeFlags;for(key in flags)if(flags[key]){var flagChanged=!1;switch(key){case "dataChanged":Array.isArray(changeFlags[key])&&(changeFlags[key]=Array.isArray(flags[key])?changeFlags[key].concat(flags[key]):flags[key],flagChanged=!0);default:changeFlags[key]||(changeFlags[key]=flags[key],flagChanged=!0)}flagChanged&&(0,_debug["default"])("layer.changeFlag",
this,key,flags)}var key=changeFlags.dataChanged||changeFlags.updateTriggersChanged||changeFlags.propsChanged||changeFlags.extensionsChanged;changeFlags.propsOrDataChanged=key;changeFlags.somethingChanged=key||flags.viewportChanged||flags.stateChanged}},{key:"clearChangeFlags",value:function(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}},{key:"diffProps",value:function(newProps,
oldProps){var changeFlags=(0,_props.diffProps)(newProps,oldProps);if(changeFlags.updateTriggersChanged)for(var key in changeFlags.updateTriggersChanged)changeFlags.updateTriggersChanged[key]&&this.invalidateAttribute(key);if(changeFlags.transitionsChanged)for(var _key in changeFlags.transitionsChanged)this.internalState.uniformTransitions.add(_key,oldProps[_key],newProps[_key],newProps.transitions[_key]);return this.setChangeFlags(changeFlags)}},{key:"validateProps",value:function(){(0,_props.validateProps)(this.props)}},
{key:"setModuleParameters",value:function(moduleParameters){var _iterator10=_createForOfIteratorHelper(this.getModels()),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;)_step10.value.updateModuleSettings(moduleParameters)}catch(err){_iterator10.e(err)}finally{_iterator10.f()}}},{key:"_updateModules",value:function(_ref9,forceUpdate){var props=_ref9.props,oldProps=_ref9.oldProps;_ref9=props.autoHighlight;var highlightedObjectIndex=props.highlightedObjectIndex;props=props.highlightColor;
if(forceUpdate||oldProps.autoHighlight!==_ref9||oldProps.highlightedObjectIndex!==highlightedObjectIndex||oldProps.highlightColor!==props)forceUpdate={},_ref9||(forceUpdate.pickingSelectedColor=null),Array.isArray(props)&&(forceUpdate.pickingHighlightColor=props),Number.isInteger(highlightedObjectIndex)&&(forceUpdate.pickingSelectedColor=0<=highlightedObjectIndex?this.encodePickingColor(highlightedObjectIndex):null),this.setModuleParameters(forceUpdate)}},{key:"_getUpdateParams",value:function(){return{props:this.props,
oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}},{key:"_getNeedsRedraw",value:function(opts){if(!this.internalState)return!1;var redraw=this.internalState.needsRedraw&&this.id;this.internalState.needsRedraw=this.internalState.needsRedraw&&!opts.clearRedrawFlags;var attributeManager=this.getAttributeManager();opts=attributeManager&&attributeManager.getNeedsRedraw(opts);return redraw||opts}},{key:"_getAttributeManager",value:function(){return new _attributeManager["default"](this.context.gl,
{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}},{key:"_initState",value:function(){(0,_assert["default"])(!this.internalState&&!this.state);(0,_assert["default"])(isFinite(this.props.coordinateSystem),"".concat(this.id,": invalid coordinateSystem"));var attributeManager=this._getAttributeManager();attributeManager&&attributeManager.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}});this.internalState=new _layerState["default"]({attributeManager,
layer:this});this.clearChangeFlags();this.state={};Object.defineProperty(this.state,"attributeManager",{get:function(){_log["default"].deprecated("layer.state.attributeManager","layer.getAttributeManager()");return attributeManager}});this.internalState.layer=this;this.internalState.uniformTransitions=new _uniformTransitionManager["default"](this.context.timeline);this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this);this.internalState.setAsyncProps(this.props)}},{key:"_transferState",
value:function(oldLayer){(0,_debug["default"])("layer.matched",this,this===oldLayer);var state=oldLayer.state,internalState=oldLayer.internalState;(0,_assert["default"])(state&&internalState);this!==oldLayer&&(this.internalState=internalState,this.internalState.layer=this,this.state=state,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}},{key:"_onAsyncPropUpdated",value:function(){this.diffProps(this.props,this.internalState.getOldProps());
this.setNeedsUpdate()}},{key:"isLoaded",get:function(){return this.internalState&&!this.internalState.isAsyncPropLoading()}},{key:"wrapLongitude",get:function(){return this.props.wrapLongitude}}]);return Layer}(global["default"]);exports["default"]=global;global.layerName="Layer";global.defaultProps=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$core$dist$es5$lib$layer.js.map
