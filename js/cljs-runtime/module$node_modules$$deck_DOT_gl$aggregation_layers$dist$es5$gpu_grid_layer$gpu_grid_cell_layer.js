shadow$provide.module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$gpu_grid_layer$gpu_grid_cell_layer=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,
_possibleConstructorReturn2["default"])(this,Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _classCallCheck2=
global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_get2=global(require("module$node_modules$$babel$runtime$helpers$get")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),
_core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),_core2=require("module$node_modules$$luma_DOT_gl$core$dist$es5$index"),_shadertools=require("module$node_modules$$luma_DOT_gl$shadertools$dist$es5$index"),_colorUtils=require("module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$utils$color_utils"),_gpuGridCellLayerVertex=global(require("module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$gpu_grid_layer$gpu_grid_cell_layer_vertex_glsl")),_gpuGridCellLayerFragment=
global(require("module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$gpu_grid_layer$gpu_grid_cell_layer_fragment_glsl"));require={colorDomain:null,colorRange:_colorUtils.defaultColorRange,elevationDomain:null,elevationRange:[0,1E3],elevationScale:{type:"number",min:0,value:1},gridSize:{type:"array",min:0,value:[1,1]},gridOrigin:{type:"array",min:0,value:[0,0]},gridOffset:{type:"array",min:0,value:[0,0]},cellSize:{type:"number",min:0,max:1E3,value:1E3},offset:{type:"array",min:0,value:[1,1]},
coverage:{type:"number",min:0,max:1,value:1},extruded:!0,material:!0};global=function(_Layer){function GPUGridCellLayer(){(0,_classCallCheck2["default"])(this,GPUGridCellLayer);return _super.apply(this,arguments)}(0,_inherits2["default"])(GPUGridCellLayer,_Layer);var _super=_createSuper(GPUGridCellLayer);(0,_createClass2["default"])(GPUGridCellLayer,[{key:"getShaders",value:function(){return(0,_get2["default"])((0,_getPrototypeOf2["default"])(GPUGridCellLayer.prototype),"getShaders",this).call(this,
{vs:_gpuGridCellLayerVertex["default"],fs:_gpuGridCellLayerFragment["default"],modules:[_core.project32,_core.gouraudLighting,_core.picking,_shadertools.fp64arithmetic]})}},{key:"initializeState",value:function(){var gl=this.context.gl;this.getAttributeManager().addInstanced({colors:{size:4,noAlloc:!0},elevations:{size:4,noAlloc:!0}});gl=this._getModel(gl);this._setupUniformBuffer(gl);this.setState({model:gl})}},{key:"_getModel",value:function(gl){return new _core2.Model(gl,Object.assign({},this.getShaders(),
{id:this.props.id,geometry:new _core2.CubeGeometry,isInstanced:!0}))}},{key:"draw",value:function(_ref){_ref=_ref.uniforms;var _this$props=this.props,cellSize=_this$props.cellSize,offset=_this$props.offset,extruded=_this$props.extruded,elevationScale=_this$props.elevationScale,coverage=_this$props.coverage,gridSize=_this$props.gridSize,gridOrigin=_this$props.gridOrigin,gridOffset=_this$props.gridOffset,elevationRange=_this$props.elevationRange,colorMaxMinBuffer=_this$props.colorMaxMinBuffer;_this$props=
_this$props.elevationMaxMinBuffer;var gridOriginLow=[(0,_core.fp64LowPart)(gridOrigin[0]),(0,_core.fp64LowPart)(gridOrigin[1])],gridOffsetLow=[(0,_core.fp64LowPart)(gridOffset[0]),(0,_core.fp64LowPart)(gridOffset[1])],domainUniforms=this.getDomainUniforms(),colorRange=(0,_colorUtils.colorRangeToFlatArray)(this.props.colorRange);this.bindUniformBuffers(colorMaxMinBuffer,_this$props);this.state.model.setUniforms(Object.assign({},_ref,domainUniforms,{cellSize,offset,extruded,elevationScale,coverage,
gridSize,gridOrigin,gridOriginLow,gridOffset,gridOffsetLow,colorRange,elevationRange})).draw();this.unbindUniformBuffers(colorMaxMinBuffer,_this$props)}},{key:"bindUniformBuffers",value:function(colorMaxMinBuffer,elevationMaxMinBuffer){colorMaxMinBuffer.bind({target:35345,index:0});elevationMaxMinBuffer.bind({target:35345,index:1})}},{key:"unbindUniformBuffers",value:function(colorMaxMinBuffer,elevationMaxMinBuffer){colorMaxMinBuffer.unbind({target:35345,index:0});elevationMaxMinBuffer.unbind({target:35345,
index:1})}},{key:"getDomainUniforms",value:function(){var _this$props2=this.props,colorDomain=_this$props2.colorDomain;_this$props2=_this$props2.elevationDomain;var domainUniforms={};null!==colorDomain?(domainUniforms.colorDomainValid=!0,domainUniforms.colorDomain=colorDomain):domainUniforms.colorDomainValid=!1;null!==_this$props2?(domainUniforms.elevationDomainValid=!0,domainUniforms.elevationDomain=_this$props2):domainUniforms.elevationDomainValid=!1;return domainUniforms}},{key:"_setupUniformBuffer",
value:function(model){var gl=this.context.gl;model=model.program.handle;var colorIndex=gl.getUniformBlockIndex(model,"ColorData"),elevationIndex=gl.getUniformBlockIndex(model,"ElevationData");gl.uniformBlockBinding(model,colorIndex,0);gl.uniformBlockBinding(model,elevationIndex,1)}}]);return GPUGridCellLayer}(_core.Layer);exports["default"]=global;global.layerName="GPUGridCellLayer";global.defaultProps=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$gpu_grid_layer$gpu_grid_cell_layer.js.map
