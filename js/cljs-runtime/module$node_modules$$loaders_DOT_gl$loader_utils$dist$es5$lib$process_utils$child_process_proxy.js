shadow$provide.module$node_modules$$loaders_DOT_gl$loader_utils$dist$es5$lib$process_utils$child_process_proxy=function(global,require,module,exports){function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=
1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var process=require("module$node_modules$process$browser");"use strict";
global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _regenerator=global(require("module$node_modules$$babel$runtime$regenerator$index")),_toConsumableArray2=global(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_defineProperty2=global(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_asyncToGenerator2=global(require("module$node_modules$$babel$runtime$helpers$asyncToGenerator")),
_classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_child_process=global(require("shadow$empty")),_assert=global(require("module$node_modules$$loaders_DOT_gl$loader_utils$dist$es5$lib$env_utils$assert")),_processUtils=require("module$node_modules$$loaders_DOT_gl$loader_utils$dist$es5$lib$process_utils$process_utils"),DEFAULT_PROCESS_OPTIONS={command:null,arguments:[],
portArg:null,port:"auto",basePort:5E3,wait:2E3,nodeSpawnOptions:{maxBuffer:512E4},onSuccess:function(processProxy){console.log("Started ".concat(processProxy.options.command))}};require=function(){function ChildProcessProxy(){var _ref$id=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).id;_ref$id=void 0===_ref$id?"browser-driver":_ref$id;(0,_classCallCheck2["default"])(this,ChildProcessProxy);this.id=_ref$id;this.port=this.childProcess=null}(0,_createClass2["default"])(ChildProcessProxy,
[{key:"start",value:function(){var _start=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(){var _this=this,options,args,_args=arguments;return _regenerator["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:options=0<_args.length&&void 0!==_args[0]?_args[0]:{};options=_objectSpread(_objectSpread({},DEFAULT_PROCESS_OPTIONS),options);(0,_assert["default"])(options.command&&"string"===typeof options.command);this.options=options;args=
(0,_toConsumableArray2["default"])(options.arguments);this.port=options.port;if(!options.portArg){_context.next=12;break}if("auto"!==this.port){_context.next=11;break}_context.next=10;return(0,_processUtils.getAvailablePort)(options.basePort);case 10:this.port=_context.sent;case 11:args.push(options.portArg,this.port);case 12:return _context.next=14,new Promise(function(resolve,reject){try{var successTimer=setTimeout(function(){if(options.onSuccess)options.onSuccess(_this);resolve({})},options.wait);
console.log("Spawning ".concat(options.command," ").concat(options.arguments.join(" ")));_this.childProcess=_child_process["default"].spawn(options.command,args,options.spawn);_this.childProcess.stderr.on("data",function(data){console.log('Child process wrote to stderr: "'.concat(data,'".'));clearTimeout(successTimer);reject(Error(data))});_this.childProcess.on("error",function(error){console.log("Child process errored with ".concat(error));clearTimeout(successTimer);reject(error)});_this.childProcess.on("close",
function(code){console.log("Child process exited with ".concat(code));_this.childProcess=null})}catch(error){reject(error)}});case 14:return _context.abrupt("return",_context.sent);case 15:case "end":return _context.stop()}},_callee,this)}));return function(){return _start.apply(this,arguments)}}()},{key:"stop",value:function(){var _stop=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee2(){return _regenerator["default"].wrap(function(_context2){for(;;)switch(_context2.prev=
_context2.next){case 0:this.childProcess&&(this.childProcess.kill(),this.childProcess=null);case 1:case "end":return _context2.stop()}},_callee2,this)}));return function(){return _stop.apply(this,arguments)}}()},{key:"exit",value:function(){var _exit=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee3(){var statusCode,_args3=arguments;return _regenerator["default"].wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return statusCode=0<_args3.length&&
void 0!==_args3[0]?_args3[0]:0,_context3.prev=1,_context3.next=4,this.stop();case 4:process.exit(statusCode);_context3.next=11;break;case 7:_context3.prev=7,_context3.t0=_context3["catch"](1),console.error(_context3.t0.message||_context3.t0),process.exit(1);case 11:case "end":return _context3.stop()}},_callee3,this,[[1,7]])}));return function(){return _exit.apply(this,arguments)}}()}]);return ChildProcessProxy}();exports["default"]=require}
//# sourceMappingURL=module$node_modules$$loaders_DOT_gl$loader_utils$dist$es5$lib$process_utils$child_process_proxy.js.map
