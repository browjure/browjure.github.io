shadow$provide.module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$h3_layers$h3_hexagon_layer=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=
it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e;},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=
!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,
len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function normalizeLongitudes(vertices,refLng){refLng=void 0===refLng?vertices[0][0]:refLng;vertices=_createForOfIteratorHelper(vertices);var _step;try{for(vertices.s();!(_step=vertices.n()).done;){var pt=_step.value,deltaLng=pt[0]-refLng;180<deltaLng?pt[0]-=360:-180>deltaLng&&(pt[0]+=360)}}catch(err){vertices.e(err)}finally{vertices.f()}}function scalePolygon(hexId,vertices,factor){hexId=
(0,_h3Js.h3ToGeo)(hexId);var _h3ToGeo2=(0,_slicedToArray2["default"])(hexId,2);hexId=_h3ToGeo2[0];_h3ToGeo2=_h3ToGeo2[1];var actualCount=vertices.length;normalizeLongitudes(vertices,_h3ToGeo2);actualCount=vertices[0]===vertices[actualCount-1]?actualCount-1:actualCount;for(var i=0;i<actualCount;i++)vertices[i][0]=(0,_math.lerp)(_h3ToGeo2,vertices[i][0],factor),vertices[i][1]=(0,_math.lerp)(hexId,vertices[i][1],factor)}function getHexagonCentroid(getHexagon,object,objectInfo){getHexagon=getHexagon(object,
objectInfo);getHexagon=(0,_h3Js.h3ToGeo)(getHexagon);getHexagon=(0,_slicedToArray2["default"])(getHexagon,2);return[getHexagon[1],getHexagon[0]]}function h3ToPolygon(hexId){var coverage=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,flatten=2<arguments.length?arguments[2]:void 0,vertices=(0,_h3Js.h3ToGeoBoundary)(hexId,!0);1!==coverage?scalePolygon(hexId,vertices,coverage):normalizeLongitudes(vertices);if(flatten){coverage=new Float64Array(2*vertices.length);flatten=0;vertices=_createForOfIteratorHelper(vertices);
var _step2;try{for(vertices.s();!(_step2=vertices.n()).done;){var pt=_step2.value;coverage[flatten++]=pt[0];coverage[flatten++]=pt[1]}}catch(err){vertices.e(err)}finally{vertices.f()}return coverage}return vertices}function mergeTriggers(getHexagon,coverage){return void 0===getHexagon||null===getHexagon?coverage:"object"===(0,_typeof2["default"])(getHexagon)?Object.assign({},getHexagon,{coverage}):{getHexagon,coverage}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");
Object.defineProperty(exports,"__esModule",{value:!0});exports.normalizeLongitudes=normalizeLongitudes;exports.scalePolygon=scalePolygon;exports["default"]=void 0;var _classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),
_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_typeof2=global(require("module$node_modules$$babel$runtime$helpers$typeof")),_slicedToArray2=global(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_h3Js=require("module$node_modules$h3_js$dist$browser$h3_js"),_math=require("module$node_modules$math_DOT_gl$dist$es5$index"),_core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),_layers=require("module$node_modules$$deck_DOT_gl$layers$dist$es5$index");
require=Object.assign({},_layers.PolygonLayer.defaultProps,{highPrecision:!1,coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:function(x){return x.hexagon}},extruded:!0});delete require.getLineDashArray;global=function(_CompositeLayer){function H3HexagonLayer(){(0,_classCallCheck2["default"])(this,H3HexagonLayer);return _super.apply(this,arguments)}(0,_inherits2["default"])(H3HexagonLayer,_CompositeLayer);var _super=_createSuper(H3HexagonLayer);(0,
_createClass2["default"])(H3HexagonLayer,[{key:"shouldUpdateState",value:function(_ref){_ref=_ref.changeFlags;return this._shouldUseHighPrecision()?_ref.propsOrDataChanged:_ref.somethingChanged}},{key:"updateState",value:function(_ref2){var props=_ref2.props;_ref2=_ref2.changeFlags;if(_ref2.dataChanged||_ref2.updateTriggers&&_ref2.updateTriggers.getHexagon){_ref2=-1;var hasPentagon=!1,hasMultipleRes=!1,_createIterable=(0,_core.createIterable)(props.data),objectInfo=_createIterable.objectInfo;_createIterable=
_createForOfIteratorHelper(_createIterable.iterable);var _step3;try{for(_createIterable.s();!(_step3=_createIterable.n()).done;){var object=_step3.value;objectInfo.index++;var hexId=props.getHexagon(object,objectInfo),hexResolution=(0,_h3Js.h3GetResolution)(hexId);if(0>_ref2)_ref2=hexResolution;else if(_ref2!==hexResolution){hasMultipleRes=!0;break}if((0,_h3Js.h3IsPentagon)(hexId)){hasPentagon=!0;break}}}catch(err){_createIterable.e(err)}finally{_createIterable.f()}this.setState({resolution:_ref2,
edgeLengthKM:0<=_ref2?(0,_h3Js.edgeLength)(_ref2,_h3Js.UNITS.km):0,hasMultipleRes,hasPentagon})}this._updateVertices(this.context.viewport)}},{key:"_shouldUseHighPrecision",value:function(){var _this$state=this.state,resolution=_this$state.resolution,hasPentagon=_this$state.hasPentagon;_this$state=_this$state.hasMultipleRes;var viewport=this.context.viewport;return this.props.highPrecision||viewport.resolution||_this$state||hasPentagon||0<=resolution&&5>=resolution}},{key:"_updateVertices",value:function(viewport){if(!this._shouldUseHighPrecision()){var _this$state2=
this.state,resolution=_this$state2.resolution,edgeLengthKM=_this$state2.edgeLengthKM;_this$state2=_this$state2.centerHex;if(!(0>resolution)&&(resolution=this.props.centerHexagon||(0,_h3Js.geoToH3)(viewport.latitude,viewport.longitude,resolution),_this$state2!==resolution)){if(_this$state2&&(_this$state2=(0,_h3Js.h3Distance)(_this$state2,resolution),0<=_this$state2&&10>_this$state2*edgeLengthKM))return;var unitsPerMeter=viewport.distanceScales.unitsPerMeter;edgeLengthKM=h3ToPolygon(resolution);_this$state2=
(0,_h3Js.h3ToGeo)(resolution);_this$state2=(0,_slicedToArray2["default"])(_this$state2,2);_this$state2=viewport.projectFlat([_this$state2[1],_this$state2[0]]);_this$state2=(0,_slicedToArray2["default"])(_this$state2,2);var centerX=_this$state2[0],centerY=_this$state2[1];edgeLengthKM=edgeLengthKM.map(function(p){p=viewport.projectFlat(p);return[(p[0]-centerX)/unitsPerMeter[0],(p[1]-centerY)/unitsPerMeter[1]]});this.setState({centerHex:resolution,vertices:edgeLengthKM})}}}},{key:"renderLayers",value:function(){return this._shouldUseHighPrecision()?
this._renderPolygonLayer():this._renderColumnLayer()}},{key:"_getForwardProps",value:function(){var _this$props=this.props,updateTriggers=_this$props.updateTriggers;return{elevationScale:_this$props.elevationScale,extruded:_this$props.extruded,coverage:_this$props.coverage,wireframe:_this$props.wireframe,stroked:_this$props.stroked,filled:_this$props.filled,lineWidthUnits:_this$props.lineWidthUnits,lineWidthScale:_this$props.lineWidthScale,lineWidthMinPixels:_this$props.lineWidthMinPixels,lineWidthMaxPixels:_this$props.lineWidthMaxPixels,
material:_this$props.material,getElevation:_this$props.getElevation,getFillColor:_this$props.getFillColor,getLineColor:_this$props.getLineColor,getLineWidth:_this$props.getLineWidth,transitions:_this$props.transitions,updateTriggers:{getFillColor:updateTriggers.getFillColor,getElevation:updateTriggers.getElevation,getLineColor:updateTriggers.getLineColor,getLineWidth:updateTriggers.getLineWidth}}}},{key:"_renderPolygonLayer",value:function(){var _this$props2=this.props,data=_this$props2.data,getHexagon=
_this$props2.getHexagon,updateTriggers=_this$props2.updateTriggers,coverage=_this$props2.coverage;_this$props2=this.getSubLayerClass("hexagon-cell-hifi",_layers.PolygonLayer);var forwardProps=this._getForwardProps();forwardProps.updateTriggers.getPolygon=mergeTriggers(updateTriggers.getHexagon,coverage);return new _this$props2(forwardProps,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:forwardProps.updateTriggers}),{data,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:function(object,
objectInfo){object=getHexagon(object,objectInfo);return h3ToPolygon(object,coverage,!0)}})}},{key:"_renderColumnLayer",value:function(){var _this$props3=this.props,data=_this$props3.data,getHexagon=_this$props3.getHexagon;_this$props3=_this$props3.updateTriggers;var SubLayerClass=this.getSubLayerClass("hexagon-cell",_layers.ColumnLayer),forwardProps=this._getForwardProps();forwardProps.updateTriggers.getPosition=_this$props3.getHexagon;return new SubLayerClass(forwardProps,this.getSubLayerProps({id:"hexagon-cell",
updateTriggers:forwardProps.updateTriggers}),{data,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:getHexagonCentroid.bind(null,getHexagon)})}}]);return H3HexagonLayer}(_core.CompositeLayer);exports["default"]=global;global.defaultProps=require;global.layerName="H3HexagonLayer"}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$h3_layers$h3_hexagon_layer.js.map
