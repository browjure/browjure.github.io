{
"version":3,
"file":"module$node_modules$$deck_DOT_gl$core$dist$es5$shaderlib$shadow$shadow.js",
"lineCount":15,
"mappings":"AAAAA,cAAA,CAAe,sEAAf,CAA2F,QAAQ,CAACC,MAAD,CAAQC,OAAR,CAAgBC,MAAhB,CAAuBC,OAAvB,CAAgC,CAwBnIC,QAASA,2BAA0B,CAACC,CAAD,CAAIC,cAAJ,CAAoB,CAAE,IAAIC,EAAI,IAAsB,WAAtB,GAAI,MAAOC,OAAX,EAA2D,IAA3D,EAAqCH,CAAA,CAAEG,MAAF,CAASC,QAAT,CAArC,CAAiE,CAAE,GAAIC,KAAA,CAAMC,OAAN,CAAcN,CAAd,CAAJ,GAAyBE,EAAzB,CAA8BK,2BAAA,CAA4BP,CAA5B,CAA9B,GAAiEC,cAAjE,EAAmFD,CAAnF,EAA4G,QAA5G,GAAwF,MAAOA,EAAP,CAASQ,MAAjG,CAAsH,CAAMN,EAAJ,GAAQF,CAAR,CAAYE,EAAZ,CAAgB,KAAIO,EAAI,CAAOC,eAAAA,CAAIA,QAAU,EAAG,EAAI,OAAO,CAAEC,EAAGD,cAAL,CAAQE,EAAGA,QAAU,EAAG,CAAE,MAAIH,EAAJ,EAAST,CAAT,CAAWQ,MAAX,CAA0B,CAAEK,KAAM,CAAA,CAAR,CAA1B,CAAiD,CAAEA,KAAM,CAAA,CAAR,CAAeC,MAAOd,CAAA,CAAES,CAAA,EAAF,CAAtB,CAAnD,CAAxB,CAA8GM,EAAGA,QAAU,CAACC,EAAD,CAAK,CAAE,KAAMA,GAAN;AAAF,CAAhI,CAA+IC,EAAGP,cAAlJ,CAA7D,CAAsN,KAAM,KAAIQ,SAAJ,CAAc,uIAAd,CAAN,CAA9U,CAA3E,IAA6jBC,iBAAmB,CAAA,CAAhlB,CAAslBC,OAAS,CAAA,CAA/lB,CAAsmBC,GAAK,OAAO,CAAEV,EAAGA,QAAU,EAAG,CAAET,EAAA,CAAKF,CAAA,CAAEG,MAAF,CAASC,QAAT,CAAA,EAAP,CAAlB,CAAkDQ,EAAGA,QAAU,EAAG,CAAE,IAAIU,KAAOpB,EAAA,CAAGqB,IAAH,EAAWJ,iBAAA,CAAmBG,IAAnB,CAAwBT,IAAM,OAAOS,KAA7D,CAAlE,CAAwIP,EAAGA,QAAU,CAACS,GAAD,CAAM,CAAEJ,MAAA,CAAS,CAAA,CAAMC,IAAA,CAAMG,GAAvB,CAA3J,CAA0LP,EAAGA,QAAU,EAAG,CAAE,GAAI,CAAE,GAAI,CAACE,gBAAL,EAAyC,IAAzC,EAAyBjB,EAAA,CAAG,QAAH,CAAzB,CAA+CA,EAAA,CAAG,QAAH,CAAA,EAAjD,CAAJ,OAA+E,CAAE,GAAIkB,MAAJ,CAAY,KAAMC,IAAN,CAAd,CAAjF,CAA1M,CAAlnB,CAEvDd,QAASA,4BAA2B,CAACP,CAAD;AAAIyB,MAAJ,CAAY,CAAE,GAAKzB,CAAL,CAAA,CAAgB,GAAiB,QAAjB,GAAI,MAAOA,EAAX,CAA2B,MAAO0B,kBAAA,CAAkB1B,CAAlB,CAAqByB,MAArB,CAA8B,KAAIb,EAAIe,MAAA,CAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+B9B,CAA/B,CAAA,CAAkC+B,KAAlC,CAAwC,CAAxC,CAA2C,EAA3C,CAA0D,SAAV,GAAInB,CAAJ,EAAsBZ,CAAtB,CAAwBgC,WAAxB,GAAqCpB,CAArC,CAAyCZ,CAAzC,CAA2CgC,WAA3C,CAAuDC,IAAvD,CAA6D,IAAU,KAAV,GAAIrB,CAAJ,EAAyB,KAAzB,GAAmBA,CAAnB,CAAgC,MAAOP,MAAA,CAAM6B,IAAN,CAAWlC,CAAX,CAAe,IAAU,WAAV,GAAIY,CAAJ,EAAyB,0CAAA,CAA2CuB,IAA3C,CAAgDvB,CAAhD,CAAzB,CAA6E,MAAOc,kBAAA,CAAkB1B,CAAlB,CAAqByB,MAArB,CAA/U,CAAF,CAEhDC,QAASA,kBAAiB,CAACU,GAAD,CAAMC,GAAN,CAAW,CAAE,GAAW,IAAX,EAAIA,GAAJ,EAAmBA,GAAnB,CAAyBD,GAAzB,CAA6B5B,MAA7B,CAAqC6B,GAAA,CAAMD,GAAN,CAAU5B,MAAQ,KAAzD,IAAkEC,EAAI,CAAtE,CAAyE6B,KAAWjC,KAAJ,CAAUgC,GAAV,CAAvB,CAAuC5B,CAAvC,CAA2C4B,GAA3C,CAAgD5B,CAAA,EAAhD,CAAuD6B,IAAA,CAAK7B,CAAL,CAAA,CAAU2B,GAAA,CAAI3B,CAAJ,CAAU,OAAO6B,KAA3I,CAqFrCC,QAASA,qBAAoB,EAAG,CAoB9B,IAnBA,IAAIC;AAA0B,CAAnB,CAAAC,SAAA,CAAUjC,MAAV,EAAyCkC,IAAAA,EAAzC,GAAwBD,SAAA,CAAU,CAAV,CAAxB,CAAqDA,SAAA,CAAU,CAAV,CAArD,CAAoE,EAA/E,CACIE,QAA6B,CAAnB,CAAAF,SAAA,CAAUjC,MAAV,EAAyCkC,IAAAA,EAAzC,GAAwBD,SAAA,CAAU,CAAV,CAAxB,CAAqDA,SAAA,CAAU,CAAV,CAArD,CAAoE,EADlF,CAEIG,SAAW,CACbC,sBAAuB,CAAA,CAAQL,IAAR,CAAaM,eADvB,CAEbC,qBAAsBP,IAAA,CAAKQ,UAAL,CAA2C,CAA3C,CAAkBR,IAAlB,CAAuBQ,UAAvB,CAAkCxC,MAAlC,CAA+C,CAAA,CAFxD,CAGbyC,cAAeT,IAAfS,CAAoBC,WAApBD,EAAmCE,oBAHtB,CAIbC,gBAAiBZ,IAAjBY,CAAsBC,aAAtBD,EAAuC,CAJ1B,CAKbE,mBAAoBd,IAApBc,CAAyBC,cAAzBD,CAAwC9C,MAL3B,CAFf,CASIgD,OAASC,iCAAA,CAAkC,CAC7CC,SAAUlB,IAAVkB,CAAeA,QAD8B,CAE7CF,OAAQb,OAARa,CAAgBG,eAF6B,CAAlC,CATb,CAaIC,eAAiB,EAbrB,CAcIC;AAAyBC,iCAAA,CAAkC,CAC7DP,eAAgBf,IAAhBe,CAAqBA,cADwC,CAE7DG,SAAUlB,IAAVkB,CAAeA,QAF8C,CAAlC,CAAA,CAG1B3B,KAH0B,EAd7B,CAmBStB,EAAI,CAAb,CAAgBA,CAAhB,CAAoB+B,IAApB,CAAyBe,cAAzB,CAAwC/C,MAAxC,CAAgDC,CAAA,EAAhD,CAAqD,CACnD,IAAIsD,qBAAuBF,sBAAA,CAAuBpD,CAAvB,CAA3B,CACIuD,6BAA+BD,oBAAA,CAAqBE,KAArB,EAAA,CAA6BC,SAA7B,CAAuC,CAAA,IAAIC,KAAJ,CAAUC,OAAV,CAAkB5B,IAAlB,CAAuBkB,QAAvB,CAAgCF,MAAhC,CAAA,EAAwCa,MAAxC,EAAvC,CAE/B1B,QAAJ,CAAY2B,yBAAZ,GAA0CC,UAA1C,CAAqDC,iBAArD,CAAuEC,MAAvE,EAAiF9B,OAAjF,CAAyF+B,uBAAzF,GAAqHH,UAArH,CAAgII,eAAhI,CAAgJC,YAAhJ,EACEf,sBAAA,CAAuBpD,CAAvB,CACA,CAD4BuD,4BAC5B;AAAAJ,cAAA,CAAenD,CAAf,CAAA,CAAoB+C,MAFtB,GAIEK,sBAAA,CAAuBpD,CAAvB,CACA,CAD4BsD,oBAAA,CAAqBE,KAArB,EAAA,CAA6BY,aAA7B,CAA2CC,sBAA3C,CAC5B,CAAAlB,cAAA,CAAenD,CAAf,CAAA,CAAoBuD,4BAAA,CAA6Be,SAA7B,CAAuCvB,MAAvC,CALtB,CAJmD,CAarD,IAASwB,OAAT,CAAc,CAAd,CAAiBA,OAAjB,CAAsBnB,sBAAtB,CAA6CrD,MAA7C,CAAqDwE,OAAA,EAArD,CACEpC,QAAA,CAASqC,iCAAA,CAAkCA,MAAlC,CAAyCD,OAAzC,CAA6C,GAA7C,CAAT,CAGA,CAH8DnB,sBAAA,CAAuBmB,OAAvB,CAG9D,CAFApC,QAAA,CAASqC,yBAAA,CAA0BA,MAA1B,CAAiCD,OAAjC,CAAqC,GAArC,CAAT,CAEA,CAFsDpB,cAAA,CAAeoB,OAAf,CAEtD,CAAIxC,IAAJ,CAASQ,UAAT,EAAgD,CAAhD,CAAuBR,IAAvB,CAA4BQ,UAA5B,CAAuCxC,MAAvC,CACEoC,QAAA,CAASqC,mBAAA,CAAoBA,MAApB,CAA2BD,OAA3B,CAAT,CADF;AAC6CxC,IAAA,CAAKQ,UAAL,CAAgBgC,OAAhB,CAD7C,CAGEpC,QAAA,CAASqC,mBAAA,CAAoBA,MAApB,CAA2BD,OAA3B,CAAT,CAHF,CAG6CxC,IAH7C,CAGkD0C,cAIpD,OAAOtC,SA5CuB,CA9G5BuC,MAAAA,CAAyBvF,OAAA,CAAQ,kEAAR,CAE7B+B,OAAA,CAAOyD,cAAP,CAAsBtF,OAAtB,CAA+B,YAA/B,CAA6C,CAC3CgB,MAAO,CAAA,CADoC,CAA7C,CAGAhB,QAAA,CAAQ,SAAR,CAAA,CAAqB,IAAK,EAE1B,KAAIuF,oBAAsBF,MAAA,CAAuBvF,OAAA,CAAQ,8DAAR,CAAvB,CAA1B,CAEI0F,gBAAkBH,MAAA,CAAuBvF,OAAA,CAAQ,0DAAR,CAAvB,CAFtB,CAII2E,WAAa3E,OAAA,CAAQ,8DAAR,CAEb2F;MAAAA,CAAWJ,MAAA,CAAuBvF,OAAA,CAAQ,0EAAR,CAAvB,CAEf,KAAIuE,MAAQvE,OAAA,CAAQ,gDAAR,CAER4F,OAAAA,CAAWL,MAAA,CAAuBvF,OAAA,CAAQ,8DAAR,CAAvB,CAEf,KAAI6F,aAAe7F,OAAA,CAAQ,8DAAR,CAAnB,CAUI6D,kCAAoC,CAAC,CAAA,CAAG+B,MAAA,CAAS,SAAT,CAAJ,EAoBxCE,QAAkC,CAACC,IAAD,CAAO,CACvC,IACInC,OAASmC,IAATnC,CAAcA,MAClB,OAAO,CAAA,IAAIW,KAAJ,CAAUyB,OAAV,CAFQD,IAER,CAFajC,QAEb,CAA2BK,oBAA3B,CAAA,EAAiD8B,MAAjD,EAAA,CAA0Dd,SAA1D,CAAoEvB,MAApE,CAHgC,CApBD,CAVxC;AAWIM,kCAAoC,CAAC,CAAA,CAAG0B,MAAA,CAAS,SAAT,CAAJ,EAyBxCM,QAAkC,CAACC,KAAD,CAAQ,CAAA,IACpCrC,SAAWqC,KAAXrC,CAAiBA,QACjBH,MAAAA,CAAiBwC,KAAjBxC,CAAuBA,cAC3B,KAAIyC,mBAAqB,EAAzB,CACIC,wBAA0BvC,QAA1BuC,CAAmCA,uBADvC,CAEIC,KAAOxC,QAAA,CAASyC,YAAT,CAAwBzD,IAAAA,EAAxB,CAAoC,CAF/C,CAGI0D,QAAU,CAAC,CAAC,CAAD,CAAI,CAAJ,CAAOF,IAAP,CAAD,CAAe,CAACxC,QAAD,CAAU2C,KAAV,CAAiB,CAAjB,CAAoBH,IAApB,CAAf,CAA0C,CAAC,CAAD,CAAIxC,QAAJ,CAAa4C,MAAb,CAAqBJ,IAArB,CAA1C,CAAsE,CAACxC,QAAD,CAAU2C,KAAV,CAAiB3C,QAAjB,CAA0B4C,MAA1B,CAAkCJ,IAAlC,CAAtE,CAA+G,CAAC,CAAD,CAAI,CAAJ,CAAO,EAAP,CAA/G,CAA2H,CAACxC,QAAD,CAAU2C,KAAV,CAAiB,CAAjB,CAAoB,EAApB,CAA3H,CAAoJ,CAAC,CAAD,CAAI3C,QAAJ,CAAa4C,MAAb,CAAqB,EAArB,CAApJ,CAA8K,CAAC5C,QAAD,CAAU2C,KAAV,CAAiB3C,QAAjB,CAA0B4C,MAA1B,CAAkC,EAAlC,CAA9K,CAAA,CAAqNC,GAArN,CAAyN,QAAS,CAACC,KAAD,CAAQ,CA3B/L,IACrDC,KAAO,CAAC,CAAA,CAAGnB,eAAA,CAAgB,SAAhB,CAAJ,EA2BkBkB,KA3BlB;AAAqC,CAArC,CACPE,MAAAA,CAAID,IAAA,CAAK,CAAL,CAFiD,KAGrDE,EAAIF,IAAA,CAAK,CAAL,CACJG,KAAAA,CAAIH,IAAA,CAAK,CAAL,CAEJI,MAAAA,CAAQ,CAAC,CAAA,CAAGpB,YAAH,CAAgBqB,aAAjB,EAAgC,CAACJ,KAAD,CAAIC,CAAJ,CAAOC,IAAP,CAAhC,CAsBwBX,uBAtBxB,CAGV,MAAA,CADEc,MAAA,CAAOC,QAAP,CAAgBJ,IAAhB,CAAJ,CACSC,KADT,CAIO,CAACA,KAAA,CAAM,CAAN,CAAD,CAAWA,KAAA,CAAM,CAAN,CAAX,CAAqB,CAArB,CAgBL,OAAO,MAD+O,CAA1O,CAIVI,MAAAA,CAAYlH,0BAAA,CAA2BwD,KAA3B,CAAhB,KACI2D,KAEJ,IAAI,CA8BF,IA7BIC,IA6BC,CA7BOA,QAAc,EAAG,CAC3B,IAAIC,aAAeF,KAAfE,CAAqBtG,KAAzB,CACIuG,WAAaD,YAAA,CAAanD,KAAb,EAAA,CAAqBC,SAArB,CAA+B,CAAA,IAAIC,KAAJ,CAAUC,OAAV,CAAkBV,QAAlB,CAA2BF,MAA3B,CAAA,EAAmCa,MAAnC,EAA/B,CADjB,CAEIiD,UAAYlB,OAAA,CAAQG,GAAR,CAAY,QAAS,CAACgB,MAAD,CAAS,CAC5C,MAAOF,WAAA,CAAWtC,SAAX,CAAqBwC,MAArB,CADqC,CAA9B,CAGZC,UAAAA,CAAmB,CAAA,IAAIrD,KAAJ,CAAUyB,OAAV,EAAoB6B,KAApB,CAA0B,CAC/CC,KAAMC,IAAA,CAAKC,GAAL,CAASC,KAAT,CAAeF,IAAf;AAAqB,CAAC,CAAA,CAAGtC,mBAAA,CAAoB,SAApB,CAAJ,EAAoCiC,SAAA,CAAUf,GAAV,CAAc,QAAS,CAACuB,QAAD,CAAW,CAC/F,MAAOA,SAAA,CAAS,CAAT,CADwF,CAAlC,CAApC,CAArB,CADyC,CAI/CC,MAAOJ,IAAA,CAAKK,GAAL,CAASH,KAAT,CAAeF,IAAf,CAAqB,CAAC,CAAA,CAAGtC,mBAAA,CAAoB,SAApB,CAAJ,EAAoCiC,SAAA,CAAUf,GAAV,CAAc,QAAS,CAACuB,QAAD,CAAW,CAChG,MAAOA,SAAA,CAAS,CAAT,CADyF,CAAlC,CAApC,CAArB,CAJwC,CAO/CG,OAAQN,IAAA,CAAKC,GAAL,CAASC,KAAT,CAAeF,IAAf,CAAqB,CAAC,CAAA,CAAGtC,mBAAA,CAAoB,SAApB,CAAJ,EAAoCiC,SAAA,CAAUf,GAAV,CAAc,QAAS,CAACuB,QAAD,CAAW,CACjG,MAAOA,SAAA,CAAS,CAAT,CAD0F,CAAlC,CAApC,CAArB,CAPuC,CAU/CI,IAAKP,IAAA,CAAKK,GAAL,CAASH,KAAT,CAAeF,IAAf,CAAqB,CAAC,CAAA,CAAGtC,mBAAA,CAAoB,SAApB,CAAJ,EAAoCiC,SAAA,CAAUf,GAAV,CAAc,QAAS,CAACuB,QAAD,CAAW,CAC9F,MAAOA,SAAA,CAAS,CAAT,CADuF,CAAlC,CAApC,CAArB,CAV0C,CAa/CK,KAAMR,IAAA,CAAKC,GAAL,CAASC,KAAT,CAAeF,IAAf,CAAqB,CAAC,CAAA,CAAGtC,mBAAA,CAAoB,SAApB,CAAJ,EAAoCiC,SAAA,CAAUf,GAAV,CAAc,QAAS,CAACuB,QAAD,CAAW,CAC/F,MAAO,CAACA,QAAA,CAAS,CAAT,CADuF,CAAlC,CAApC,CAArB,CAbyC;AAgB/CM,IAAKT,IAAA,CAAKK,GAAL,CAASH,KAAT,CAAeF,IAAf,CAAqB,CAAC,CAAA,CAAGtC,mBAAA,CAAoB,SAApB,CAAJ,EAAoCiC,SAAA,CAAUf,GAAV,CAAc,QAAS,CAACuB,QAAD,CAAW,CAC9F,MAAO,CAACA,QAAA,CAAS,CAAT,CADsF,CAAlC,CAApC,CAArB,CAhB0C,CAA1B,CAoBvB9B,mBAAA,CAAmBqC,IAAnB,CAAwBb,SAAA,CAAiB3C,aAAjB,CAA+BuC,YAA/B,CAAxB,CA1B2B,CA6BxB,CAAAH,KAAA,CAAUtG,CAAV,EAAL,CAAoB,EAAEuG,KAAF,CAAUD,KAAA,CAAUrG,CAAV,EAAV,EAAyBC,IAA7C,CAAA,CACEsG,IAAA,EA/BA,CAiCF,MAAO9F,GAAP,CAAY,CACZ4F,KAAA,CAAUlG,CAAV,CAAYM,GAAZ,CADY,CAjCd,OAmCU,CACR4F,KAAA,CAAUhG,CAAV,EADQ,CAIV,MAAO+E,mBApDiC,CAzBF,CAXxC,CAYI7C,qBAAuB,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAZ3B,CAaI2B,uBAAyB,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CAAmB,CAAnB,CAAsB,CAAtB,CAAyB,CAAzB,CAA4B,CAA5B,CAA+B,CAA/B,CAAkC,CAAlC,CAAqC,CAArC,CAAwC,CAAxC,CAA2C,CAA3C,CAA8C,CAA9C,CA8J7BhF,QAAA,CAAQ,SAAR,CAAA,CAjCewI,CACbrG,KAAM,QADOqG,CAEbC,aAAc,CAAChD,MAAA,CAAS,SAAT,CAAD,CAFD+C,CAGbE,GArIOA,s/BAkIMF;AAIbG,GArIOA,q+CAiIMH;AAKbI,OAAQ,CACN,+BAAgC,wEAD1B,CAEN,yBAA0B,yDAFpB,CALKJ,CASbK,YAAaA,QAAoB,EAAG,CAClC,IAAInG,KAA0B,CAAnB,CAAAC,SAAA,CAAUjC,MAAV,EAAyCkC,IAAAA,EAAzC,GAAwBD,SAAA,CAAU,CAAV,CAAxB,CAAqDA,SAAA,CAAU,CAAV,CAArD,CAAoE,EAA/E,CACIE,QAA6B,CAAnB,CAAAF,SAAA,CAAUjC,MAAV,EAAyCkC,IAAAA,EAAzC,GAAwBD,SAAA,CAAU,CAAV,CAAxB,CAAqDA,SAAA,CAAU,CAAV,CAArD,CAAoE,EAElF,IAAID,IAAJ,CAASM,eAAT,EAA4BN,IAA5B,CAAiCQ,UAAjC,EAAwE,CAAxE,CAA+CR,IAA/C,CAAoDQ,UAApD,CAA+DxC,MAA/D,CAA2E,CACzE,IAAIoI,eAAiB,EAArB,CACIC,oBAAsBrG,IAAtBqG,CAA2BC,aAG/B,EAF4C,IAAK,EAEjD,GAFoBD,mBAEpB;AAF4DA,mBAE5D,GAAqBrG,IAArB,CAA0Be,cAA1B,EAAyE,CAAzE,CAA4Cf,IAA5C,CAAiDe,cAAjD,CAAgE/C,MAAhE,CACEmB,MAAA,CAAOoH,MAAP,CAAcH,cAAd,CAA8BrG,oBAAA,CAAqBC,IAArB,CAA2BG,OAA3B,CAA9B,CADF,CAGEhB,MAAA,CAAOoH,MAAP,CAAcH,cAAd,CAA8B,CAC5B/F,sBAAuB,CAAA,CADK,CAE5BE,qBAAsB,CAAA,CAFM,CAA9B,CAMF,OAAO6F,eAdkE,CAiB3E,MAAO,EArB2B,CATvBN,CAhKoH;",
"sources":["node_modules/@deck_DOT_gl/core/dist/es5/shaderlib/shadow/shadow.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$deck_DOT_gl$core$dist$es5$shaderlib$shadow$shadow\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _constants = require(\"../../lib/constants\");\n\nvar _project = _interopRequireDefault(require(\"../project/project\"));\n\nvar _math = require(\"math.gl\");\n\nvar _memoize = _interopRequireDefault(require(\"../../utils/memoize\"));\n\nvar _webMercator = require(\"@math.gl/web-mercator\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar vs = \"\\nconst int max_lights = 2;\\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\\nuniform vec4 shadow_uProjectCenters[max_lights];\\nuniform bool shadow_uDrawShadowMap;\\nuniform bool shadow_uUseShadowMap;\\nuniform int shadow_uLightId;\\nuniform float shadow_uLightCount;\\n\\nvarying vec3 shadow_vPosition[max_lights];\\n\\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\\n  if (shadow_uDrawShadowMap) {\\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\\n  }\\n  if (shadow_uUseShadowMap) {\\n    for (int i = 0; i < max_lights; i++) {\\n      if(i < int(shadow_uLightCount)) {\\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\\n      }\\n    }\\n  }\\n  return gl_Position;\\n}\\n\";\nvar fs = \"\\nconst int max_lights = 2;\\nuniform bool shadow_uDrawShadowMap;\\nuniform bool shadow_uUseShadowMap;\\nuniform sampler2D shadow_uShadowMap0;\\nuniform sampler2D shadow_uShadowMap1;\\nuniform vec4 shadow_uColor;\\nuniform float shadow_uLightCount;\\n\\nvarying vec3 shadow_vPosition[max_lights];\\n\\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\\n\\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\\n\\n  float z = dot(rgbaDepth, bitUnpackShift);\\n  return smoothstep(0.001, 0.01, position.z - z);\\n}\\n\\nvec4 shadow_filterShadowColor(vec4 color) {\\n  if (shadow_uDrawShadowMap) {\\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\\n    return rgbaDepth;\\n  }\\n  if (shadow_uUseShadowMap) {\\n    float shadowAlpha = 0.0;\\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\\n    if(shadow_uLightCount > 1.0) {\\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\\n    }\\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\\n\\n    return vec4(\\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\\n      blendedAlpha\\n    );\\n  }\\n  return color;\\n}\\n\";\nvar getMemoizedViewportCenterPosition = (0, _memoize[\"default\"])(getViewportCenterPosition);\nvar getMemoizedViewProjectionMatrices = (0, _memoize[\"default\"])(getViewProjectionMatrices);\nvar DEFAULT_SHADOW_COLOR = [0, 0, 0, 1.0];\nvar VECTOR_TO_POINT_MATRIX = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0];\n\nfunction screenToCommonSpace(xyz, pixelUnprojectionMatrix) {\n  var _xyz = (0, _slicedToArray2[\"default\"])(xyz, 3),\n      x = _xyz[0],\n      y = _xyz[1],\n      z = _xyz[2];\n\n  var coord = (0, _webMercator.pixelsToWorld)([x, y, z], pixelUnprojectionMatrix);\n\n  if (Number.isFinite(z)) {\n    return coord;\n  }\n\n  return [coord[0], coord[1], 0];\n}\n\nfunction getViewportCenterPosition(_ref) {\n  var viewport = _ref.viewport,\n      center = _ref.center;\n  return new _math.Matrix4(viewport.viewProjectionMatrix).invert().transform(center);\n}\n\nfunction getViewProjectionMatrices(_ref2) {\n  var viewport = _ref2.viewport,\n      shadowMatrices = _ref2.shadowMatrices;\n  var projectionMatrices = [];\n  var pixelUnprojectionMatrix = viewport.pixelUnprojectionMatrix;\n  var farZ = viewport.isGeospatial ? undefined : 1;\n  var corners = [[0, 0, farZ], [viewport.width, 0, farZ], [0, viewport.height, farZ], [viewport.width, viewport.height, farZ], [0, 0, -1], [viewport.width, 0, -1], [0, viewport.height, -1], [viewport.width, viewport.height, -1]].map(function (pixel) {\n    return screenToCommonSpace(pixel, pixelUnprojectionMatrix);\n  });\n\n  var _iterator = _createForOfIteratorHelper(shadowMatrices),\n      _step;\n\n  try {\n    var _loop = function _loop() {\n      var shadowMatrix = _step.value;\n      var viewMatrix = shadowMatrix.clone().translate(new _math.Vector3(viewport.center).negate());\n      var positions = corners.map(function (corner) {\n        return viewMatrix.transform(corner);\n      });\n      var projectionMatrix = new _math.Matrix4().ortho({\n        left: Math.min.apply(Math, (0, _toConsumableArray2[\"default\"])(positions.map(function (position) {\n          return position[0];\n        }))),\n        right: Math.max.apply(Math, (0, _toConsumableArray2[\"default\"])(positions.map(function (position) {\n          return position[0];\n        }))),\n        bottom: Math.min.apply(Math, (0, _toConsumableArray2[\"default\"])(positions.map(function (position) {\n          return position[1];\n        }))),\n        top: Math.max.apply(Math, (0, _toConsumableArray2[\"default\"])(positions.map(function (position) {\n          return position[1];\n        }))),\n        near: Math.min.apply(Math, (0, _toConsumableArray2[\"default\"])(positions.map(function (position) {\n          return -position[2];\n        }))),\n        far: Math.max.apply(Math, (0, _toConsumableArray2[\"default\"])(positions.map(function (position) {\n          return -position[2];\n        })))\n      });\n      projectionMatrices.push(projectionMatrix.multiplyRight(shadowMatrix));\n    };\n\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      _loop();\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return projectionMatrices;\n}\n\nfunction createShadowUniforms() {\n  var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var uniforms = {\n    shadow_uDrawShadowMap: Boolean(opts.drawToShadowMap),\n    shadow_uUseShadowMap: opts.shadowMaps ? opts.shadowMaps.length > 0 : false,\n    shadow_uColor: opts.shadowColor || DEFAULT_SHADOW_COLOR,\n    shadow_uLightId: opts.shadowLightId || 0,\n    shadow_uLightCount: opts.shadowMatrices.length\n  };\n  var center = getMemoizedViewportCenterPosition({\n    viewport: opts.viewport,\n    center: context.project_uCenter\n  });\n  var projectCenters = [];\n  var viewProjectionMatrices = getMemoizedViewProjectionMatrices({\n    shadowMatrices: opts.shadowMatrices,\n    viewport: opts.viewport\n  }).slice();\n\n  for (var i = 0; i < opts.shadowMatrices.length; i++) {\n    var viewProjectionMatrix = viewProjectionMatrices[i];\n    var viewProjectionMatrixCentered = viewProjectionMatrix.clone().translate(new _math.Vector3(opts.viewport.center).negate());\n\n    if (context.project_uCoordinateSystem === _constants.COORDINATE_SYSTEM.LNGLAT && context.project_uProjectionMode === _constants.PROJECTION_MODE.WEB_MERCATOR) {\n      viewProjectionMatrices[i] = viewProjectionMatrixCentered;\n      projectCenters[i] = center;\n    } else {\n      viewProjectionMatrices[i] = viewProjectionMatrix.clone().multiplyRight(VECTOR_TO_POINT_MATRIX);\n      projectCenters[i] = viewProjectionMatrixCentered.transform(center);\n    }\n  }\n\n  for (var _i = 0; _i < viewProjectionMatrices.length; _i++) {\n    uniforms[\"shadow_uViewProjectionMatrices[\".concat(_i, \"]\")] = viewProjectionMatrices[_i];\n    uniforms[\"shadow_uProjectCenters[\".concat(_i, \"]\")] = projectCenters[_i];\n\n    if (opts.shadowMaps && opts.shadowMaps.length > 0) {\n      uniforms[\"shadow_uShadowMap\".concat(_i)] = opts.shadowMaps[_i];\n    } else {\n      uniforms[\"shadow_uShadowMap\".concat(_i)] = opts.dummyShadowMap;\n    }\n  }\n\n  return uniforms;\n}\n\nvar _default = {\n  name: 'shadow',\n  dependencies: [_project[\"default\"]],\n  vs: vs,\n  fs: fs,\n  inject: {\n    'vs:DECKGL_FILTER_GL_POSITION': \"\\n    position = shadow_setVertexPosition(geometry.position);\\n    \",\n    'fs:DECKGL_FILTER_COLOR': \"\\n    color = shadow_filterShadowColor(color);\\n    \"\n  },\n  getUniforms: function getUniforms() {\n    var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (opts.drawToShadowMap || opts.shadowMaps && opts.shadowMaps.length > 0) {\n      var shadowUniforms = {};\n      var _opts$shadowEnabled = opts.shadowEnabled,\n          shadowEnabled = _opts$shadowEnabled === void 0 ? true : _opts$shadowEnabled;\n\n      if (shadowEnabled && opts.shadowMatrices && opts.shadowMatrices.length > 0) {\n        Object.assign(shadowUniforms, createShadowUniforms(opts, context));\n      } else {\n        Object.assign(shadowUniforms, {\n          shadow_uDrawShadowMap: false,\n          shadow_uUseShadowMap: false\n        });\n      }\n\n      return shadowUniforms;\n    }\n\n    return {};\n  }\n};\nexports[\"default\"] = _default;\n//# sourceMappingURL=shadow.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","step","next","_e2","minLen","_arrayLikeToArray","Object","prototype","toString","call","slice","constructor","name","from","test","arr","len","arr2","createShadowUniforms","opts","arguments","undefined","context","uniforms","shadow_uDrawShadowMap","drawToShadowMap","shadow_uUseShadowMap","shadowMaps","shadow_uColor","shadowColor","DEFAULT_SHADOW_COLOR","shadow_uLightId","shadowLightId","shadow_uLightCount","shadowMatrices","center","getMemoizedViewportCenterPosition","viewport","project_uCenter","projectCenters","viewProjectionMatrices","getMemoizedViewProjectionMatrices","viewProjectionMatrix","viewProjectionMatrixCentered","clone","translate","_math","Vector3","negate","project_uCoordinateSystem","_constants","COORDINATE_SYSTEM","LNGLAT","project_uProjectionMode","PROJECTION_MODE","WEB_MERCATOR","multiplyRight","VECTOR_TO_POINT_MATRIX","transform","_i","concat","dummyShadowMap","_interopRequireDefault","defineProperty","_toConsumableArray2","_slicedToArray2","_project","_memoize","_webMercator","getViewportCenterPosition","_ref","Matrix4","invert","getViewProjectionMatrices","_ref2","projectionMatrices","pixelUnprojectionMatrix","farZ","isGeospatial","corners","width","height","map","pixel","_xyz","x","y","z","coord","pixelsToWorld","Number","isFinite","_iterator","_step","_loop","shadowMatrix","viewMatrix","positions","corner","projectionMatrix","ortho","left","Math","min","apply","position","right","max","bottom","top","near","far","push","_default","dependencies","vs","fs","inject","getUniforms","shadowUniforms","_opts$shadowEnabled","shadowEnabled","assign"]
}
