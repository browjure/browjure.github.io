shadow$provide.module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$cpu_grid_layer$grid_aggregator=function(global,require,module,exports){function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},
e:function(_e){throw _e;},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,
minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");
Object.defineProperty(exports,"__esModule",{value:!0});exports.pointToDensityGridDataCPU=function(props,aggregationParams){var _props$data=props.data,data=void 0===_props$data?[]:_props$data,cellSize=props.cellSize,attributes=aggregationParams.attributes;props=aggregationParams.viewport;_props$data=aggregationParams.projectPoints;var numInstances=aggregationParams.numInstances,positions=attributes.positions.value,size=attributes.positions.getAccessor().size,JSCompiler_temp;if(!(JSCompiler_temp=aggregationParams.boundingBox)){JSCompiler_temp=
attributes.positions;attributes=JSCompiler_temp.value;JSCompiler_temp=JSCompiler_temp.getAccessor().size;for(var yMin=Infinity,yMax=-Infinity,xMin=Infinity,xMax=-Infinity,y,x,i=0;i<numInstances;i++)x=attributes[i*JSCompiler_temp],y=attributes[i*JSCompiler_temp+1],Number.isFinite(x)&&Number.isFinite(y)&&(yMin=y<yMin?y:yMin,yMax=y>yMax?y:yMax,xMin=x<xMin?x:xMin,xMax=x>xMax?x:xMax);JSCompiler_temp={xMin,xMax,yMin,yMax}}attributes=JSCompiler_temp;numInstances=aggregationParams.posOffset||[180,90];aggregationParams=
aggregationParams.gridOffset||(0,_gridAggregationUtils.getGridOffset)(attributes,cellSize);if(0>=aggregationParams.xOffset||0>=aggregationParams.yOffset){var JSCompiler_object_inline_gridHash_4398={};var JSCompiler_object_inline_gridOffset_4399=aggregationParams;var JSCompiler_object_inline_offsets_4400=void 0}else{cellSize=Math.ceil(props.width/aggregationParams.xOffset);attributes=Math.ceil(props.height/aggregationParams.yOffset);JSCompiler_temp={};yMax=(0,_core.createIterable)(data);data=yMax.objectInfo;
yMin=Array(3);yMax=_createForOfIteratorHelper(yMax.iterable);try{for(yMax.s();!(JSCompiler_object_inline_gridHash_4398=yMax.n()).done;){JSCompiler_object_inline_gridOffset_4399=JSCompiler_object_inline_gridHash_4398.value;data.index++;yMin[0]=positions[data.index*size];yMin[1]=positions[data.index*size+1];yMin[2]=3<=size?positions[data.index*size+2]:0;var _ref=_props$data?props.project(yMin):yMin,_ref2=(0,_slicedToArray2["default"])(_ref,2);JSCompiler_object_inline_offsets_4400=_ref2[0];var y$jscomp$0=
_ref2[1];if(Number.isFinite(JSCompiler_object_inline_offsets_4400)&&Number.isFinite(y$jscomp$0)){var yIndex=Math.floor((y$jscomp$0+numInstances[1])/aggregationParams.yOffset),xIndex=Math.floor((JSCompiler_object_inline_offsets_4400+numInstances[0])/aggregationParams.xOffset);if(!_props$data||0<=xIndex&&xIndex<cellSize&&0<=yIndex&&yIndex<attributes){var key="".concat(yIndex,"-").concat(xIndex);JSCompiler_temp[key]=JSCompiler_temp[key]||{count:0,points:[],lonIdx:xIndex,latIdx:yIndex};JSCompiler_temp[key].count+=
1;JSCompiler_temp[key].points.push({source:JSCompiler_object_inline_gridOffset_4399,index:data.index})}}}}catch(err){yMax.e(err)}finally{yMax.f()}JSCompiler_object_inline_gridHash_4398=JSCompiler_temp;JSCompiler_object_inline_gridOffset_4399=aggregationParams;JSCompiler_object_inline_offsets_4400=[-1*numInstances[0],-1*numInstances[1]]}_ref=JSCompiler_object_inline_gridHash_4398;_ref2=JSCompiler_object_inline_gridOffset_4399;y$jscomp$0=Array(Object.keys(_ref).length);yIndex=0;for(var key$jscomp$0 in _ref)key=
key$jscomp$0.split("-"),xIndex=parseInt(key[0],10),key=parseInt(key[1],10),props=yIndex++,y$jscomp$0[props]=Object.assign({index:props,position:[JSCompiler_object_inline_offsets_4400[0]+_ref2.xOffset*key,JSCompiler_object_inline_offsets_4400[1]+_ref2.yOffset*xIndex]},_ref[key$jscomp$0]);return{gridHash:JSCompiler_object_inline_gridHash_4398,gridOffset:JSCompiler_object_inline_gridOffset_4399,data:y$jscomp$0}};var _slicedToArray2=global(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),
_core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),_gridAggregationUtils=require("module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$utils$grid_aggregation_utils")}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$aggregation_layers$dist$es5$cpu_grid_layer$grid_aggregator.js.map
