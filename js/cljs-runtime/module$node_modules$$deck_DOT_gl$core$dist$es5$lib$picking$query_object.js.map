{
"version":3,
"file":"module$node_modules$$deck_DOT_gl$core$dist$es5$lib$picking$query_object.js",
"lineCount":5,
"mappings":"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",
"sources":["node_modules/@deck_DOT_gl/core/dist/es5/lib/picking/query-object.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$deck_DOT_gl$core$dist$es5$lib$picking$query_object\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getClosestObject = getClosestObject;\nexports.getUniqueObjects = getUniqueObjects;\n\nvar _log = _interopRequireDefault(require(\"../../utils/log\"));\n\nvar NO_PICKED_OBJECT = {\n  pickedColor: null,\n  pickedLayer: null,\n  pickedObjectIndex: -1\n};\n\nfunction getClosestObject(_ref) {\n  var pickedColors = _ref.pickedColors,\n      layers = _ref.layers,\n      deviceX = _ref.deviceX,\n      deviceY = _ref.deviceY,\n      deviceRadius = _ref.deviceRadius,\n      deviceRect = _ref.deviceRect;\n\n  if (pickedColors) {\n    var x = deviceRect.x,\n        y = deviceRect.y,\n        width = deviceRect.width,\n        height = deviceRect.height;\n    var minSquareDistanceToCenter = deviceRadius * deviceRadius;\n    var closestPixelIndex = -1;\n    var i = 0;\n\n    for (var row = 0; row < height; row++) {\n      var dy = row + y - deviceY;\n      var dy2 = dy * dy;\n\n      if (dy2 > minSquareDistanceToCenter) {\n        i += 4 * width;\n      } else {\n        for (var col = 0; col < width; col++) {\n          var pickedLayerIndex = pickedColors[i + 3] - 1;\n\n          if (pickedLayerIndex >= 0) {\n            var dx = col + x - deviceX;\n            var d2 = dx * dx + dy2;\n\n            if (d2 <= minSquareDistanceToCenter) {\n              minSquareDistanceToCenter = d2;\n              closestPixelIndex = i;\n            }\n          }\n\n          i += 4;\n        }\n      }\n    }\n\n    if (closestPixelIndex >= 0) {\n      var _pickedLayerIndex = pickedColors[closestPixelIndex + 3] - 1;\n\n      var pickedColor = pickedColors.slice(closestPixelIndex, closestPixelIndex + 4);\n      var pickedLayer = layers[_pickedLayerIndex];\n\n      if (pickedLayer) {\n        var pickedObjectIndex = pickedLayer.decodePickingColor(pickedColor);\n\n        var _dy = Math.floor(closestPixelIndex / 4 / width);\n\n        var _dx = closestPixelIndex / 4 - _dy * width;\n\n        return {\n          pickedColor: pickedColor,\n          pickedLayer: pickedLayer,\n          pickedObjectIndex: pickedObjectIndex,\n          pickedX: x + _dx,\n          pickedY: y + _dy\n        };\n      }\n\n      _log[\"default\"].error('Picked non-existent layer. Is picking buffer corrupt?')();\n    }\n  }\n\n  return NO_PICKED_OBJECT;\n}\n\nfunction getUniqueObjects(_ref2) {\n  var pickedColors = _ref2.pickedColors,\n      layers = _ref2.layers;\n  var uniqueColors = new Map();\n\n  if (pickedColors) {\n    for (var i = 0; i < pickedColors.length; i += 4) {\n      var pickedLayerIndex = pickedColors[i + 3] - 1;\n\n      if (pickedLayerIndex >= 0) {\n        var pickedColor = pickedColors.slice(i, i + 4);\n        var colorKey = pickedColor.join(',');\n\n        if (!uniqueColors.has(colorKey)) {\n          var pickedLayer = layers[pickedLayerIndex];\n\n          if (pickedLayer) {\n            uniqueColors.set(colorKey, {\n              pickedColor: pickedColor,\n              pickedLayer: pickedLayer,\n              pickedObjectIndex: pickedLayer.decodePickingColor(pickedColor)\n            });\n          } else {\n            _log[\"default\"].error('Picked non-existent layer. Is picking buffer corrupt?')();\n          }\n        }\n      }\n    }\n  }\n\n  return Array.from(uniqueColors.values());\n}\n//# sourceMappingURL=query-object.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","getClosestObject","_ref","pickedColors","layers","deviceX","deviceY","deviceRadius","deviceRect","x","y","width","height","minSquareDistanceToCenter","closestPixelIndex","i","row","dy","dy2","col","dx","d2","_pickedLayerIndex","pickedColor","slice","pickedLayer","pickedObjectIndex","decodePickingColor","_dy","Math","floor","pickedX","pickedY","_log","error","NO_PICKED_OBJECT","getUniqueObjects","_ref2","uniqueColors","Map","length","pickedLayerIndex","colorKey","join","has","set","Array","from","values"]
}
