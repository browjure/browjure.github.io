shadow$provide.module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$vertex_array_object=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),
_assertThisInitialized2=global(require("module$node_modules$$babel$runtime$helpers$assertThisInitialized")),_get2=global(require("module$node_modules$$babel$runtime$helpers$get")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf"));
module=global(require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$resource"));var _buffer=global(require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$buffer")),_gltools=require("module$node_modules$$luma_DOT_gl$gltools$dist$es5$index"),_arrayUtilsFlat=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$utils$array_utils_flat"),_utils=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$utils$index"),_probe=require("module$node_modules$probe_DOT_gl$dist$es5$index");
require=function(_Resource){function VertexArrayObject(gl){var opts=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,_classCallCheck2["default"])(this,VertexArrayObject);var _this=_super.call(this,gl,Object.assign({},opts,{id:opts.id||opts.program&&opts.program.id}));_this.buffer=null;_this.bufferValue=null;_this.isDefaultArray=opts.isDefaultArray||!1;_this.gl2=gl;_this.initialize(opts);Object.seal((0,_assertThisInitialized2["default"])(_this));return _this}(0,_inherits2["default"])(VertexArrayObject,
_Resource);var _super=_createSuper(VertexArrayObject);(0,_createClass2["default"])(VertexArrayObject,null,[{key:"isSupported",value:function(gl){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero?(0,_gltools.isWebGL2)(gl)||"Chrome"===(0,_probe.getBrowser)():!0}},{key:"getDefaultArray",value:function(gl){gl.luma=gl.luma||{};gl.luma.defaultVertexArray||(gl.luma.defaultVertexArray=new VertexArrayObject(gl,{handle:null,isDefaultArray:!0}));return gl.luma.defaultVertexArray}},
{key:"getMaxAttributes",value:function(gl){VertexArrayObject.MAX_ATTRIBUTES=VertexArrayObject.MAX_ATTRIBUTES||gl.getParameter(34921);return VertexArrayObject.MAX_ATTRIBUTES}},{key:"setConstant",value:function(gl,location,array){switch(array.constructor){case Float32Array:VertexArrayObject._setConstantFloatArray(gl,location,array);break;case Int32Array:VertexArrayObject._setConstantIntArray(gl,location,array);break;case Uint32Array:VertexArrayObject._setConstantUintArray(gl,location,array);break;default:(0,
_utils.assert)(!1)}}}]);(0,_createClass2["default"])(VertexArrayObject,[{key:"delete",value:function(){(0,_get2["default"])((0,_getPrototypeOf2["default"])(VertexArrayObject.prototype),"delete",this).call(this);if(this.buffer)this.buffer["delete"]();return this}},{key:"initialize",value:function(){return this.setProps(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"setProps",value:function(props){return this}},{key:"setElementBuffer",value:function(){var _this2=this,elementBuffer=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;(0,_utils.assert)(!elementBuffer||34963===elementBuffer.target,"elements must be GL.ELEMENT_ARRAY_BUFFER");this.bind(function(){_this2.gl.bindBuffer(34963,elementBuffer?elementBuffer.handle:null)});return this}},{key:"setBuffer",value:function(location,buffer,accessor){if(34963===buffer.target)return this.setElementBuffer(buffer,accessor);var size=accessor.size,type=accessor.type,stride=accessor.stride,offset=accessor.offset,normalized=accessor.normalized,
integer=accessor.integer,divisor=accessor.divisor,gl=this.gl,gl2=this.gl2;location=Number(location);this.bind(function(){gl.bindBuffer(34962,buffer.handle);integer?((0,_utils.assert)((0,_gltools.isWebGL2)(gl)),gl2.vertexAttribIPointer(location,size,type,stride,offset)):gl.vertexAttribPointer(location,size,type,normalized,stride,offset);gl.enableVertexAttribArray(location);gl2.vertexAttribDivisor(location,divisor||0)});return this}},{key:"enable",value:function(location){var _this3=this,_enable=1<
arguments.length&&void 0!==arguments[1]?arguments[1]:!0;if(_enable||0!==location||VertexArrayObject.isSupported(this.gl,{constantAttributeZero:!0}))location=Number(location),this.bind(function(){return _enable?_this3.gl.enableVertexAttribArray(location):_this3.gl.disableVertexAttribArray(location)});return this}},{key:"getConstantBuffer",value:function(elementCount,value){var constantValue=this._normalizeConstantArrayValue(value),byteLength=constantValue.byteLength*elementCount;elementCount*=constantValue.length;
var updateNeeded=!this.buffer;this.buffer=this.buffer||new _buffer["default"](this.gl,byteLength);if(updateNeeded=(updateNeeded=updateNeeded||this.buffer.reallocate(byteLength))||!this._compareConstantArrayValues(constantValue,this.bufferValue))byteLength=(0,_arrayUtilsFlat.getScratchArray)(value.constructor,elementCount),(0,_arrayUtilsFlat.fillArray)({target:byteLength,source:constantValue,start:0,count:elementCount}),this.buffer.subData(byteLength),this.bufferValue=value;return this.buffer}},{key:"_normalizeConstantArrayValue",
value:function(arrayValue){return Array.isArray(arrayValue)?new Float32Array(arrayValue):arrayValue}},{key:"_compareConstantArrayValues",value:function(v1,v2){if(!v1||!v2||v1.length!==v2.length||v1.constructor!==v2.constructor)return!1;for(var i=0;i<v1.length;++i)if(v1[i]!==v2[i])return!1;return!0}},{key:"_createHandle",value:function(){return this.gl.createVertexArray()}},{key:"_deleteHandle",value:function(handle){this.gl2.deleteVertexArray(handle);return[this.elements]}},{key:"_bindHandle",value:function(handle){this.gl2.bindVertexArray(handle)}},
{key:"_getParameter",value:function(pname,_ref){var _this4=this,location=_ref.location;(0,_utils.assert)(Number.isFinite(location));return this.bind(function(){switch(pname){case 34373:return _this4.gl.getVertexAttribOffset(location,pname);default:return _this4.gl.getVertexAttrib(location,pname)}})}},{key:"MAX_ATTRIBUTES",get:function(){return VertexArrayObject.getMaxAttributes(this.gl)}}],[{key:"_setConstantFloatArray",value:function(gl,location,array){switch(array.length){case 1:gl.vertexAttrib1fv(location,
array);break;case 2:gl.vertexAttrib2fv(location,array);break;case 3:gl.vertexAttrib3fv(location,array);break;case 4:gl.vertexAttrib4fv(location,array);break;default:(0,_utils.assert)(!1)}}},{key:"_setConstantIntArray",value:function(gl,location,array){(0,_utils.assert)((0,_gltools.isWebGL2)(gl));switch(array.length){case 1:gl.vertexAttribI1iv(location,array);break;case 2:gl.vertexAttribI2iv(location,array);break;case 3:gl.vertexAttribI3iv(location,array);break;case 4:gl.vertexAttribI4iv(location,
array);break;default:(0,_utils.assert)(!1)}}},{key:"_setConstantUintArray",value:function(gl,location,array){(0,_utils.assert)((0,_gltools.isWebGL2)(gl));switch(array.length){case 1:gl.vertexAttribI1uiv(location,array);break;case 2:gl.vertexAttribI2uiv(location,array);break;case 3:gl.vertexAttribI3uiv(location,array);break;case 4:gl.vertexAttribI4uiv(location,array);break;default:(0,_utils.assert)(!1)}}}]);return VertexArrayObject}(module["default"]);exports["default"]=require}
//# sourceMappingURL=module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$vertex_array_object.js.map
