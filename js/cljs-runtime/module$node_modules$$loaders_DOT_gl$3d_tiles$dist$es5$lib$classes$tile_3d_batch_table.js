shadow$provide.module$node_modules$$loaders_DOT_gl$3d_tiles$dist$es5$lib$classes$tile_3d_batch_table=function(global,require,module,exports){function defined(x){return void 0!==x&&null!==x}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _toConsumableArray2=global(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),
_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_loaderUtils=require("module$node_modules$$loaders_DOT_gl$loader_utils$dist$es5$index"),_tile3dAccessorUtils=require("module$node_modules$$loaders_DOT_gl$3d_tiles$dist$es5$lib$classes$helpers$tile_3d_accessor_utils"),_tile3dBatchTableHierarchy=require("module$node_modules$$loaders_DOT_gl$3d_tiles$dist$es5$lib$classes$tile_3d_batch_table_hierarchy"),IGNORED_PROPERTY_FIELDS={HIERARCHY:!0,extensions:!0,extras:!0};
require=function(){function Tile3DBatchTableParser(json,binary,featureCount){var options=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};(0,_classCallCheck2["default"])(this,Tile3DBatchTableParser);(0,_loaderUtils.assert)(0<=featureCount);this.json=json||{};this.binary=binary;this.featureCount=featureCount;this._extensions=this.json&&this.json.extensions||{};this._properties={};for(var propertyName in this.json)IGNORED_PROPERTY_FIELDS[propertyName]||(this._properties[propertyName]=this.json[propertyName]);
this._binaryProperties=this._initializeBinaryProperties();options["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=(0,_tile3dBatchTableHierarchy.initializeHierarchy)(this,this.json,this.binary))}(0,_createClass2["default"])(Tile3DBatchTableParser,[{key:"getExtension",value:function(extensionName){return this.json&&this.json.extensions&&this.json.extensions[extensionName]}},{key:"memorySizeInBytes",value:function(){return 0}},{key:"isClass",value:function(batchId,className){this._checkBatchId(batchId);
(0,_loaderUtils.assert)("string"===typeof className,className);return this._hierarchy?(batchId=(0,_tile3dBatchTableHierarchy.traverseHierarchy)(this._hierarchy,batchId,function(hierarchy,instanceIndex){return hierarchy.classes[hierarchy.classIds[instanceIndex]].name===className}),defined(batchId)):!1}},{key:"isExactClass",value:function(batchId,className){(0,_loaderUtils.assert)("string"===typeof className,className);return this.getExactClassName(batchId)===className}},{key:"getExactClassName",value:function(batchId){this._checkBatchId(batchId);
if(this._hierarchy)return this._hierarchy.classes[this._hierarchy.classIds[batchId]].name}},{key:"hasProperty",value:function(batchId,name){this._checkBatchId(batchId);(0,_loaderUtils.assert)("string"===typeof name,name);return defined(this._properties[name])||this._hasPropertyInHierarchy(batchId,name)}},{key:"getPropertyNames",value:function(batchId,results){var _results;this._checkBatchId(batchId);results=defined(results)?results:[];results.length=0;var propertyNames=Object.keys(this._properties);
(_results=results).push.apply(_results,(0,_toConsumableArray2["default"])(propertyNames));this._hierarchy&&this._getPropertyNamesInHierarchy(batchId,results);return results}},{key:"getProperty",value:function(batchId,name){this._checkBatchId(batchId);(0,_loaderUtils.assert)("string"===typeof name,name);if(this._binaryProperties){var binaryProperty=this._binaryProperties[name];if(defined(binaryProperty))return this._getBinaryProperty(binaryProperty,batchId)}binaryProperty=this._properties[name];if(defined(binaryProperty))return binaryProperty[batchId];
if(this._hierarchy&&(batchId=this._getHierarchyProperty(batchId,name),defined(batchId)))return batchId}},{key:"setProperty",value:function(batchId,name,value){var featureCount=this.featureCount;this._checkBatchId(batchId);(0,_loaderUtils.assert)("string"===typeof name,name);if(this._binaryProperties){var binaryProperty=this._binaryProperties[name];if(binaryProperty){this._setBinaryProperty(binaryProperty,batchId,value);return}}this._hierarchy&&this._setHierarchyProperty(this,batchId,name,value)||
(binaryProperty=this._properties[name],defined(binaryProperty)||(this._properties[name]=Array(featureCount),binaryProperty=this._properties[name]),binaryProperty[batchId]=value)}},{key:"_checkBatchId",value:function(batchId){if(!(0<=batchId&&batchId<this.featureCount))throw Error("batchId not in range [0, featureCount - 1].");}},{key:"_getBinaryProperty",value:function(binaryProperty,index){return binaryProperty.unpack(binaryProperty.typedArray,index)}},{key:"_setBinaryProperty",value:function(binaryProperty,
index,value){binaryProperty.pack(value,binaryProperty.typedArray,index)}},{key:"_initializeBinaryProperties",value:function(){var binaryProperties=null,name;for(name in this._properties){var binaryProperty=this._initializeBinaryProperty(name,this._properties[name]);binaryProperty&&(binaryProperties=binaryProperties||{},binaryProperties[name]=binaryProperty)}return binaryProperties}},{key:"_initializeBinaryProperty",value:function(name,property){return"byteOffset"in property?((0,_loaderUtils.assert)(this.binary,
"Property ".concat(name," requires a batch table binary.")),(0,_loaderUtils.assert)(property.type,"Property ".concat(name," requires a type.")),name=(0,_tile3dAccessorUtils.createTypedArrayFromAccessor)(property,this.binary.buffer,this.binary.byteOffset|0,this.featureCount),{typedArray:name.values,componentCount:name.size,unpack:name.unpacker,pack:name.packer}):null}},{key:"_hasPropertyInHierarchy",value:function(batchId,name){if(!this._hierarchy)return!1;batchId=(0,_tile3dBatchTableHierarchy.traverseHierarchy)(this._hierarchy,
batchId,function(hierarchy,instanceIndex){return defined(hierarchy.classes[hierarchy.classIds[instanceIndex]].instances[name])});return defined(batchId)}},{key:"_getPropertyNamesInHierarchy",value:function(batchId,results){(0,_tile3dBatchTableHierarchy.traverseHierarchy)(this._hierarchy,batchId,function(hierarchy,instanceIndex){hierarchy=hierarchy.classes[hierarchy.classIds[instanceIndex]].instances;for(var name in hierarchy)hierarchy.hasOwnProperty(name)&&-1===results.indexOf(name)&&results.push(name)})}},
{key:"_getHierarchyProperty",value:function(batchId,name){var _this=this;return(0,_tile3dBatchTableHierarchy.traverseHierarchy)(this._hierarchy,batchId,function(hierarchy,instanceIndex){var indexInClass=hierarchy.classIndexes[instanceIndex];hierarchy=hierarchy.classes[hierarchy.classIds[instanceIndex]].instances[name];return defined(hierarchy)?defined(hierarchy.typedArray)?_this._getBinaryProperty(hierarchy,indexInClass):hierarchy[indexInClass]:null})}},{key:"_setHierarchyProperty",value:function(batchTable,
batchId,name,value){var _this2=this;batchTable=(0,_tile3dBatchTableHierarchy.traverseHierarchy)(this._hierarchy,batchId,function(hierarchy,instanceIndex){var indexInClass=hierarchy.classIndexes[instanceIndex];hierarchy=hierarchy.classes[hierarchy.classIds[instanceIndex]].instances[name];return defined(hierarchy)?((0,_loaderUtils.assert)(instanceIndex===batchId,'Inherited property "'.concat(name,'" is read-only.')),defined(hierarchy.typedArray)?_this2._setBinaryProperty(hierarchy,indexInClass,value):
hierarchy[indexInClass]=value,!0):!1});return defined(batchTable)}}]);return Tile3DBatchTableParser}();exports["default"]=require}
//# sourceMappingURL=module$node_modules$$loaders_DOT_gl$3d_tiles$dist$es5$lib$classes$tile_3d_batch_table.js.map
