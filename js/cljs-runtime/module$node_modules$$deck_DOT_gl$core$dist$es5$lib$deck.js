shadow$provide.module$node_modules$$deck_DOT_gl$core$dist$es5$lib$deck=function(global,require,module,exports){function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=
null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||
(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e;},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},
n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,
minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function noop(){}module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _defineProperty2=module(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_classCallCheck2=module(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),
_createClass2=module(require("module$node_modules$$babel$runtime$helpers$createClass")),_layerManager=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$layer_manager")),_viewManager=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$view_manager")),_mapView=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$views$map_view")),_effectManager=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$effect_manager")),_effect=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$effect")),
_deckRenderer=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$deck_renderer")),_deckPicker=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$deck_picker")),_tooltip=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$tooltip")),_log=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$log")),_deepEqual=require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$deep_equal"),_typedArrayManager=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$typed_array_manager"));
global=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$init"));var _env=require("module$node_modules$probe_DOT_gl$env"),_core=require("module$node_modules$$luma_DOT_gl$core$dist$es5$index"),_probe=require("module$node_modules$probe_DOT_gl$dist$es5$index"),_mjolnir=require("module$node_modules$mjolnir_DOT_js$dist$es5$index"),_assert=module(require("module$node_modules$$deck_DOT_gl$core$dist$es5$utils$assert")),_constants=require("module$node_modules$$deck_DOT_gl$core$dist$es5$lib$constants"),
defaultProps={id:"deckgl-overlay",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:noop,onResize:noop,onViewStateChange:noop,onInteractionStateChange:noop,onBeforeRender:noop,onAfterRender:noop,onLoad:noop,onError:null,_onMetrics:null,getCursor:function(_ref){return _ref.isDragging?
"grabbing":"grab"},debug:!1,drawPickingColors:!1};require=function(){function Deck(props){(0,_classCallCheck2["default"])(this,Deck);props=Object.assign({},defaultProps,props);this.props={};this.height=this.width=0;this.deckPicker=this.deckRenderer=this.effectManager=this.layerManager=this.viewManager=null;this._needsRedraw=!0;this._pickRequest={};this.viewState=this._lastPointerDownInfo=null;this.interactiveState={isHovering:!1,isDragging:!1};this._onEvent=this._onEvent.bind(this);this._onPointerDown=
this._onPointerDown.bind(this);this._onPointerMove=this._onPointerMove.bind(this);this._pickAndCallback=this._pickAndCallback.bind(this);this._onRendererInitialized=this._onRendererInitialized.bind(this);this._onRenderFrame=this._onRenderFrame.bind(this);this._onViewStateChange=this._onViewStateChange.bind(this);this._onInteractionStateChange=this._onInteractionStateChange.bind(this);props.viewState&&props.initialViewState&&_log["default"].warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")();
"IE"===(0,_env.getBrowser)()&&_log["default"].warn("IE 11 support will be deprecated in v8.0")();props.gl||"undefined"===typeof document||(this.canvas=this._createCanvas(props));this.animationLoop=this._createAnimationLoop(props);this.stats=new _probe.Stats({id:"deck.gl"});this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0};this._metricsCounter=
0;this.setProps(props);props._typedArrayManagerProps&&_typedArrayManager["default"].setProps(props._typedArrayManagerProps);this.animationLoop.start()}(0,_createClass2["default"])(Deck,[{key:"finalize",value:function(){this.animationLoop.stop();this._lastPointerDownInfo=this.animationLoop=null;this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=
null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null);this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}},{key:"setProps",value:function(props){this.stats.get("setProps Time").timeStart();"onLayerHover"in props&&_log["default"].removed("onLayerHover","onHover")();"onLayerClick"in props&&_log["default"].removed("onLayerClick","onClick")();props.initialViewState&&
!(0,_deepEqual.deepEqual)(this.props.initialViewState,props.initialViewState)&&(this.viewState=props.initialViewState);Object.assign(this.props,props);this._setCanvasSize(this.props);props=Object.create(this.props);Object.assign(props,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()});this.animationLoop.setProps(props);this.layerManager&&(this.viewManager.setProps(props),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(props),
this.effectManager.setProps(props),this.deckRenderer.setProps(props),this.deckPicker.setProps(props));this.stats.get("setProps Time").timeEnd()}},{key:"needsRedraw",value:function(){var opts=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(this.props._animate)return"Deck._animate";var redraw=this._needsRedraw;opts.clearRedrawFlags&&(this._needsRedraw=!1);var viewManagerNeedsRedraw=this.viewManager.needsRedraw(opts),layerManagerNeedsRedraw=this.layerManager.needsRedraw(opts),
effectManagerNeedsRedraw=this.effectManager.needsRedraw(opts);opts=this.deckRenderer.needsRedraw(opts);return redraw||viewManagerNeedsRedraw||layerManagerNeedsRedraw||effectManagerNeedsRedraw||opts}},{key:"redraw",value:function(force){this.layerManager&&(force=force||this.needsRedraw({clearRedrawFlags:!0}))&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(force):this._drawLayers(force))}},{key:"getViews",value:function(){return this.viewManager.views}},
{key:"getViewports",value:function(rect){return this.viewManager.getViewports(rect)}},{key:"pickObject",value:function(opts){opts=this._pick("pickObject","pickObject Time",opts).result;return opts.length?opts[0]:null}},{key:"pickMultipleObjects",value:function(opts){opts.depth=opts.depth||10;return this._pick("pickObject","pickMultipleObjects Time",opts).result}},{key:"pickObjects",value:function(opts){return this._pick("pickObjects","pickObjects Time",opts)}},{key:"_addResources",value:function(resources){var forceUpdate=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,id;for(id in resources)this.layerManager.resourceManager.add({resourceId:id,data:resources[id],forceUpdate})}},{key:"_removeResources",value:function(resourceIds){resourceIds=_createForOfIteratorHelper(resourceIds);var _step;try{for(resourceIds.s();!(_step=resourceIds.n()).done;)this.layerManager.resourceManager.remove(_step.value)}catch(err){resourceIds.e(err)}finally{resourceIds.f()}}},{key:"_pick",value:function(method,statKey,opts){var stats=
this.stats;stats.get("Pick Count").incrementCount();stats.get(statKey).timeStart();method=this.deckPicker[method](Object.assign({layers:this.layerManager.getLayers(opts),views:this.viewManager.getViews(),viewports:this.getViewports(opts),onViewportActive:this.layerManager.activateViewport},opts));stats.get(statKey).timeEnd();return method}},{key:"_createCanvas",value:function(props){var canvas=props.canvas;"string"===typeof canvas&&(canvas=document.getElementById(canvas),(0,_assert["default"])(canvas));
canvas||(canvas=document.createElement("canvas"),(props.parent||document.body).appendChild(canvas));var style=props.style;canvas.id=props.id;Object.assign(canvas.style,style);return canvas}},{key:"_setCanvasSize",value:function(props){if(this.canvas){var width=props.width;props=props.height;if(width||0===width)width=Number.isFinite(width)?"".concat(width,"px"):width,this.canvas.style.width=width;if(props||0===props)props=Number.isFinite(props)?"".concat(props,"px"):props,this.canvas.style.position=
"absolute",this.canvas.style.height=props}}},{key:"_updateCanvasSize",value:function(){this._checkForCanvasSizeChange()&&(this.viewManager.setProps({width:this.width,height:this.height}),this.props.onResize({width:this.width,height:this.height}))}},{key:"_checkForCanvasSizeChange",value:function(){var canvas=this.canvas;if(!canvas)return!1;var newWidth=canvas.clientWidth||canvas.width;canvas=canvas.clientHeight||canvas.height;return newWidth!==this.width||canvas!==this.height?(this.width=newWidth,
this.height=canvas,!0):!1}},{key:"_createAnimationLoop",value:function(props){var _this=this,glOptions=props.glOptions,debug=props.debug;return new _core.AnimationLoop({width:props.width,height:props.height,useDevicePixels:props.useDevicePixels,autoResizeDrawingBuffer:props.autoResizeDrawingBuffer,autoResizeViewport:!1,gl:props.gl,onCreateContext:function(opts){return(0,_core.createGLContext)(Object.assign({},glOptions,opts,{canvas:_this.canvas,debug}))},onInitialize:this._onRendererInitialized,onRender:this._onRenderFrame,
onBeforeRender:props.onBeforeRender,onAfterRender:props.onAfterRender,onError:props.onError})}},{key:"_getViewState",value:function(){return this.props.viewState||this.viewState}},{key:"_getViews",value:function(){var views=this.props.views||[new _mapView["default"]({id:"default-view"})];views=Array.isArray(views)?views:[views];views.length&&this.props.controller&&(views[0].props.controller=this.props.controller);return views}},{key:"_onPointerMove",value:function(event){var _pickRequest=this._pickRequest;
if("pointerleave"===event.type)_pickRequest.x=-1,_pickRequest.y=-1,_pickRequest.radius=0;else{if(event.leftButton||event.rightButton)return;var pos=event.offsetCenter;if(!pos)return;_pickRequest.x=pos.x;_pickRequest.y=pos.y;_pickRequest.radius=this.props.pickingRadius}this.layerManager&&(this.layerManager.context.mousePosition={x:_pickRequest.x,y:_pickRequest.y});_pickRequest.event=event;_pickRequest.mode="hover"}},{key:"_pickAndCallback",value:function(){var _pickRequest=this._pickRequest;if(_pickRequest.event){var _this$_pick=
this._pick("pickObject","pickObject Time",_pickRequest),result=_this$_pick.result;_this$_pick=_this$_pick.emptyInfo;this.interactiveState.isHovering=0<result.length;var handled=!1;result=_createForOfIteratorHelper(result);var _step2;try{for(result.s();!(_step2=result.n()).done;){var info=_step2.value;_this$_pick=info;handled=info.layer.onHover(info,_pickRequest.event)}}catch(err){result.e(err)}finally{result.f()}if(!handled&&this.props.onHover)this.props.onHover(_this$_pick,_pickRequest.event);this.props.getTooltip&&
(_step2=this.props.getTooltip(_this$_pick),this.tooltip.setTooltip(_step2,_this$_pick.x,_this$_pick.y));_pickRequest.event=null}}},{key:"_updateCursor",value:function(){var container=this.props.parent||this.canvas;container&&(container.style.cursor=this.props.getCursor(this.interactiveState))}},{key:"_setGLContext",value:function(gl){if(!this.layerManager){this.canvas||(this.canvas=gl.canvas,(0,_core.instrumentGLContext)(gl,{enable:!0,copyState:!0}));this.tooltip=new _tooltip["default"](this.canvas);
(0,_core.setParameters)(gl,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515});this.props.onWebGLInitialized(gl);var timeline=new _core.Timeline;timeline.play();this.animationLoop.attachTimeline(timeline);this.eventManager=new _mjolnir.EventManager(this.props.parent||gl.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});
for(var eventType in _constants.EVENTS)this.eventManager.on(eventType,this._onEvent);this.viewManager=new _viewManager["default"]({timeline,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange,onInteractionStateChange:this._onInteractionStateChange,views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});eventType=this.viewManager.getViewports()[0];this.layerManager=new _layerManager["default"](gl,{deck:this,stats:this.stats,viewport:eventType,
timeline});this.effectManager=new _effectManager["default"];this.deckRenderer=new _deckRenderer["default"](gl);this.deckPicker=new _deckPicker["default"](gl);this.setProps(this.props);this._updateCanvasSize();this.props.onLoad()}}},{key:"_drawLayers",value:function(redrawReason,renderOptions){var gl=this.layerManager.context.gl;(0,_core.setParameters)(gl,this.props.parameters);this.props.onBeforeRender({gl});this.deckRenderer.renderLayers(Object.assign({target:this.props._framebuffer,layers:this.layerManager.getLayers(),
viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason,effects:this.effectManager.getEffects()},renderOptions));this.props.onAfterRender({gl})}},{key:"_onRendererInitialized",value:function(_ref2){this._setGLContext(_ref2.gl)}},{key:"_onRenderFrame",value:function(animationProps){this._getFrameStats();0===this._metricsCounter++%60&&(this._getMetrics(),this.stats.reset(),_log["default"].table(4,this.metrics)(),
this.props._onMetrics&&this.props._onMetrics(this.metrics));this._updateCanvasSize();this._updateCursor();this.layerManager.updateLayers();this._pickAndCallback();this.redraw(!1);this.viewManager&&this.viewManager.updateViewStates()}},{key:"_onViewStateChange",value:function(params){var viewState=this.props.onViewStateChange(params)||params.viewState;this.viewState&&(this.viewState=_objectSpread(_objectSpread({},this.viewState),{},(0,_defineProperty2["default"])({},params.viewId,viewState)),this.props.viewState||
this.viewManager.setProps({viewState:this.viewState}))}},{key:"_onInteractionStateChange",value:function(interactionState){this.interactiveState.isDragging=interactionState.isDragging;this.props.onInteractionStateChange(interactionState)}},{key:"_onEvent",value:function(event){var eventOptions=_constants.EVENTS[event.type],pos=event.offsetCenter;if(eventOptions&&pos){var layers=this.layerManager.getLayers();pos=this.deckPicker.getLastPickedObject({x:pos.x,y:pos.y,layers,viewports:this.getViewports(pos)},
this._lastPointerDownInfo);var layerHandler=(layers=pos.layer)&&(layers[eventOptions.handler]||layers.props[eventOptions.handler]);eventOptions=this.props[eventOptions.handler];var handled=!1;layerHandler&&(handled=layerHandler.call(layers,pos,event));!handled&&eventOptions&&eventOptions(pos,event)}}},{key:"_onPointerDown",value:function(event){event=event.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:event.x,y:event.y,radius:this.props.pickingRadius})}},{key:"_getFrameStats",value:function(){var stats=
this.stats;stats.get("frameRate").timeEnd();stats.get("frameRate").timeStart();var animationLoopStats=this.animationLoop.stats;stats.get("GPU Time").addTime(animationLoopStats.get("GPU Time").lastTiming);stats.get("CPU Time").addTime(animationLoopStats.get("CPU Time").lastTiming)}},{key:"_getMetrics",value:function(){var metrics=this.metrics,stats=this.stats;metrics.fps=stats.get("frameRate").getHz();metrics.setPropsTime=stats.get("setProps Time").time;metrics.updateAttributesTime=stats.get("Update Attributes").time;
metrics.framesRedrawn=stats.get("Redraw Count").count;metrics.pickTime=stats.get("pickObject Time").time+stats.get("pickMultipleObjects Time").time+stats.get("pickObjects Time").time;metrics.pickCount=stats.get("Pick Count").count;metrics.gpuTime=stats.get("GPU Time").time;metrics.cpuTime=stats.get("CPU Time").time;metrics.gpuTimePerFrame=stats.get("GPU Time").getAverageTime();metrics.cpuTimePerFrame=stats.get("CPU Time").getAverageTime();stats=_core.lumaStats.get("Memory Usage");metrics.bufferMemory=
stats.get("Buffer Memory").count;metrics.textureMemory=stats.get("Texture Memory").count;metrics.renderbufferMemory=stats.get("Renderbuffer Memory").count;metrics.gpuMemory=stats.get("GPU Memory").count}}]);return Deck}();exports["default"]=require;require.getPropTypes=function(PropTypes){return{id:PropTypes.string,width:PropTypes.oneOfType([PropTypes.number,PropTypes.string]),height:PropTypes.oneOfType([PropTypes.number,PropTypes.string]),layers:PropTypes.oneOfType([PropTypes.object,PropTypes.array]),
layerFilter:PropTypes.func,views:PropTypes.oneOfType([PropTypes.object,PropTypes.array]),viewState:PropTypes.object,effects:PropTypes.arrayOf(PropTypes.instanceOf(_effect["default"])),controller:PropTypes.oneOfType([PropTypes.func,PropTypes.bool,PropTypes.object]),gl:PropTypes.object,glOptions:PropTypes.object,parameters:PropTypes.object,pickingRadius:PropTypes.number,useDevicePixels:PropTypes.oneOfType([PropTypes.bool,PropTypes.number]),touchAction:PropTypes.string,eventRecognizerOptions:PropTypes.object,
onWebGLInitialized:PropTypes.func,onResize:PropTypes.func,onViewStateChange:PropTypes.func,onInteractionStateChange:PropTypes.func,onBeforeRender:PropTypes.func,onAfterRender:PropTypes.func,onLoad:PropTypes.func,onError:PropTypes.func,debug:PropTypes.bool,drawPickingColors:PropTypes.bool,_framebuffer:PropTypes.object,_animate:PropTypes.bool,_pickable:PropTypes.bool,_typedArrayManagerProps:PropTypes.object}};require.defaultProps=defaultProps;require.VERSION=global["default"].VERSION}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$core$dist$es5$lib$deck.js.map
