shadow$provide.module$node_modules$mjolnir_DOT_js$dist$es5$utils$event_registrar=function(global,require,module,exports){global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _typeof2=global(require("module$node_modules$$babel$runtime$helpers$typeof")),_classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),
_eventUtils=require("module$node_modules$mjolnir_DOT_js$dist$es5$utils$event_utils"),DEFAULT_OPTIONS={srcElement:"root",priority:0};require=function(){function EventRegistrar(eventManager){(0,_classCallCheck2["default"])(this,EventRegistrar);this.eventManager=eventManager;this.handlers=[];this.handlersByElement=new Map;this.handleEvent=this.handleEvent.bind(this);this._active=!1}(0,_createClass2["default"])(EventRegistrar,[{key:"isEmpty",value:function(){return!this._active}},{key:"add",value:function(type,
handler,opts){var once=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,passive=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!1,handlers=this.handlers,handlersByElement=this.handlersByElement;opts&&("object"!==(0,_typeof2["default"])(opts)||opts.addEventListener)&&(opts={srcElement:opts});opts=opts?Object.assign({},DEFAULT_OPTIONS,opts):DEFAULT_OPTIONS;var entries=handlersByElement.get(opts.srcElement);entries||(entries=[],handlersByElement.set(opts.srcElement,entries));handlersByElement=
{type,handler,srcElement:opts.srcElement,priority:opts.priority};once&&(handlersByElement.once=!0);passive&&(handlersByElement.passive=!0);handlers.push(handlersByElement);this._active=this._active||!handlersByElement.passive;for(once=entries.length-1;0<=once&&!(entries[once].priority>=handlersByElement.priority);)once--;entries.splice(once+1,0,handlersByElement)}},{key:"remove",value:function(type,handler){for(var handlers=this.handlers,handlersByElement=this.handlersByElement,i=handlers.length-
1;0<=i;i--){var entry$jscomp$0=handlers[i];if(entry$jscomp$0.type===type&&entry$jscomp$0.handler===handler){handlers.splice(i,1);var entries=handlersByElement.get(entry$jscomp$0.srcElement);entries.splice(entries.indexOf(entry$jscomp$0),1);if(0===entries.length)handlersByElement["delete"](entry$jscomp$0.srcElement)}}this._active=handlers.some(function(entry){return!entry.passive})}},{key:"handleEvent",value:function(event){if(!this.isEmpty()){var mjolnirEvent=this._normalizeEvent(event);for(event=
event.srcEvent.target;event&&event!==mjolnirEvent.rootElement;){this._emit(mjolnirEvent,event);if(mjolnirEvent.handled)return;event=event.parentNode}this._emit(mjolnirEvent,"root")}}},{key:"_emit",value:function(event,srcElement){var entries=this.handlersByElement.get(srcElement);if(entries){var immediatePropagationStopped=!1,stopPropagation=function(){event.handled=!0},stopImmediatePropagation=function(){immediatePropagationStopped=event.handled=!0};srcElement=[];for(var i=0;i<entries.length;i++){var _entries$i=
entries[i],handler=_entries$i.handler,once=_entries$i.once;handler(Object.assign({},event,{type:_entries$i.type,stopPropagation,stopImmediatePropagation}));once&&srcElement.push(entries[i]);if(immediatePropagationStopped)break}for(entries=0;entries<srcElement.length;entries++)stopPropagation=srcElement[entries],this.remove(stopPropagation.type,stopPropagation.handler)}}},{key:"_normalizeEvent",value:function(event){var rootElement=this.eventManager.element;return Object.assign({},event,(0,_eventUtils.whichButtons)(event),
(0,_eventUtils.getOffsetPosition)(event,rootElement),{handled:!1,rootElement})}}]);return EventRegistrar}();exports["default"]=require}
//# sourceMappingURL=module$node_modules$mjolnir_DOT_js$dist$es5$utils$event_registrar.js.map
