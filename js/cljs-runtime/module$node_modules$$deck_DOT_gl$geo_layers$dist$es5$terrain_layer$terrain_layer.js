shadow$provide.module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$terrain_layer$terrain_layer=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,
sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,
key))})}return target}function urlTemplateToUpdateTrigger(template){return Array.isArray(template)?template.join(";"):template}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _toConsumableArray2=global(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_slicedToArray2=global(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_classCallCheck2=
global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_defineProperty2=global(require("module$node_modules$$babel$runtime$helpers$defineProperty")),
_core=require("module$node_modules$$deck_DOT_gl$core$dist$es5$index"),_meshLayers=require("module$node_modules$$deck_DOT_gl$mesh_layers$dist$es5$index"),_core2=require("module$node_modules$$loaders_DOT_gl$core$dist$es5$index");module=require("module$node_modules$$loaders_DOT_gl$terrain$dist$es5$index");var _tileLayer=global(require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$tile_layer")),_utils=require("module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$tile_layer$utils"),
DUMMY_DATA=[1];require=_objectSpread(_objectSpread({},_tileLayer["default"].defaultProps),{},{elevationData:_utils.urlType,texture:_utils.urlType,meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[module.TerrainLoader]});global=function(_CompositeLayer){function TerrainLayer(){(0,
_classCallCheck2["default"])(this,TerrainLayer);return _super.apply(this,arguments)}(0,_inherits2["default"])(TerrainLayer,_CompositeLayer);var _super=_createSuper(TerrainLayer);(0,_createClass2["default"])(TerrainLayer,[{key:"updateState",value:function(_ref){var props=_ref.props;_ref=_ref.oldProps;var elevationDataChanged=props.elevationData!==_ref.elevationData;if(elevationDataChanged){var elevationData=props.elevationData;elevationData=elevationData&&(Array.isArray(elevationData)||elevationData.includes("{x}")&&
elevationData.includes("{y}"));this.setState({isTiled:elevationData})}_ref=elevationDataChanged||props.meshMaxError!==_ref.meshMaxError||props.elevationDecoder!==_ref.elevationDecoder||props.bounds!==_ref.bounds;!this.state.isTiled&&_ref&&(props=this.loadTerrain(props),this.setState({terrain:props}))}},{key:"loadTerrain",value:function(_ref2){var elevationData=_ref2.elevationData,workerUrl=_ref2.workerUrl;if(!elevationData)return null;_ref2={terrain:{bounds:_ref2.bounds,meshMaxError:_ref2.meshMaxError,
elevationDecoder:_ref2.elevationDecoder}};null!==workerUrl&&(_ref2.terrain.workerUrl=workerUrl);return(0,_core2.load)(elevationData,this.props.loaders,_ref2)}},{key:"getTiledTerrainData",value:function(tile){var _this$props=this.props,elevationData=_this$props.elevationData,texture=_this$props.texture,elevationDecoder=_this$props.elevationDecoder,meshMaxError=_this$props.meshMaxError;_this$props=_this$props.workerUrl;elevationData=(0,_utils.getURLFromTemplate)(elevationData,tile);texture=(0,_utils.getURLFromTemplate)(texture,
tile);var bbox=tile.bbox,viewport=new _core.WebMercatorViewport({longitude:(bbox.west+bbox.east)/2,latitude:(bbox.north+bbox.south)/2,zoom:tile.z});tile=viewport.projectFlat([bbox.west,bbox.south]);bbox=viewport.projectFlat([bbox.east,bbox.north]);elevationDecoder=this.loadTerrain({elevationData,bounds:[tile[0],tile[1],bbox[0],bbox[1]],elevationDecoder,meshMaxError,workerUrl:_this$props});meshMaxError=texture?(0,_core2.load)(texture)["catch"](function(_){return null}):Promise.resolve(null);return Promise.all([elevationDecoder,
meshMaxError])}},{key:"renderSubLayers",value:function(props){var SubLayerClass=this.getSubLayerClass("mesh",_meshLayers.SimpleMeshLayer),data=props.data,color=props.color;if(!data)return null;data=(0,_slicedToArray2["default"])(data,2);return new SubLayerClass(props,{data:DUMMY_DATA,mesh:data[0],texture:data[1],coordinateSystem:_core.COORDINATE_SYSTEM.CARTESIAN,getPosition:function(d){return[0,0,0]},getColor:color})}},{key:"onViewportLoad",value:function(tiles){if(tiles){var zRange=this.state.zRange,
ranges=tiles.map(function(tile){return tile.content}).filter(Boolean).map(function(arr){return arr[0].header.boundingBox.map(function(bound){return bound[2]})});0!==ranges.length&&(tiles=Math.min.apply(Math,(0,_toConsumableArray2["default"])(ranges.map(function(x){return x[0]}))),ranges=Math.max.apply(Math,(0,_toConsumableArray2["default"])(ranges.map(function(x){return x[1]}))),(!zRange||tiles<zRange[0]||ranges>zRange[1])&&this.setState({zRange:[tiles,ranges]}))}}},{key:"renderLayers",value:function(){var _this$props2=
this.props,color=_this$props2.color,material=_this$props2.material,elevationData=_this$props2.elevationData,texture=_this$props2.texture,wireframe=_this$props2.wireframe,meshMaxError=_this$props2.meshMaxError,elevationDecoder=_this$props2.elevationDecoder,tileSize=_this$props2.tileSize,maxZoom=_this$props2.maxZoom,minZoom=_this$props2.minZoom,extent=_this$props2.extent;_this$props2=_this$props2.maxRequests;return this.state.isTiled?new _tileLayer["default"](this.getSubLayerProps({id:"tiles"}),{wireframe,
color,material,getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:urlTemplateToUpdateTrigger(elevationData),texture:urlTemplateToUpdateTrigger(texture),meshMaxError,elevationDecoder}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize,maxZoom,minZoom,extent,maxRequests:_this$props2}):new (this.getSubLayerClass("mesh",_meshLayers.SimpleMeshLayer))(this.getSubLayerProps({id:"mesh"}),
{data:DUMMY_DATA,mesh:this.state.terrain,texture,_instanced:!1,getPosition:function(d){return[0,0,0]},getColor:color,material,wireframe})}}]);return TerrainLayer}(_core.CompositeLayer);exports["default"]=global;global.layerName="TerrainLayer";global.defaultProps=require}
//# sourceMappingURL=module$node_modules$$deck_DOT_gl$geo_layers$dist$es5$terrain_layer$terrain_layer.js.map
