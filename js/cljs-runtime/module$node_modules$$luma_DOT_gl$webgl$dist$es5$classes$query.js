shadow$provide.module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$query=function(global,require,module,exports){function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){it&&(o=it);var i=0;allowArrayLike=function(){};return{s:allowArrayLike,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e;
},f:allowArrayLike}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=!0,didErr=!1,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(_e2){didErr=!0;err=_e2},f:function(){try{if(!normalCompletion&&null!=it["return"])it["return"]()}finally{if(didErr)throw err;}}}}function _unsupportedIterableToArray(o,
minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createSuper(Derived){var hasNativeReflectConstruct=
_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;
try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_assertThisInitialized2=global(require("module$node_modules$$babel$runtime$helpers$assertThisInitialized")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),
_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf"));global=global(require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$resource"));var _features=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$features$index"),_gltools=require("module$node_modules$$luma_DOT_gl$gltools$dist$es5$index"),
_utils=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$utils$index");require=function(_Resource){function Query(gl){var _this=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,_classCallCheck2["default"])(this,Query);_this=_super.call(this,gl,_this);_this.target=null;_this._queryPending=!1;_this._pollingPromise=null;Object.seal((0,_assertThisInitialized2["default"])(_this));return _this}(0,_inherits2["default"])(Query,_Resource);var _super=_createSuper(Query);(0,_createClass2["default"])(Query,
null,[{key:"isSupported",value:function(gl){var opts=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],webgl2=(0,_gltools.isWebGL2)(gl),hasTimerQuery=(0,_features.hasFeatures)(gl,_features.FEATURES.TIMER_QUERY),supported=webgl2||hasTimerQuery;opts=_createForOfIteratorHelper(opts);var _step;try{for(opts.s();!(_step=opts.n()).done;)switch(_step.value){case "queries":supported=supported&&webgl2;break;case "timers":supported=supported&&hasTimerQuery;break;default:(0,_utils.assert)(!1)}}catch(err){opts.e(err)}finally{opts.f()}return supported}}]);
(0,_createClass2["default"])(Query,[{key:"beginTimeElapsedQuery",value:function(){return this.begin(35007)}},{key:"beginOcclusionQuery",value:function(){var _ref$conservative=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).conservative;return this.begin((void 0===_ref$conservative?0:_ref$conservative)?36202:35887)}},{key:"beginTransformFeedbackQuery",value:function(){return this.begin(35976)}},{key:"begin",value:function(target){if(this._queryPending)return this;this.target=target;this.gl2.beginQuery(this.target,
this.handle);return this}},{key:"end",value:function(){if(this._queryPending)return this;this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0);return this}},{key:"isResultAvailable",value:function(){if(!this._queryPending)return!1;var resultAvailable=this.gl2.getQueryParameter(this.handle,34919);resultAvailable&&(this._queryPending=!1);return resultAvailable}},{key:"isTimerDisjoint",value:function(){return this.gl2.getParameter(36795)}},{key:"getResult",value:function(){return this.gl2.getQueryParameter(this.handle,
34918)}},{key:"getTimerMilliseconds",value:function(){return this.getResult()/1E6}},{key:"createPoll",value:function(){var _this2=this,limit=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;var counter=0;return this._pollingPromise=new Promise(function(resolve,reject){requestAnimationFrame(function poll(){_this2.isResultAvailable()?(resolve(_this2.getResult()),_this2._pollingPromise=null):counter++>limit?(reject("Timed out"),
_this2._pollingPromise=null):requestAnimationFrame(poll)})})}},{key:"_createHandle",value:function(){return Query.isSupported(this.gl)?this.gl2.createQuery():null}},{key:"_deleteHandle",value:function(){this.gl2.deleteQuery(this.handle)}}]);return Query}(global["default"]);exports["default"]=require}
//# sourceMappingURL=module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$query.js.map
