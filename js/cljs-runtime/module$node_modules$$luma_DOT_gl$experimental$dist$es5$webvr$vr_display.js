shadow$provide.module$node_modules$$luma_DOT_gl$experimental$dist$es5$webvr$vr_display=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _regenerator=global(require("module$node_modules$$babel$runtime$regenerator$index")),
_asyncToGenerator2=global(require("module$node_modules$$babel$runtime$helpers$asyncToGenerator")),_classCallCheck2=global(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_assertThisInitialized2=global(require("module$node_modules$$babel$runtime$helpers$assertThisInitialized")),_get2=global(require("module$node_modules$$babel$runtime$helpers$get")),_createClass2=global(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=global(require("module$node_modules$$babel$runtime$helpers$inherits")),
_possibleConstructorReturn2=global(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=global(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf")),_webgl=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$index");global=global(require("module$node_modules$$luma_DOT_gl$experimental$dist$es5$webvr$display"));var _vrButton=require("module$node_modules$$luma_DOT_gl$experimental$dist$es5$webvr$vr_button");require=function(_Display){function VRDisplay(props){(0,
_classCallCheck2["default"])(this,VRDisplay);props=_super.call(this,props);props._vrSupported=VRDisplay.isSupported();props._vrSupported&&(props.vrFrameData=new window.VRFrameData,props.vrPresenting=!1,props.vrFrame=!1,window.addEventListener("vrdisplaypresentchange",props._vrDisplayPresentChange.bind((0,_assertThisInitialized2["default"])(props))));return props}(0,_inherits2["default"])(VRDisplay,_Display);var _super=_createSuper(VRDisplay);(0,_createClass2["default"])(VRDisplay,null,[{key:"isSupported",
value:function(){return"undefined"!==typeof navigator&&"getVRDisplays"in navigator&&"VRFrameData"in window}}]);(0,_createClass2["default"])(VRDisplay,[{key:"delete",value:function(){(0,_get2["default"])((0,_getPrototypeOf2["default"])(VRDisplay.prototype),"delete",this).call(this);this._removeVRButton()}},{key:"getViews",value:function(options){this._vrSupported&&this._addVRButton();if(this.vrPresenting&&this.vrFrame){this.vrDisplay.getFrameData(this.vrFrameData);var _this$vrFrameData=this.vrFrameData,
width=options.width;options=options.height;return[{displayEye:"left",projectionMatrix:_this$vrFrameData.leftProjectionMatrix,viewMatrix:_this$vrFrameData.leftViewMatrix,params:{viewport:[0,0,.5*width,options],scissor:[0,0,.5*width,options],scissorTest:!0}},{displayEye:"right",projectionMatrix:_this$vrFrameData.rightProjectionMatrix,viewMatrix:_this$vrFrameData.rightViewMatrix,params:{viewport:[.5*width,0,.5*width,options],scissor:[.5*width,0,.5*width,options],scissorTest:!0}}]}return(0,_get2["default"])((0,
_getPrototypeOf2["default"])(VRDisplay.prototype),"getViews",this).call(this,options)}},{key:"submitFrame",value:function(){return this.vrPresenting&&this.vrFrame?(this.vrDisplay.submitFrame(),!0):!1}},{key:"requestAnimationFrame",value:function(renderFrame){var _this2=this;return this.vrPresenting?(this.vrDisplay.requestAnimationFrame(function(){_this2.vrFrame=!0;renderFrame();_this2.vrFrame=!1}),!0):!1}},{key:"_addVRButton",value:function(){var _addVRButton2=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(){var _this3=
this,canvas,displays;return _regenerator["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!this.vrButton){_context.next=2;break}return _context.abrupt("return");case 2:if(canvas=this._getCanvas()){_context.next=5;break}return _context.abrupt("return");case 5:return _context.next=7,navigator.getVRDisplays();case 7:(displays=_context.sent)&&displays.length&&(_webgl.log.info(2,"Found VR Displays",displays)(),this.vrDisplay=displays[0],this.vrButton=(0,_vrButton.createEnterVRButton)({canvas,
title:"Enter VR (".concat(this.vrDisplay.displayName,")")}),this.vrButton.onclick=function(){return _this3._startDisplay()});case 9:case "end":return _context.stop()}},_callee,this)}));return function(){return _addVRButton2.apply(this,arguments)}}()},{key:"_getCanvas",value:function(){return this.animationLoop.canvas||this.animationLoop.gl&&this.animationLoop.gl.canvas}},{key:"_removeVRButton",value:function(){}},{key:"_startDisplay",value:function(){this.vrDisplay.requestPresent([{source:this._getCanvas()}])}},
{key:"_vrDisplayPresentChange",value:function(){this.vrDisplay.isPresenting?(_webgl.log.info(2,"Entering VR")(),this.vrPresenting=!0,this.vrButton.style.display="none"):(_webgl.log.info(2,"Exiting VR")(),this.vrPresenting=!1,this.vrButton.style.display="block")}}]);return VRDisplay}(global["default"]);exports["default"]=require}
//# sourceMappingURL=module$node_modules$$luma_DOT_gl$experimental$dist$es5$webvr$vr_display.js.map
