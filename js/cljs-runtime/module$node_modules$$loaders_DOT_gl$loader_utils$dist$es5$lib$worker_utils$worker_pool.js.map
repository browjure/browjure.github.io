{
"version":3,
"file":"module$node_modules$$loaders_DOT_gl$loader_utils$dist$es5$lib$worker_utils$worker_pool.js",
"lineCount":7,
"mappings":"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",
"sources":["node_modules/@loaders_DOT_gl/loader-utils/dist/es5/lib/worker-utils/worker-pool.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$loaders_DOT_gl$loader_utils$dist$es5$lib$worker_utils$worker_pool\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _workerThread = _interopRequireDefault(require(\"./worker-thread\"));\n\nvar WorkerPool = function () {\n  function WorkerPool(_ref) {\n    var source = _ref.source,\n        _ref$name = _ref.name,\n        name = _ref$name === void 0 ? 'unnamed' : _ref$name,\n        _ref$maxConcurrency = _ref.maxConcurrency,\n        maxConcurrency = _ref$maxConcurrency === void 0 ? 1 : _ref$maxConcurrency,\n        onMessage = _ref.onMessage,\n        _ref$onDebug = _ref.onDebug,\n        onDebug = _ref$onDebug === void 0 ? function () {} : _ref$onDebug,\n        _ref$reuseWorkers = _ref.reuseWorkers,\n        reuseWorkers = _ref$reuseWorkers === void 0 ? true : _ref$reuseWorkers;\n    (0, _classCallCheck2[\"default\"])(this, WorkerPool);\n    this.source = source;\n    this.name = name;\n    this.maxConcurrency = maxConcurrency;\n    this.onMessage = onMessage;\n    this.onDebug = onDebug;\n    this.jobQueue = [];\n    this.idleQueue = [];\n    this.count = 0;\n    this.isDestroyed = false;\n    this.reuseWorkers = reuseWorkers;\n  }\n\n  (0, _createClass2[\"default\"])(WorkerPool, [{\n    key: \"destroy\",\n    value: function destroy() {\n      this.idleQueue.forEach(function (worker) {\n        return worker.destroy();\n      });\n      this.isDestroyed = true;\n    }\n  }, {\n    key: \"process\",\n    value: function process(data, jobName) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.jobQueue.push({\n          data: data,\n          jobName: jobName,\n          resolve: resolve,\n          reject: reject\n        });\n\n        _this._startQueuedJob();\n      });\n    }\n  }, {\n    key: \"_startQueuedJob\",\n    value: function () {\n      var _startQueuedJob2 = (0, _asyncToGenerator2[\"default\"])(_regenerator[\"default\"].mark(function _callee() {\n        var worker, job;\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.jobQueue.length) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                worker = this._getAvailableWorker();\n\n                if (worker) {\n                  _context.next = 5;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 5:\n                job = this.jobQueue.shift();\n                this.onDebug({\n                  message: 'processing',\n                  worker: worker.name,\n                  job: job.jobName,\n                  backlog: this.jobQueue.length\n                });\n                _context.prev = 7;\n                _context.t0 = job;\n                _context.next = 11;\n                return worker.process(job.data);\n\n              case 11:\n                _context.t1 = _context.sent;\n\n                _context.t0.resolve.call(_context.t0, _context.t1);\n\n                _context.next = 18;\n                break;\n\n              case 15:\n                _context.prev = 15;\n                _context.t2 = _context[\"catch\"](7);\n                job.reject(_context.t2);\n\n              case 18:\n                _context.prev = 18;\n\n                this._onWorkerDone(worker);\n\n                return _context.finish(18);\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[7, 15, 18, 21]]);\n      }));\n\n      function _startQueuedJob() {\n        return _startQueuedJob2.apply(this, arguments);\n      }\n\n      return _startQueuedJob;\n    }()\n  }, {\n    key: \"_onWorkerDone\",\n    value: function _onWorkerDone(worker) {\n      if (this.isDestroyed) {\n        worker.destroy();\n        return;\n      }\n\n      if (this.reuseWorkers) {\n        this.idleQueue.push(worker);\n      } else {\n        worker.destroy();\n        this.count--;\n      }\n\n      this._startQueuedJob();\n    }\n  }, {\n    key: \"_getAvailableWorker\",\n    value: function _getAvailableWorker() {\n      if (this.idleQueue.length > 0) {\n        return this.idleQueue.shift();\n      }\n\n      if (this.count < this.maxConcurrency) {\n        this.count++;\n        var name = \"\".concat(this.name.toLowerCase(), \" (#\").concat(this.count, \" of \").concat(this.maxConcurrency, \")\");\n        return new _workerThread[\"default\"]({\n          source: this.source,\n          onMessage: this.onMessage,\n          name: name\n        });\n      }\n\n      return null;\n    }\n  }]);\n  return WorkerPool;\n}();\n\nexports[\"default\"] = WorkerPool;\n//# sourceMappingURL=worker-pool.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","_regenerator","_asyncToGenerator2","_classCallCheck2","_createClass2","_workerThread","WorkerPool","_ref","source","_ref$name","name","_ref$maxConcurrency","maxConcurrency","onMessage","_ref$onDebug","onDebug","_ref$reuseWorkers","reuseWorkers","jobQueue","idleQueue","count","isDestroyed","key","destroy","forEach","worker","process","data","jobName","_this","Promise","resolve","reject","push","_startQueuedJob","_startQueuedJob2","mark","_callee","job","wrap","_callee$","_context","prev","next","length","abrupt","_getAvailableWorker","shift","message","backlog","t0","t1","sent","call","t2","_onWorkerDone","finish","stop","apply","arguments","concat","toLowerCase"]
}
