shadow$provide.module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$buffer=function(global,require,module,exports){function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2["default"])(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2["default"])(this).constructor;Super=Reflect.construct(Super,arguments,NewTarget)}else Super=Super.apply(this,arguments);return(0,_possibleConstructorReturn2["default"])(this,
Super)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _classCallCheck2=module(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),
_createClass2=module(require("module$node_modules$$babel$runtime$helpers$createClass")),_assertThisInitialized2=module(require("module$node_modules$$babel$runtime$helpers$assertThisInitialized")),_inherits2=module(require("module$node_modules$$babel$runtime$helpers$inherits")),_possibleConstructorReturn2=module(require("module$node_modules$$babel$runtime$helpers$possibleConstructorReturn")),_getPrototypeOf2=module(require("module$node_modules$$babel$runtime$helpers$getPrototypeOf"));global=module(require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$resource"));
var _accessor=module(require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$accessor")),_webglUtils=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$webgl_utils$index"),_gltools=require("module$node_modules$$luma_DOT_gl$gltools$dist$es5$index"),_utils=require("module$node_modules$$luma_DOT_gl$webgl$dist$es5$utils$index");require={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",
integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"};var PROP_CHECKS_INITIALIZE={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:require},PROP_CHECKS_SET_PROPS={removedProps:require};require=function(_Resource){function Buffer(gl){var props=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,_classCallCheck2["default"])(this,Buffer);var _this=_super.call(this,gl,props);_this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]);
_this.target=props.target||(_this.gl.webgl2?36662:34962);_this.initialize(props);Object.seal((0,_assertThisInitialized2["default"])(_this));return _this}(0,_inherits2["default"])(Buffer,_Resource);var _super=_createSuper(Buffer);(0,_createClass2["default"])(Buffer,[{key:"getElementCount",value:function(){return Math.round(this.byteLength/_accessor["default"].getBytesPerElement(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.accessor))}},{key:"getVertexCount",value:function(){return Math.round(this.byteLength/
_accessor["default"].getBytesPerVertex(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.accessor))}},{key:"initialize",value:function(){var props=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};ArrayBuffer.isView(props)&&(props={data:props});Number.isFinite(props)&&(props={byteLength:props});props=(0,_utils.checkProps)("Buffer",props,PROP_CHECKS_INITIALIZE);this.usage=props.usage||35044;this.debugData=null;this.setAccessor(Object.assign({},props,props.accessor));props.data?this._setData(props.data,
props.offset,props.byteLength):this._setByteLength(props.byteLength||0);return this}},{key:"setProps",value:function(props){props=(0,_utils.checkProps)("Buffer",props,PROP_CHECKS_SET_PROPS);"accessor"in props&&this.setAccessor(props.accessor);return this}},{key:"setAccessor",value:function(accessor){accessor=Object.assign({},accessor);delete accessor.buffer;this.accessor=new _accessor["default"](accessor);return this}},{key:"reallocate",value:function(byteLength){if(byteLength>this.byteLength)return this._setByteLength(byteLength),
!0;this.bytesUsed=byteLength;return!1}},{key:"setData",value:function(props){return this.initialize(props)}},{key:"subData",value:function(props){ArrayBuffer.isView(props)&&(props={data:props});var _props=props,data=_props.data,_props$offset=_props.offset;_props$offset=void 0===_props$offset?0:_props$offset;_props=_props.srcOffset;_props=void 0===_props?0:_props;props=props.byteLength||props.length;(0,_utils.assert)(data);var target=this.gl.webgl2?36663:this.target;this.gl.bindBuffer(target,this.handle);
0!==_props||void 0!==props?((0,_gltools.assertWebGL2Context)(this.gl),this.gl.bufferSubData(this.target,_props$offset,data,_props,props)):this.gl.bufferSubData(target,_props$offset,data);this.gl.bindBuffer(target,null);this.debugData=null;this._inferType(data);return this}},{key:"copyData",value:function(_ref){var sourceBuffer=_ref.sourceBuffer,_ref$readOffset=_ref.readOffset;_ref$readOffset=void 0===_ref$readOffset?0:_ref$readOffset;var _ref$writeOffset=_ref.writeOffset;_ref$writeOffset=void 0===
_ref$writeOffset?0:_ref$writeOffset;_ref=_ref.size;var gl=this.gl;(0,_gltools.assertWebGL2Context)(gl);gl.bindBuffer(36662,sourceBuffer.handle);gl.bindBuffer(36663,this.handle);gl.copyBufferSubData(36662,36663,_ref$readOffset,_ref$writeOffset,_ref);gl.bindBuffer(36662,null);gl.bindBuffer(36663,null);this.debugData=null;return this}},{key:"getData",value:function(){var _ref2=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},_ref2$dstData=_ref2.dstData;_ref2$dstData=void 0===_ref2$dstData?null:
_ref2$dstData;var _ref2$srcByteOffset=_ref2.srcByteOffset;_ref2$srcByteOffset=void 0===_ref2$srcByteOffset?0:_ref2$srcByteOffset;var _ref2$dstOffset=_ref2.dstOffset;_ref2$dstOffset=void 0===_ref2$dstOffset?0:_ref2$dstOffset;_ref2=_ref2.length;_ref2=void 0===_ref2?0:_ref2;(0,_gltools.assertWebGL2Context)(this.gl);var ArrayType=(0,_webglUtils.getTypedArrayFromGLType)(this.accessor.type||5126,{clamped:!1}),sourceAvailableElementCount=this._getAvailableElementCount(_ref2$srcByteOffset);if(_ref2$dstData){var dstElementCount=
_ref2$dstData.length;var dstAvailableElementCount=dstElementCount-_ref2$dstOffset}else dstAvailableElementCount=Math.min(sourceAvailableElementCount,_ref2||sourceAvailableElementCount),dstElementCount=_ref2$dstOffset+dstAvailableElementCount;sourceAvailableElementCount=Math.min(sourceAvailableElementCount,dstAvailableElementCount);_ref2=_ref2||sourceAvailableElementCount;(0,_utils.assert)(_ref2<=sourceAvailableElementCount);_ref2$dstData=_ref2$dstData||new ArrayType(dstElementCount);this.gl.bindBuffer(36662,
this.handle);this.gl.getBufferSubData(36662,_ref2$srcByteOffset,_ref2$dstData,_ref2$dstOffset,_ref2);this.gl.bindBuffer(36662,null);return _ref2$dstData}},{key:"bind",value:function(){var _ref3=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},_ref3$target=_ref3.target;_ref3$target=void 0===_ref3$target?this.target:_ref3$target;var _ref3$index=_ref3.index;_ref3$index=void 0===_ref3$index?this.accessor&&this.accessor.index:_ref3$index;var _ref3$offset=_ref3.offset;_ref3$offset=void 0===_ref3$offset?
0:_ref3$offset;_ref3=_ref3.size;35345===_ref3$target||35982===_ref3$target?void 0!==_ref3?this.gl.bindBufferRange(_ref3$target,_ref3$index,this.handle,_ref3$offset,_ref3):((0,_utils.assert)(0===_ref3$offset),this.gl.bindBufferBase(_ref3$target,_ref3$index,this.handle)):this.gl.bindBuffer(_ref3$target,this.handle);return this}},{key:"unbind",value:function(){var _ref4=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},_ref4$target=_ref4.target;_ref4$target=void 0===_ref4$target?this.target:
_ref4$target;_ref4=_ref4.index;_ref4=void 0===_ref4?this.accessor&&this.accessor.index:_ref4;35345===_ref4$target||35982===_ref4$target?this.gl.bindBufferBase(_ref4$target,_ref4,null):this.gl.bindBuffer(_ref4$target,null);return this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_setData",
value:function(data){var offset=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,byteLength=2<arguments.length&&void 0!==arguments[2]?arguments[2]:data.byteLength+offset;(0,_utils.assert)(ArrayBuffer.isView(data));this._trackDeallocatedMemory();var target=this._getTarget();this.gl.bindBuffer(target,this.handle);this.gl.bufferData(target,byteLength,this.usage);this.gl.bufferSubData(target,offset,data);this.gl.bindBuffer(target,null);this.debugData=data.slice(0,10);this.bytesUsed=byteLength;
this._trackAllocatedMemory(byteLength);offset=(0,_webglUtils.getGLTypeFromTypedArray)(data);(0,_utils.assert)(offset);this.setAccessor(new _accessor["default"](this.accessor,{type:offset}));return this}},{key:"_setByteLength",value:function(byteLength){var usage=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.usage;(0,_utils.assert)(0<=byteLength);this._trackDeallocatedMemory();var data=byteLength;0===byteLength&&(data=new Float32Array(0));var target=this._getTarget();this.gl.bindBuffer(target,
this.handle);this.gl.bufferData(target,data,usage);this.gl.bindBuffer(target,null);this.usage=usage;this.debugData=null;this.bytesUsed=byteLength;this._trackAllocatedMemory(byteLength);return this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(srcByteOffset){var ArrayType=(0,_webglUtils.getTypedArrayFromGLType)(this.accessor.type||5126,{clamped:!1});srcByteOffset/=ArrayType.BYTES_PER_ELEMENT;return this.getElementCount()-
srcByteOffset}},{key:"_inferType",value:function(data){this.accessor.type||this.setAccessor(new _accessor["default"](this.accessor,{type:(0,_webglUtils.getGLTypeFromTypedArray)(data)}))}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle);this._trackDeallocatedMemory()}},{key:"_getParameter",value:function(pname){this.gl.bindBuffer(this.target,this.handle);pname=this.gl.getBufferParameter(this.target,pname);
this.gl.bindBuffer(this.target,null);return pname}},{key:"setByteLength",value:function(byteLength){_gltools.log.deprecated("setByteLength","reallocate")();return this.reallocate(byteLength)}},{key:"updateAccessor",value:function(opts){_gltools.log.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")();this.accessor=new _accessor["default"](this.accessor,opts);return this}},{key:"type",get:function(){_gltools.log.deprecated("Buffer.type","Buffer.accessor.type")();return this.accessor.type}},
{key:"bytes",get:function(){_gltools.log.deprecated("Buffer.bytes","Buffer.byteLength")();return this.byteLength}}]);return Buffer}(global["default"]);exports["default"]=require}
//# sourceMappingURL=module$node_modules$$luma_DOT_gl$webgl$dist$es5$classes$buffer.js.map
